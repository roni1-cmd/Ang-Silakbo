<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CoralVIA</title>
  <link rel="icon" href="Coral.png">
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics-compat.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Playfair+Display:wght@400;500;600;700&family=Merriweather:wght@300;400;700&family=Source+Sans+Pro:wght@300;400;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #e65100;
      --primary-light: #ff833a;
      --primary-dark: #ac1900;
      --white: #ffffff;
      --light-gray: #f8f9fa;
      --medium-gray: #e0e0e0;
      --dark-gray: #424242;
      --sidebar-width: 280px;
      --box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      --transition: all 0.3s ease;
      --glass-bg: rgba(255, 255, 255, 0.85);
      --glass-border: rgba(255, 255, 255, 0.2);
      --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      
      /* Dark mode variables */
      --dark-bg: #121212;
      --dark-surface: #1e1e1e;
      --dark-surface-light: #2d2d2d;
      --dark-text: #e0e0e0;
      --dark-text-secondary: #a0a0a0;
      --dark-border: #333333;
      
      /* Rich text editor colors */
      --editor-bg: #ffffff;
      --editor-border: #e0e0e0;
      --editor-toolbar-bg: #f5f5f5;
      
      /* Terminal colors */
      --terminal-bg: #1e1e1e;
      --terminal-text: #f8f8f8;
      --terminal-prompt: #50fa7b;
      --terminal-border: #333333;
    }

    /* Dark mode class */
    .dark-mode {
      --light-gray: #1e1e1e;
      --medium-gray: #333333;
      --dark-gray: #e0e0e0;
      --white: #121212;
      --glass-bg: rgba(30, 30, 30, 0.85);
      --glass-border: rgba(60, 60, 60, 0.2);
      --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      color: var(--dark-text);
      
      /* Dark mode editor colors */
      --editor-bg: #2d2d2d;
      --editor-border: #444444;
      --editor-toolbar-bg: #333333;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background-color: var(--light-gray);
      color: var(--dark-gray);
      display: flex;
      height: 100vh;
      overflow: hidden;
      font-family: 'Source Sans Pro', sans-serif;
      background: linear-gradient(135deg, #f5f7fa, #e4e7eb);
      transition: background-color 0.3s ease;
    }

    body.dark-mode {
      background: linear-gradient(135deg, #121212, #1a1a1a);
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Poppins', sans-serif;
    }

    /* Scrollbar styling */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(230, 81, 0, 0.3);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(230, 81, 0, 0.5);
    }

    /* Sidebar - Updated with glass UI and white theme */
    .sidebar {
      width: var(--sidebar-width);
      background: var(--glass-bg);
      color: var(--dark-gray);
      display: flex;
      flex-direction: column;
      padding: 24px;
      transition: var(--transition);
      z-index: 100;
      box-shadow: var(--glass-shadow);
      height: 100vh;
      position: fixed;
      left: -280px; /* Hidden by default */
      overflow: hidden;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-right: 1px solid rgba(255, 255, 255, 0.5);
    }

    .dark-mode .sidebar {
      border-right: 1px solid var(--dark-border);
    }

    .sidebar.active {
      left: 0;
    }

    .sidebar::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23e65100' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
      opacity: 0.5;
      z-index: -1;
    }

    .logo-container {
      display: flex;
      align-items: center;
      margin-bottom: 28px;
    }

    .logo {
      width: 40px;
      height: 40px;
      margin-right: 12px;
      border-radius: 10px;
      object-fit: cover;
    }

    .logo-text {
      font-family: 'Poppins', sans-serif;
      font-size: 24px;
      font-weight: 700;
      letter-spacing: 0.5px;
      color: var(--primary-color);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    .logo-description {
      font-size: 11px;
      color: var(--dark-gray);
      opacity: 0.8;
      margin-top: 2px;
      line-height: 1.2;
      max-width: 200px;
    }

    .new-chat-btn {
      background-color: rgba(230, 81, 0, 0.1);
      backdrop-filter: blur(10px);
      color: var(--primary-color);
      border: 1px solid rgba(230, 81, 0, 0.2);
      border-radius: 16px;
      padding: 14px;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 24px;
      transition: var(--transition);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
    }

    .new-chat-btn:hover {
      background-color: rgba(230, 81, 0, 0.15);
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
    }

    .new-chat-btn i {
      margin-right: 10px;
    }

    .back-home-btn {
      background-color: rgba(230, 81, 0, 0.1);
      backdrop-filter: blur(10px);
      color: var(--primary-color);
      border: 1px solid rgba(230, 81, 0, 0.2);
      border-radius: 16px;
      padding: 14px;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 24px;
      transition: var(--transition);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
    }

    .back-home-btn:hover {
      background-color: rgba(230, 81, 0, 0.15);
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
    }

    .back-home-btn i {
      margin-right: 10px;
    }

    .chat-history-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    }

    .dark-mode .chat-history-header {
      border-bottom: 1px solid var(--dark-border);
    }

    .chat-history-title {
      font-family: 'Poppins', sans-serif;
      font-size: 14px;
      font-weight: 600;
      color: var(--dark-gray);
      letter-spacing: 0.5px;
    }

    .chat-history-actions {
      display: flex;
      gap: 8px;
    }

    .history-action-btn {
      background: none;
      border: none;
      color: var(--dark-gray);
      opacity: 0.6;
      cursor: pointer;
      font-size: 14px;
      padding: 4px;
      border-radius: 4px;
      transition: var(--transition);
    }

    .history-action-btn:hover {
      color: var(--primary-color);
      background-color: rgba(230, 81, 0, 0.1);
      opacity: 1;
    }

    .chat-history {
      flex: 1;
      overflow-y: auto;
      margin-bottom: 20px;
      padding-right: 6px;
    }

    .chat-history::-webkit-scrollbar {
      width: 4px;
    }

    .chat-history::-webkit-scrollbar-thumb {
      background-color: rgba(230, 81, 0, 0.2);
      border-radius: 4px;
    }

    .chat-item {
      padding: 12px 14px;
      border-radius: 16px;
      margin-bottom: 10px;
      cursor: pointer;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      transition: var(--transition);
      font-family: 'Source Sans Pro', sans-serif;
      font-size: 14px;
      border: 1px solid rgba(0, 0, 0, 0.05);
      background-color: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      color: var(--dark-gray);
    }

    .dark-mode .chat-item {
      background-color: rgba(45, 45, 45, 0.5);
      border: 1px solid var(--dark-border);
    }

    .chat-item:hover {
      background-color: rgba(255, 255, 255, 0.8);
      transform: translateX(2px);
      border-color: rgba(230, 81, 0, 0.1);
    }

    .dark-mode .chat-item:hover {
      background-color: rgba(60, 60, 60, 0.8);
    }

    .chat-item.active {
      background-color: rgba(230, 81, 0, 0.1);
      border-color: rgba(230, 81, 0, 0.2);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      color: var(--primary-color);
    }

    .dark-mode .chat-item.active {
      background-color: rgba(230, 81, 0, 0.2);
    }

    .chat-item-icon {
      margin-right: 10px;
      font-size: 12px;
      color: var(--primary-color);
      opacity: 0.7;
    }

    .chat-item-text {
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .chat-item-actions {
      display: none;
      margin-left: 8px;
    }

    .chat-item:hover .chat-item-actions {
      display: flex;
    }

    .chat-item-action {
      background: none;
      border: none;
      color: var(--dark-gray);
      opacity: 0.6;
      cursor: pointer;
      font-size: 12px;
      padding: 2px;
      border-radius: 4px;
      transition: var(--transition);
    }

    .chat-item-action:hover {
      color: var(--primary-color);
      background-color: rgba(230, 81, 0, 0.1);
      opacity: 1;
    }

    .user-profile {
      display: flex;
      align-items: center;
      padding: 12px;
      border-radius: 16px;
      cursor: pointer;
      transition: var(--transition);
      background-color: rgba(255, 255, 255, 0.5);
      border: 1px solid rgba(0, 0, 0, 0.05);
      backdrop-filter: blur(10px);
    }

    .dark-mode .user-profile {
      background-color: rgba(45, 45, 45, 0.5);
      border: 1px solid var(--dark-border);
    }

    .user-profile:hover {
      background-color: rgba(255, 255, 255, 0.8);
      border-color: rgba(230, 81, 0, 0.1);
    }

    .dark-mode .user-profile:hover {
      background-color: rgba(60, 60, 60, 0.8);
    }

    .user-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      margin-right: 12px;
      flex-shrink: 0;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      border: 2px solid rgba(230, 81, 0, 0.2);
    }

    .user-name {
      font-family: 'Source Sans Pro', sans-serif;
      font-weight: 600;
      font-size: 14px;
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      color: var(--dark-gray);
    }

    /* Main Content */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      position: relative;
      height: 100vh;
      overflow: hidden;
      margin-left: 0; /* No margin since sidebar is hidden by default */
      width: 100%;
      transition: margin-left 0.3s ease;
    }

    .main-content.sidebar-active {
      margin-left: var(--sidebar-width);
      width: calc(100% - var(--sidebar-width));
    }

    .mobile-header {
      display: flex;
      padding: 14px 18px;
      align-items: center;
      z-index: 10;
      border-bottom: 1px solid rgba(224, 224, 224, 0.5);
      transition: background-color 0.3s ease;
    }

    .dark-mode .mobile-header {
      border-bottom: 1px solid var(--dark-border);
    }

    .menu-toggle {
      background: none;
      border: none;
      font-size: 22px;
      cursor: pointer;
      color: var(--primary-color);
      margin-right: 16px;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: var(--transition);
    }

    .menu-toggle:hover {
      background-color: var(--light-gray);
    }

    .mobile-logo-container {
      display: flex;
      align-items: center;
      flex-direction: column;
      align-items: flex-start;
    }

    .mobile-logo-wrapper {
      display: flex;
      align-items: center;
    }

    .mobile-logo {
      width: 32px;
      height: 32px;
      margin-right: 10px;
      border-radius: 8px;
    }

    .mobile-logo-text {
      font-family: 'Poppins', sans-serif;
      font-size: 20px;
      font-weight: 700;
      color: var(--primary-color);
    }

    .mobile-logo-description {
      font-size: 10px;
      color: var(--dark-gray);
      margin-top: 2px;
      max-width: 250px;
    }

    /* Chat Area */
    .chat-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 20px;
      overflow-y: auto;
      background-color: transparent;
      position: relative;
    }

    .welcome-screen {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 20px;
      min-height: 0;
      overflow-y: auto;
      animation: fadeIn 0.5s ease-out;
    }

    .welcome-logo {
      width: 120px;
      height: 120px;
      margin-bottom: 30px;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(230, 81, 0, 0.2);
    }

    .welcome-title {
      font-family: 'Poppins', sans-serif;
      font-size: 36px;
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 16px;
      letter-spacing: 0.5px;
      min-height: 54px;
      width: 100%;
      overflow: visible;
    }

    .welcome-subtitle {
      font-family: 'Playfair Display', serif;
      font-size: 18px;
      color: var(--dark-gray);
      margin-bottom: 40px;
      max-width: 600px;
      line-height: 1.6;
    }

    .message-container {
      display: flex;
      flex-direction: column;
      gap: 24px;
      width: 100%;
      animation: fadeIn 0.5s ease-out;
      margin-bottom: 140px; /* Increased to make message container lower */
      margin-top: 40px; /* Added to push content down a bit */
    }

    .message {
      display: flex;
      max-width: 100%;
      position: relative;
    }

    .message-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-right: 16px;
      flex-shrink: 0;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      border: 2px solid var(--light-gray);
    }

    .message-content {
      flex: 1;
      padding-right: 40px;
    }

    .message-sender {
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      margin-bottom: 6px;
      font-size: 15px;
    }

    .message-text {
      font-family: 'Source Sans Pro', sans-serif;
      line-height: 1.7;
      white-space: pre-wrap;
      font-size: 15px;
    }

    /* User message on right, AI on left */
    .user-message {
      align-self: flex-end;
      flex-direction: row-reverse;
      max-width: 80%;
    }

    .user-message .message-avatar {
      margin-right: 0;
      margin-left: 16px;
    }

    .user-message .message-content {
      background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
      color: var(--white);
      padding: 16px;
      border-radius: 24px 0 24px 24px;
      box-shadow: 0 4px 15px rgba(230, 81, 0, 0.15);
    }

    .user-message .message-sender {
      color: rgba(255, 255, 255, 0.9);
    }

    /* Glass UI for bot messages */
    .bot-message {
      align-self: flex-start;
      max-width: 80%;
    }

    .bot-message .message-content {
      background: rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(10px);
      padding: 16px;
      border-radius: 0 24px 24px 24px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
      border: 1px solid rgba(224, 224, 224, 0.5);
    }

    .dark-mode .bot-message .message-content {
      background: rgba(45, 45, 45, 0.7);
      border: 1px solid var(--dark-border);
    }

    .bot-message .message-sender {
      color: var(--primary-dark);
    }

    .bot-message .message-text {
      font-family: 'Merriweather', serif;
      font-size: 15px;
      line-height: 1.8;
    }

    /* NEW: Rich Text Editor for essay/grammar content */
    .rich-text-editor {
      background-color: var(--editor-bg);
      border: 1px solid var(--editor-border);
      border-radius: 8px;
      margin-top: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      position: relative;
      overflow: hidden;
    }

    .editor-toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      padding: 10px;
      background-color: var(--editor-toolbar-bg);
      border-bottom: 1px solid var(--editor-border);
    }

    .toolbar-btn {
      background: none;
      border: none;
      border-radius: 4px;
      padding: 6px 8px;
      cursor: pointer;
      font-size: 14px;
      color: var(--dark-gray);
      transition: var(--transition);
    }

    .toolbar-btn:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }

    .dark-mode .toolbar-btn:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }

    .toolbar-btn.active {
      background-color: rgba(230, 81, 0, 0.1);
      color: var(--primary-color);
    }

    .toolbar-separator {
      width: 1px;
      height: 20px;
      background-color: var(--editor-border);
      margin: 0 5px;
    }

    .editor-content {
      padding: 15px;
      min-height: 150px;
      max-height: 400px;
      overflow-y: auto;
      font-family: 'Merriweather', serif;
      line-height: 1.8;
      color: var(--dark-gray);
    }

    .dark-mode .editor-content {
      color: var(--dark-text);
    }

    .editor-statusbar {
      display: flex;
      justify-content: space-between;
      padding: 8px 15px;
      font-size: 12px;
      color: var(--dark-gray);
      background-color: var(--editor-toolbar-bg);
      border-top: 1px solid var(--editor-border);
    }

    /* NEW: Terminal for code content */
    .terminal {
      background-color: var(--terminal-bg);
      border: 1px solid var(--terminal-border);
      border-radius: 8px;
      margin-top: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
    }

    .terminal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 15px;
      background-color: #333333;
      border-bottom: 1px solid #444444;
    }

    .terminal-title {
      color: #f8f8f8;
      font-family: 'Poppins', sans-serif;
      font-size: 14px;
      font-weight: 600;
    }

    .terminal-actions {
      display: flex;
      gap: 8px;
    }

    .terminal-action {
      background: none;
      border: none;
      color: #cccccc;
      font-size: 14px;
      cursor: pointer;
      opacity: 0.7;
      transition: var(--transition);
      padding: 4px;
      border-radius: 4px;
    }

    .terminal-action:hover {
      opacity: 1;
      background-color: rgba(255, 255, 255, 0.1);
    }

    .terminal-content {
      padding: 15px;
      min-height: 200px;
      max-height: 400px;
      overflow-y: auto;
      font-family: 'Fira Code', monospace;
      font-size: 14px;
      line-height: 1.5;
      color: var(--terminal-text);
    }

    .terminal-line {
      display: flex;
      margin-bottom: 5px;
    }

    .terminal-prompt {
      color: var(--terminal-prompt);
      margin-right: 10px;
      user-select: none;
    }

    .terminal-output {
      white-space: pre-wrap;
      word-break: break-word;
    }

    /* Message actions */
    .message-actions {
      position: absolute;
      top: 10px;
      right: 10px;
      display: none;
    }

    .message:hover .message-actions {
      display: flex;
    }

    .message-action-btn {
      background: none;
      border: none;
      color: rgba(0, 0, 0, 0.5);
      cursor: pointer;
      font-size: 14px;
      padding: 4px;
      border-radius: 4px;
      transition: var(--transition);
    }

    .dark-mode .message-action-btn {
      color: rgba(255, 255, 255, 0.5);
    }

    .user-message .message-action-btn {
      color: rgba(255, 255, 255, 0.7);
    }

    .message-action-btn:hover {
      background-color: rgba(0, 0, 0, 0.1);
      color: var(--primary-color);
    }

    .user-message .message-action-btn:hover {
      background-color: rgba(255, 255, 255, 0.2);
      color: var(--white);
    }

    /* Chat actions - Removed refresh and down arrow buttons */
    .chat-actions {
      position: absolute;
      bottom: 90px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 10;
    }

    /* Input Area - Updated to be centered initially and fixed positioning issue */
    .input-container {
      position: absolute;
      bottom: 60px; /* Increased from 0 to lift it above the footer */
      left: 0;
      right: 0;
      padding: 20px;
      background-color: transparent;
      display: flex;
      justify-content: center;
      transition: all 0.3s ease;
      z-index: 10; /* Added z-index to ensure it stays above other elements */
    }

    .input-container.with-messages {
      position: relative;
      bottom: 0; /* Reset bottom position when in message view */
      margin-bottom: 60px; /* Add margin to prevent footer overlap */
    }

    .input-wrapper {
      position: relative;
      border-radius: 30px; /* Circular input field */
      border: 1px solid rgba(224, 224, 224, 0.7);
      background-color: rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(10px);
      overflow: hidden;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
      transition: var(--transition);
      max-width: 700px;
      width: 100%;
    }

    .dark-mode .input-wrapper {
      border: 1px solid var(--dark-border);
      background-color: rgba(45, 45, 45, 0.7);
    }

    .welcome-screen .input-wrapper {
      width: 70%;
      max-width: 700px;
    }

    .input-wrapper:focus-within {
      box-shadow: 0 4px 20px rgba(230, 81, 0, 0.15);
      border-color: var(--primary-light);
      background-color: rgba(255, 255, 255, 0.9);
    }

    .dark-mode .input-wrapper:focus-within {
      background-color: rgba(45, 45, 45, 0.9);
    }

    #userInput {
      width: 100%;
      padding: 16px 60px 16px 20px; /* Increased left padding for circular look */
      border: none;
      outline: none;
      resize: none;
      font-family: 'Source Sans Pro', sans-serif;
      font-size: 16px;
      max-height: 150px;
      min-height: 56px;
      background: transparent;
      border-radius: 30px; /* Match parent's border-radius */
      color: var(--dark-gray);
    }

    .send-btn {
      position: absolute;
      right: 8px; /* Adjusted for circular input */
      bottom: 8px; /* Adjusted for circular input */
      background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
      color: var(--white);
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 2px 8px rgba(230, 81, 0, 0.2);
    }

    .send-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 12px rgba(230, 81, 0, 0.3);
    }

    .send-btn:disabled {
      background: linear-gradient(135deg, #9e9e9e, #757575);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    /* Stop button (replaces send button during AI response) */
    .stop-btn {
      position: absolute;
      right: 8px;
      bottom: 8px;
      background: linear-gradient(135deg, #f44336, #d32f2f);
      color: var(--white);
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: none;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 2px 8px rgba(211, 47, 47, 0.3);
    }

    .stop-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 12px rgba(211, 47, 47, 0.4);
    }

    /* About button - Moved to header area */
    .about-btn {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.8);
      color: var(--primary-color);
      border: 1px solid rgba(230, 81, 0, 0.2);
      border-radius: 20px;
      padding: 8px 16px;
      font-family: 'Poppins', sans-serif;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      backdrop-filter: blur(5px);
      display: flex;
      align-items: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      z-index: 50;
    }

    .dark-mode .about-btn {
      background: rgba(45, 45, 45, 0.8);
    }

    .about-btn:hover {
      background: rgba(230, 81, 0, 0.1);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
    }

    .about-btn i {
      margin-right: 6px;
    }

    /* Dark mode toggle button */
    .dark-mode-toggle {
      position: absolute;
      top: 20px;
      right: 150px;
      background: rgba(255, 255, 255, 0.8);
      color: var(--primary-color);
      border: 1px solid rgba(230, 81, 0, 0.2);
      border-radius: 20px;
      padding: 8px 16px;
      font-family: 'Poppins', sans-serif;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      backdrop-filter: blur(5px);
      display: flex;
      align-items: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      z-index: 50;
    }

    .dark-mode .dark-mode-toggle {
      background: rgba(45, 45, 45, 0.8);
    }

    .dark-mode-toggle:hover {
      background: rgba(230, 81, 0, 0.1);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
    }

    .dark-mode-toggle i {
      margin-right: 6px;
    }

    /* Footer - Removed background container */
    .footer {
      padding: 14px;
      text-align: center;
      font-family: 'Source Sans Pro', sans-serif;
      font-size: 13px;
      color: var(--dark-gray);
      position: absolute; /* Changed to absolute positioning */
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 5; /* Lower z-index than input container */
    }

    .footer p {
      margin-bottom: 4px;
    }

    /* Auth Modal */
    .auth-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(5px);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .auth-content {
      background-color: var(--white);
      padding: 32px;
      border-radius: 24px;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
      animation: modalFadeIn 0.3s ease-out;
    }

    .dark-mode .auth-content {
      background-color: var(--dark-surface);
      color: var(--dark-text);
    }

    @keyframes modalFadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .auth-header {
      text-align: center;
      margin-bottom: 28px;
    }

    .auth-title {
      font-family: 'Poppins', sans-serif;
      font-size: 26px;
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 10px;
    }

    .auth-subtitle {
      font-family: 'Playfair Display', serif;
      color: var(--dark-gray);
      font-size: 16px;
    }

    .auth-buttons {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .auth-btn {
      display: flex;
      align-items: center;
      padding: 14px 16px;
      border-radius: 16px;
      border: 1px solid var(--medium-gray);
      background-color: var(--white);
      cursor: pointer;
      transition: var(--transition);
      font-family: 'Source Sans Pro', sans-serif;
    }

    .dark-mode .auth-btn {
      background-color: var(--dark-surface-light);
      border: 1px solid var(--dark-border);
      color: var(--dark-text);
    }

    .auth-btn:hover {
      background-color: var(--light-gray);
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
    }

    .dark-mode .auth-btn:hover {
      background-color: var(--dark-surface);
    }

    .auth-btn img {
      width: 24px;
      height: 24px;
      margin-right: 16px;
    }

    .auth-btn span {
      font-weight: 600;
      font-size: 15px;
    }

    .auth-close {
      text-align: center;
      margin-top: 24px;
      color: var(--dark-gray);
      cursor: pointer;
      font-family: 'Source Sans Pro', sans-serif;
      font-size: 15px;
      transition: var(--transition);
      padding: 8px;
    }

    .auth-close:hover {
      color: var(--primary-color);
      text-decoration: underline;
    }

    /* About Modal */
    .about-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(5px);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .about-content {
      background-color: var(--white);
      padding: 32px;
      border-radius: 24px;
      width: 90%;
      max-width: 700px;
      max-height: 85vh;
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
      animation: modalFadeIn 0.3s ease-out;
      position: relative;
      overflow-y: auto;
    }

    .dark-mode .about-content {
      background-color: var(--dark-surface);
      color: var(--dark-text);
    }

    .about-close {
      position: absolute;
      top: 20px;
      right: 20px;
      background: none;
      border: none;
      font-size: 24px;
      color: var(--dark-gray);
      cursor: pointer;
      transition: var(--transition);
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      z-index: 10;
    }

    .about-close:hover {
      background-color: var(--light-gray);
      color: var(--primary-color);
    }

    .about-header {
      text-align: center;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--medium-gray);
    }

    .dark-mode .about-header {
      border-bottom: 1px solid var(--dark-border);
    }

    .about-title {
      font-family: 'Poppins', sans-serif;
      font-size: 28px;
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 8px;
    }
    

    .about-subtitle {
      font-family: 'Playfair Display', serif;
      color: var(--dark-gray);
      font-size: 16px;
    }

    .about-body {
      margin-bottom: 24px;
    }

    .about-section {
      margin-bottom: 28px;
      padding-bottom: 20px;
      border-bottom: 1px dashed var(--medium-gray);
    }

    .dark-mode .about-section {
      border-bottom: 1px dashed var(--dark-border);
    }

    .about-section:last-child {
      border-bottom: none;
    }

    .about-section-title {
      font-family: 'Poppins', sans-serif;
      font-size: 20px;
      font-weight: 600;
      color: var(--primary-dark);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
    }

    .about-section-title i {
      margin-right: 10px;
      color: var(--primary-color);
    }

    .about-text {
      font-family: 'Source Sans Pro', sans-serif;
      font-size: 15px;
      line-height: 1.7;
      color: var(--dark-gray);
      margin-bottom: 16px;
    }

    /* New styles for enhanced about section */
    .about-text-highlight {
      font-weight: 600;
      color: var(--primary-color);
    }

    .about-list {
      margin: 15px 0;
      padding-left: 20px;
    }

    .about-list li {
      margin-bottom: 10px;
      position: relative;
      padding-left: 15px;
    }

    .about-list li::before {
      content: "•";
      color: var(--primary-color);
      font-weight: bold;
      position: absolute;
      left: 0;
    }

    .ai-providers {
      display: flex;
      flex-wrap: wrap;
      gap: 24px;
      margin-top: 20px;
      justify-content: center;
    }

    .ai-provider {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: calc(33.333% - 16px);
      text-align: center;
    }

    .provider-logo {
      width: 60px;
      height: 60px;
      border-radius: 12px;
      margin-bottom: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transition: var(--transition);
    }

    .provider-logo:hover {
      transform: scale(1.1);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    }

    .provider-name {
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      font-size: 16px;
      color: var(--primary-color);
      margin-bottom: 6px;
    }

    .provider-desc {
      font-family: 'Source Sans Pro', sans-serif;
      font-size: 14px;
      color: var(--dark-gray);
      line-height: 1.5;
    }

    /* Stats section */
    .stats-container {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
      margin-bottom: 30px;
      flex-wrap: wrap;
      gap: 15px;
    }

    .stat-item {
      background-color: rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 16px;
      flex: 1;
      min-width: 120px;
      text-align: center;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
      border: 1px solid var(--medium-gray);
      transition: var(--transition);
    }

    .dark-mode .stat-item {
      background-color: rgba(45, 45, 45, 0.7);
      border: 1px solid var(--dark-border);
    }

    .stat-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
    }

    .stat-value {
      font-family: 'Poppins', sans-serif;
      font-size: 24px;
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .stat-label {
      font-family: 'Source Sans Pro', sans-serif;
      font-size: 13px;
      color: var(--dark-gray);
    }

    /* Version badge */
    .version-badge {
      position: absolute;
      top: 20px;
      right: 70px;
      background-color: rgba(230, 81, 0, 0.1);
      backdrop-filter: blur(5px);
      color: var(--primary-color);
      font-family: 'Poppins', sans-serif;
      font-size: 12px;
      font-weight: 600;
      padding: 4px 10px;
      border-radius: 20px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }

    /* Professional animations */
    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideInLeft {
      from {
        opacity: 0;
        transform: translateX(-30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .animate-fade-in-up {
      animation: fadeInUp 0.5s ease-out forwards;
    }

    .animate-slide-in-left {
      animation: slideInLeft 0.5s ease-out forwards;
    }

    .animate-slide-in-right {
      animation: slideInRight 0.5s ease-out forwards;
    }

    /* Language selector enhanced */
    .language-selector {
      position: absolute;
      top: 20px;
      left: 20px;
      z-index: 5;
      background-color: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      padding: 8px;
      display: flex;
      align-items: center;
      cursor: pointer;
      transition: var(--transition);
      border: 1px solid rgba(224, 224, 224, 0.7);
    }

    .dark-mode .language-selector {
      background-color: rgba(45, 45, 45, 0.8);
      border: 1px solid var(--dark-border);
    }

    .language-selector:hover {
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
      transform: translateY(-2px);
    }

    .language-selector i {
      margin-right: 6px;
      color: var(--primary-color);
    }

    .language-selector span {
      font-family: 'Source Sans Pro', sans-serif;
      font-size: 14px;
      font-weight: 600;
    }

    .language-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      background-color: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      padding: 8px 0;
      width: 180px;
      display: none;
      z-index: 10;
      margin-top: 8px;
      border: 1px solid rgba(224, 224, 224, 0.7);
      animation: fadeInUp 0.3s ease-out forwards;
    }

    .dark-mode .language-dropdown {
      background-color: rgba(45, 45, 45, 0.9);
      border: 1px solid var(--dark-border);
    }

    .language-option {
      padding: 8px 16px;
      font-family: 'Source Sans Pro', sans-serif;
      font-size: 14px;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
    }

    .language-option:hover {
      background-color: rgba(248, 249, 250, 0.7);
    }

    .dark-mode .language-option:hover {
      background-color: rgba(60, 60, 60, 0.7);
    }

    .language-option.active {
      background-color: rgba(230, 81, 0, 0.1);
      color: var(--primary-color);
      font-weight: 600;
    }

    .language-flag {
      width: 20px;
      height: 15px;
      margin-right: 10px;
      border-radius: 2px;
      object-fit: cover;
    }

    /* Team section for About modal */
    .team-section {
      margin-top: 30px;
    }

    .team-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .team-member {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .team-member-photo {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      margin-bottom: 10px;
      border: 3px solid var(--primary-light);
    }

    .team-member-name {
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      font-size: 16px;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .team-member-role {
      font-family: 'Source Sans Pro', sans-serif;
      font-size: 14px;
      color: var(--dark-gray);
    }

    /* Features section */
    .feature-badge {
      display: inline-flex;
      align-items: center;
      background-color: rgba(230, 81, 0, 0.1);
      color: var(--primary-color);
      font-family: 'Poppins', sans-serif;
      font-size: 12px;
      font-weight: 600;
      padding: 4px 10px;
      border-radius: 20px;
      margin-right: 8px;
      margin-bottom: 8px;
    }

    .feature-badge i {
      margin-right: 5px;
      font-size: 10px;
    }

    .features-container {
      display: flex;
      flex-wrap: wrap;
      margin-top: 10px;
      margin-bottom: 20px;
    }

    /* Empty state */
    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 40px 20px;
      height: 100%;
    }

    .empty-state-icon {
      font-size: 60px;
      color: var(--medium-gray);
      margin-bottom: 20px;
    }

    .empty-state-title {
      font-family: 'Poppins', sans-serif;
      font-size: 22px;
      font-weight: 600;
      color: var(--dark-gray);
      margin-bottom: 10px;
    }

    .empty-state-text {
      font-family: 'Source Sans Pro', sans-serif;
      font-size: 16px;
      color: var(--dark-gray);
      max-width: 400px;
      margin-bottom: 20px;
      line-height: 1.6;
    }

    .empty-state-btn {
      background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
      color: var(--white);
      border: none;
      border-radius: 16px;
      padding: 12px 24px;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 4px 12px rgba(230, 81, 0, 0.2);
    }

    .empty-state-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 18px rgba(230, 81, 0, 0.3);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .sidebar {
        position: fixed;
        top: 0;
        left: -280px; /* Hidden by default */
        height: 100%;
        z-index: 1000;
      }

      .sidebar.active {
        left: 0;
      }

      .main-content {
        margin-left: 0 !important;
        width: 100% !important;
      }

      .mobile-header {
        display: flex;
      }

      .message-content {
        padding-right: 0;
      }

      .welcome-title {
        font-size: 28px;
        padding: 0 10px;
        overflow-wrap: break-word;
        word-wrap: break-word;
      }

      .welcome-subtitle {
        font-size: 16px;
        padding: 0 10px;
      }

      .welcome-logo {
        width: 90px;
        height: 90px;
      }

      .ai-provider {
        width: 100%;
        margin-bottom: 20px;
      }

      .user-message, .bot-message {
        max-width: 90%;
      }
      
      .about-btn, .dark-mode-toggle {
        padding: 8px;
        right: 10px;
        border-radius: 50%;
        width: 40px;
        height: 40px;
      }
      
      .dark-mode .about-btn, .dark-mode .dark-mode-toggle {
        background: rgba(45, 45, 45, 0.8);
      }

      .about-btn i, .dark-mode-toggle i {
        margin-right: 0;
      }

      .about-btn span, .dark-mode-toggle span {
        display: none;
      }
      
      .welcome-screen .input-wrapper {
        width: 90%;
      }
      
      /* Adjust input container for mobile */
      .input-container {
        bottom: 50px; /* Slightly reduced for mobile */
      }
      
      .input-container.with-messages {
        margin-bottom: 50px; /* Reduced for mobile */
      }
      
      .version-badge {
        right: 110px;
      }
      
      /* Adjust rich text editor for mobile */
      .editor-toolbar {
        flex-wrap: wrap;
        gap: 2px;
        padding: 8px;
      }
      
      .toolbar-btn {
        padding: 4px 6px;
        font-size: 12px;
      }
      
      .terminal-header {
        padding: 6px 10px;
      }
    }

    @media (max-width: 480px) {
      .auth-content, .about-content {
        padding: 24px;
      }

      .welcome-title {
        font-size: 24px;
      }

      .user-message, .bot-message {
        max-width: 95%;
      }

      .team-grid {
        grid-template-columns: 1fr;
      }

      .chat-actions {
        bottom: 80px;
        right: 10px;
      }
      
      .rich-text-editor, .terminal {
        margin-top: 8px;
      }
      
      .editor-content, .terminal-content {
        padding: 10px;
        min-height: 120px;
      }
    }

    /* Loading Animation */
    .typing-indicator {
      display: flex;
      align-items: center;
      margin-top: 8px;
    }

    .typing-dot {
      width: 8px;
      height: 8px;
      background-color: var(--primary-color);
      border-radius: 50%;
      margin: 0 3px;
      animation: typing-animation 1.4s infinite ease-in-out;
    }

    .typing-dot:nth-child(1) {
      animation-delay: 0s;
    }

    .typing-dot:nth-child(2) {
      animation-delay: 0.2s;
    }

    .typing-dot:nth-child(3) {
      animation-delay: 0.4s;
    }

    @keyframes typing-animation {
      0%, 60%, 100% {
        transform: translateY(0);
        opacity: 0.6;
      }
      30% {
        transform: translateY(-6px);
        opacity: 1;
      }
    }

    /* Typing animation for welcome message */
    .typing-text {
      display: inline-block;
      white-space: nowrap;
      overflow: hidden;
      animation: typing 3.5s steps(40, end);
    }

    @keyframes typing {
      from { width: 0 }
      to { width: 100% }
    }
    
    /* Text typing animation for AI responses */
    .typing-animation {
      display: inline-block;
      width: 0;
      overflow: hidden;
      white-space: pre-wrap;
      animation: textTyping 0.05s steps(1) forwards;
    }
    
    @keyframes textTyping {
      to { width: 100%; }
    }

    /* Copy tooltip */
    .copy-tooltip {
      position: absolute;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      top: -25px;
      right: 10px;
      opacity: 0;
      transition: opacity 0.3s;
      pointer-events: none;
    }

    .copy-tooltip.show {
      opacity: 1;
    }
    
    /* Cursor animation for terminal */
    .terminal-cursor {
      display: inline-block;
      width: 8px;
      height: 16px;
      background-color: var(--terminal-prompt);
      margin-left: 2px;
      animation: cursor-blink 1s infinite;
    }
    
    @keyframes cursor-blink {
      0%, 49% { opacity: 1; }
      50%, 100% { opacity: 0; }
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <div class="logo-container">
      <img src="SILAKBO.png" alt="SILAKBO Logo" class="logo">
      <div>
        <div class="logo-text">ANG SILAKBO</div>
        <div class="logo-description">The Official Publication Page of University of Cebu Lapu-Lapu and Mandaue</div>
      </div>
    </div>
    
    <button class="new-chat-btn" id="newChatBtn">
      <i class="fas fa-plus"></i> New chat
    </button>
    
    <button class="back-home-btn" id="backHomeBtn">
      <i class="fas fa-home"></i> Back to Home
    </button>
    
    <div class="chat-history-header">
      <div class="chat-history-title">Recent Conversations</div>
      <div class="chat-history-actions">
        <button class="history-action-btn" id="clearHistoryBtn" title="Clear History">
          <i class="fas fa-trash-alt"></i>
        </button>
      </div>
    </div>
    
    <div class="chat-history" id="chatHistory">
      <!-- Chat history items will be added here -->
    </div>
    
    <div class="user-profile" id="userProfile">
      <img src="https://ui-avatars.com/api/?name=Guest&background=e65100&color=fff" alt="User Avatar" class="user-avatar" id="userAvatar">
      <div class="user-name" id="userName">Sign in</div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content" id="mainContent">
    <div class="mobile-header">
      <button class="menu-toggle" id="menuToggle">
        <i class="fas fa-bars"></i>
      </button>
      <div class="mobile-logo-container">
        <div class="mobile-logo-wrapper">
          <img src="SILAKBO.png" alt="SILAKBO Logo" class="mobile-logo">
          <div class="mobile-logo-text">ANG SILAKBO</div>
        </div>
        <div class="mobile-logo-description">The Official Publication Page of University of Cebu Lapu-Lapu and Mandaue</div>
      </div>
    </div>

    <!-- About button moved to header area -->
    <button class="about-btn" id="aboutBtn">
      <i class="fas fa-info-circle"></i> <span>About</span>
    </button>
    
    <!-- Dark mode toggle button -->
    <button class="dark-mode-toggle" id="darkModeToggle">
      <i class="fas fa-moon"></i> <span>Dark Mode</span>
    </button>
    
    <div class="version-badge">v1.6.0</div>

    <div class="chat-container" id="chatContainer">
      <!-- Welcome Screen -->
      <div class="welcome-screen" id="welcomeScreen">
        <div class="language-selector" id="languageSelector">
          <i class="fas fa-globe"></i>
          <span>Language</span>
          <div class="language-dropdown" id="languageDropdown">
            <div class="language-option active" data-lang="en">
              <img src="https://flagcdn.com/w20/us.png" alt="English" class="language-flag">
              English
            </div>
            <div class="language-option" data-lang="es">
              <img src="https://flagcdn.com/w20/es.png" alt="Spanish" class="language-flag">
              Español
            </div>
            <div class="language-option" data-lang="fr">
              <img src="https://flagcdn.com/w20/fr.png" alt="French" class="language-flag">
              Français
            </div>
            <div class="language-option" data-lang="de">
              <img src="https://flagcdn.com/w20/de.png" alt="German" class="language-flag">
              Deutsch
            </div>
            <div class="language-option" data-lang="it">
              <img src="https://flagcdn.com/w20/it.png" alt="Italian" class="language-flag">
              Italiano
            </div>
            <div class="language-option" data-lang="ru">
              <img src="https://flagcdn.com/w20/ru.png" alt="Russian" class="language-flag">
              Русский
            </div>
            <div class="language-option" data-lang="zh">
              <img src="https://flagcdn.com/w20/cn.png" alt="Chinese" class="language-flag">
              中文
            </div>
            <div class="language-option" data-lang="ja">
              <img src="https://flagcdn.com/w20/jp.png" alt="Japanese" class="language-flag">
              日本語
            </div>
            <div class="language-option" data-lang="ar">
              <img src="https://flagcdn.com/w20/sa.png" alt="Arabic" class="language-flag">
              العربية
            </div>
            <div class="language-option" data-lang="he">
              <img src="https://flagcdn.com/w20/il.png" alt="Hebrew" class="language-flag">
              עברית
            </div>
            <div class="language-option" data-lang="hi">
              <img src="https://flagcdn.com/w20/in.png" alt="Hindi" class="language-flag">
              हिन्दी
            </div>
            <div class="language-option" data-lang="ko">
              <img src="https://flagcdn.com/w20/kr.png" alt="Korean" class="language-flag">
              한국어
            </div>
          </div>
        </div>
        <img src="Coral.png" alt="SILAKBO Logo" class="welcome-logo">
        <h1 class="welcome-title animate-fade-in-up" id="welcomeTitle">
            <span class="typing-text" id="greetingText"></span>
          </h1>
      </div>

      <!-- Messages will be displayed here -->
      <div class="message-container" id="messageContainer" style="display: none;"></div>
      
      <!-- Empty state for when no conversation is selected -->
      <div class="empty-state" id="emptyState" style="display: none;">
        <i class="fas fa-comments empty-state-icon"></i>
        <h3 class="empty-state-title">No Conversation Selected</h3>
        <p class="empty-state-text">Select a conversation from the sidebar or start a new chat to begin.</p>
        <button class="empty-state-btn" id="emptyStateNewChatBtn">
          <i class="fas fa-plus"></i> Start New Chat
        </button>
      </div>
    </div>

    <div class="input-container" id="inputContainer">
      <div class="input-wrapper">
        <textarea id="userInput" placeholder="Message Coral..." rows="1"></textarea>
        <button class="send-btn" id="sendBtn" disabled>
          <i class="fas fa-paper-plane"></i>
        </button>
        <button class="stop-btn" id="stopBtn">
          <i class="fas fa-stop"></i>
        </button>
      </div>
    </div>

    <div class="footer">
      <p>CoralVIA can make lapses. Check other resources for accurate informations.</p>
    </div>
  </div>

  <!-- Auth Modal -->
  <div class="auth-modal" id="authModal">
    <div class="auth-content">
      <div class="auth-header">
        <h2 class="auth-title">Sign in to SILAKBO</h2>
        <p class="auth-subtitle">Choose a sign-in method to continue</p>
      </div>
      <div class="auth-buttons">
        <button class="auth-btn" id="googleSignIn">
          <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
          <span>Continue with Google</span>
        </button>
        <button class="auth-btn" id="githubSignIn">
          <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/github.svg" alt="GitHub">
          <span>Continue with GitHub</span>
        </button>
        <button class="auth-btn" id="facebookSignIn">
          <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/facebook.svg" alt="Facebook">
          <span>Continue with Facebook</span>
        </button>
      </div>
      <div class="auth-close" id="authClose">Cancel</div>
    </div>
  </div>

  <!-- About Modal -->
  <div class="about-modal" id="aboutModal">
    <div class="about-content">
      <button class="about-close" id="aboutClose">
        <i class="fas fa-times"></i>
      </button>
      <div class="about-header">
        <h2 class="about-title">About ANG SILAKBO's CoralVIA</h2>
        <p class="about-subtitle">Empowering student voices through AI</p>
      </div>
      <div class="about-body">
        <div class="about-section">
          <h3 class="about-section-title"><i class="fas fa-bullseye"></i>Our Mission</h3>
          <p class="about-text">
            ANG SILAKBO's CoralVIA is designed to assist students and faculty of the University of Cebu Lapu-Lapu and Mandaue with their academic and creative needs. Our mission is to enhance the educational experience through cutting-edge AI technology while preserving the authentic voice of student publications.
          </p>
          <p class="about-text">
            We aim to <span class="about-text-highlight">democratize access to AI tools</span> for all students, regardless of their technical background, and to foster a community of innovation and creativity within the university.
          </p>
        </div>
        
        <div class="about-section">
          <h3 class="about-section-title"><i class="fas fa-robot"></i>Powered By Leading AI Technologies</h3>
          <p class="about-text">
            ANG SILAKBO's CoralVIA leverages multiple state-of-the-art language models to provide diverse, accurate, and helpful responses. Our system combines the strengths of three leading AI providers:
          </p>
          <div class="ai-providers">
            <div class="ai-provider">
              <img src="OpenAI.png" alt="OpenAI Logo" class="provider-logo">
              <div class="provider-name">OpenAI</div>
              <p class="provider-desc">Powering creative writing and detailed explanations with advanced language understanding.</p>
            </div>
            <div class="ai-provider">
              <img src="Mistral.png" alt="Mistral AI Logo" class="provider-logo">
              <div class="provider-name">Mistral AI</div>
              <p class="provider-desc">Providing efficient and accurate responses with European AI innovation.</p>
            </div>
            <div class="ai-provider">
              <img src="Cohere.png" alt="Cohere Logo" class="provider-logo">
              <div class="provider-name">Cohere</div>
              <p class="provider-desc">Enhancing content generation with specialized knowledge and multilingual capabilities.</p>
            </div>
          </div>
        </div>
        
        <div class="about-section">
          <h3 class="about-section-title"><i class="fas fa-lightbulb"></i>Key Features</h3>
          <p class="about-text">
            ANG SILAKBO's CoralVIA offers a range of features designed to support academic and creative endeavors:
          </p>
          <ul class="about-list">
            <li><strong>Multilingual Support:</strong> Communicate in 12 different languages to serve our diverse student body</li>
            <li><strong>Creative Writing Assistance:</strong> Get help with poems, stories, essays, and other creative works</li>
            <li><strong>Research Support:</strong> Find information, generate summaries, and explore concepts</li>
            <li><strong>Learning Aid:</strong> Explain complex topics in simple terms and provide educational content</li>
            <li><strong>Publication Support:</strong> Assist with editing, proofreading, and content generation for student publications</li>
          </ul>
          <div class="features-container">
            <div class="feature-badge"><i class="fas fa-globe"></i> Multilingual</div>
            <div class="feature-badge"><i class="fas fa-pen-fancy"></i> Creative</div>
            <div class="feature-badge"><i class="fas fa-brain"></i> Intelligent</div>
            <div class="feature-badge"><i class="fas fa-bolt"></i> Fast</div>
            <div class="feature-badge"><i class="fas fa-shield-alt"></i> Secure</div>
          </div>
        </div>
        
        <div class="about-section">
          <h3 class="about-section-title"><i class="fas fa-users"></i>Our Team</h3>
          <p class="about-text">
            ANG SILAKBO's CoralVIA is maintained for leveraging technology for education.
          </p>
            <div class="team-grid" style="display: flex; justify-content: center;">
            <div class="team-member">
              <img src="Roni.jpg" alt="Maria Santos" class="team-member-photo">
              <div class="team-member-name">Ron Asnahon</div>
              <div class="team-member-role">Project Lead</div>
            </div>
            </div>
          </div>
        <div class="about-section">
          <h3 class="about-section-title"><i class="fas fa-shield-alt"></i>Responsible AI Use</h3>
          <p class="about-text">
            While ANG SILAKBO's CoralVIA provides valuable assistance, we encourage critical thinking and responsible use. All AI-generated content should be reviewed, fact-checked, and properly attributed when used in academic or publication contexts.
          </p>
          <p class="about-text">
            We are committed to ethical AI practices, including:
          </p>
          <ul class="about-list">
            <li>Transparency about AI-generated content</li>
            <li>Privacy protection for all users</li>
            <li>Continuous monitoring for bias and inaccuracies</li>
            <li>Regular updates to improve performance and safety</li>
          </ul>
        </div>
    
        
        <div class="about-section">
          <h3 class="about-section-title"><i class="fas fa-hands-helping"></i>Get Involved</h3>
          <p class="about-text">
            We welcome contributions from students and faculty who are interested in improving ANG SILAKBO's CoralVIA. Whether you have feedback, feature suggestions, or want to join our development team, we'd love to hear from you.
          </p>
          <p class="about-text">
            Contact us at <span class="about-text-highlight">uclm.angsilakbo@uc.edu.ph</span> to learn more about how you can get involved.
          </p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDSe2c9-8xqShoHEW-D7BXXAyD5N9uXWEs",
      authDomain: "ang-silakbo.firebaseapp.com",
      databaseURL: "https://ang-silakbo-default-rtdb.firebaseio.com",
      projectId: "ang-silakbo",
      storageBucket: "ang-silakbo.firebasestorage.app",
      messagingSenderId: "1006400633782",
      appId: "1:1006400633782:web:ef4a93c1d445cb825b9f17",
      measurementId: "G-TSDTG2YJ94"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();

    // DOM Elements
    const sidebar = document.getElementById('sidebar');
    const mainContent = document.getElementById('mainContent');
    const menuToggle = document.getElementById('menuToggle');
    const userInput = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');
    const stopBtn = document.getElementById('stopBtn');
    const chatContainer = document.getElementById('chatContainer');
    const messageContainer = document.getElementById('messageContainer');
    const welcomeScreen = document.getElementById('welcomeScreen');
    const emptyState = document.getElementById('emptyState');
    const newChatBtn = document.getElementById('newChatBtn');
    const emptyStateNewChatBtn = document.getElementById('emptyStateNewChatBtn');
    const backHomeBtn = document.getElementById('backHomeBtn');
    const chatHistory = document.getElementById('chatHistory');
    const userProfile = document.getElementById('userProfile');
    const userAvatar = document.getElementById('userAvatar');
    const userName = document.getElementById('userName');
    const authModal = document.getElementById('authModal');
    const authClose = document.getElementById('authClose');
    const googleSignIn = document.getElementById('googleSignIn');
    const githubSignIn = document.getElementById('githubSignIn');
    const facebookSignIn = document.getElementById('facebookSignIn');
    const welcomeTitle = document.getElementById('welcomeTitle');
    const greetingText = document.getElementById('greetingText');
    const aboutBtn = document.getElementById('aboutBtn');
    const aboutModal = document.getElementById('aboutModal');
    const aboutClose = document.getElementById('aboutClose');
    const languageSelector = document.getElementById('languageSelector');
    const languageDropdown = document.getElementById('languageDropdown');
    const languageOptions = document.querySelectorAll('.language-option');
    const darkModeToggle = document.getElementById('darkModeToggle');
    const inputContainer = document.getElementById('inputContainer');

    // Variables for controlling response generation
    let isGeneratingResponse = false;
    let shouldStopResponse = false;
    let currentTypingInterval = null;
    let sidebarVisible = false;
    let isDarkMode = false;

    // Multilingual greetings
    const greetings = [
      { lang: 'he', text: 'יום טוב, {name}!' }, // Hebrew
      { lang: 'en', text: 'Good day, {name}!' }, // English
      { lang: 'es', text: '¡Buen día, {name}!' }, // Spanish
      { lang: 'fr', text: 'Bonjour, {name}!' }, // French
      { lang: 'de', text: 'Guten Tag, {name}!' }, // German
      { lang: 'it', text: 'Buongiorno, {name}!' }, // Italian
      { lang: 'ru', text: 'Добрый день, {name}!' }, // Russian
      { lang: 'zh', text: '{name}，你好！' }, // Chinese
      { lang: 'ja', text: 'こんにちは、{name}！' }, // Japanese
      { lang: 'ar', text: 'يوم جيد، {name}!' }, // Arabic
      { lang: 'hi', text: 'नमस्ते, {name}!' }, // Hindi
      { lang: 'ko', text: '안녕하세요, {name}!' }  // Korean
    ];

    // Current chat state
    let currentUser = null;
    let currentChatId = null;
    let chatMessages = [];
    let currentGreetingIndex = Math.floor(Math.random() * greetings.length);
    let conversations = {};

    // Dark mode toggle
    darkModeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
      isDarkMode = document.body.classList.contains('dark-mode');
      
      // Update icon and text
      const icon = darkModeToggle.querySelector('i');
      const text = darkModeToggle.querySelector('span');
      
      if (isDarkMode) {
        icon.className = 'fas fa-sun';
        text.textContent = 'Light Mode';
      } else {
        icon.className = 'fas fa-moon';
        text.textContent = 'Dark Mode';
      }
      
      // Save preference to localStorage
      localStorage.setItem('darkMode', isDarkMode);
    });
    
    // Check for saved dark mode preference
    const savedDarkMode = localStorage.getItem('darkMode');
    if (savedDarkMode === 'true') {
      document.body.classList.add('dark-mode');
      isDarkMode = true;
      const icon = darkModeToggle.querySelector('i');
      const text = darkModeToggle.querySelector('span');
      icon.className = 'fas fa-sun';
      text.textContent = 'Light Mode';
    }

    // Display greeting with typing animation
    function displayGreeting() {
      const greeting = greetings[currentGreetingIndex];
      welcomeTitle.setAttribute('lang', greeting.lang);
      
      // Get name to use in greeting
      let name = currentUser ? getUserFirstName(currentUser) : "citizen";
      
      // Clear previous text
      greetingText.textContent = '';
      greetingText.style.animation = 'none';
      
      // Trigger reflow
      void greetingText.offsetWidth;
      
      // Set new text with name and restart animation
      const personalizedGreeting = greeting.text.replace('{name}', name);
      greetingText.textContent = personalizedGreeting;
      greetingText.style.animation = 'typing 3.5s steps(40, end)';
    }

    // Change greeting on page load and when returning to welcome screen
    displayGreeting();

    // Toggle sidebar function
    function toggleSidebar() {
      sidebar.classList.toggle('active');
      sidebarVisible = sidebar.classList.contains('active');
      mainContent.classList.toggle('sidebar-active', sidebarVisible);
    }

    // Mobile menu toggle
    menuToggle.addEventListener('click', toggleSidebar);

    // Language selector click
    languageSelector.addEventListener('click', (e) => {
      e.stopPropagation();
      languageDropdown.style.display = languageDropdown.style.display === 'block' ? 'none' : 'block';
    });

    // Language option click
    languageOptions.forEach(option => {
      option.addEventListener('click', (e) => {
        e.stopPropagation();
        const lang = option.getAttribute('data-lang');
        
        // Update active class
        document.querySelector('.language-option.active').classList.remove('active');
        option.classList.add('active');
        
        // Find greeting for selected language
        const selectedGreeting = greetings.findIndex(g => g.lang === lang);
        if (selectedGreeting !== -1) {
          currentGreetingIndex = selectedGreeting;
          displayGreeting();
        }
        
        languageDropdown.style.display = 'none';
      });
    });

    // Close language dropdown when clicking outside
    document.addEventListener('click', () => {
      languageDropdown.style.display = 'none';
    });

    // Close sidebar when clicking outside on mobile
    document.addEventListener('click', (e) => {
      if (window.innerWidth <= 768 && 
          sidebar.classList.contains('active') && 
          !sidebar.contains(e.target) && 
          e.target !== menuToggle) {
        sidebar.classList.remove('active');
        mainContent.classList.remove('sidebar-active');
        sidebarVisible = false;
      }
    });

    // Back to Home button
    backHomeBtn.addEventListener('click', () => {
      window.location.href = 'index.html';
    });

    // Show auth modal when clicking on input if not signed in
    userInput.addEventListener('click', () => {
      if (!currentUser) {
        authModal.style.display = 'flex';
      }
    });

    // Auto-resize textarea
    userInput.addEventListener('input', () => {
      userInput.style.height = 'auto';
      userInput.style.height = (userInput.scrollHeight < 150) ? `${userInput.scrollHeight}px` : '150px';
      sendBtn.disabled = userInput.value.trim() === '';
    });

    // Send message on Enter (but allow Shift+Enter for new line)
    userInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        if (!sendBtn.disabled && currentUser) {
          sendMessage();
        } else if (!currentUser) {
          authModal.style.display = 'flex';
        }
      }
    });

    // Send button click
    sendBtn.addEventListener('click', () => {
      if (currentUser) {
        sendMessage();
      } else {
        authModal.style.display = 'flex';
      }
    });

    // Stop button click
    stopBtn.addEventListener('click', () => {
      shouldStopResponse = true;
      stopBtn.style.display = 'none';
      sendBtn.style.display = 'flex';
      
      if (currentTypingInterval) {
        clearInterval(currentTypingInterval);
        currentTypingInterval = null;
      }
      
      isGeneratingResponse = false;
    });

    // New chat button
    newChatBtn.addEventListener('click', () => {
      if (currentUser) {
        showWelcomeScreen();
        // Change greeting when starting a new chat
        currentGreetingIndex = (currentGreetingIndex + 1) % greetings.length;
        displayGreeting();
      } else {
        authModal.style.display = 'flex';
      }
    });

    // Empty state new chat button
    emptyStateNewChatBtn.addEventListener('click', () => {
      showWelcomeScreen();
    });

    // About button
    aboutBtn.addEventListener('click', () => {
      aboutModal.style.display = 'flex';
    });

    // Close about modal
    aboutClose.addEventListener('click', () => {
      aboutModal.style.display = 'none';
    });

    // Close about modal when clicking outside
    aboutModal.addEventListener('click', (e) => {
      if (e.target === aboutModal) {
        aboutModal.style.display = 'none';
      }
    });

    // Authentication
    userProfile.addEventListener('click', () => {
      if (!currentUser) {
        authModal.style.display = 'flex';
      }
    });

    authClose.addEventListener('click', () => {
      authModal.style.display = 'none';
    });

    // Close modal when clicking outside
    authModal.addEventListener('click', (e) => {
      if (e.target === authModal) {
        authModal.style.display = 'none';
      }
    });

    // Sign in with Google
    googleSignIn.addEventListener('click', () => {
      const provider = new firebase.auth.GoogleAuthProvider();
      signInWithProvider(provider);
    });

    // Sign in with GitHub
    githubSignIn.addEventListener('click', () => {
      const provider = new firebase.auth.GithubAuthProvider();
      signInWithProvider(provider);
    });

    // Sign in with Facebook
    facebookSignIn.addEventListener('click', () => {
      const provider = new firebase.auth.FacebookAuthProvider();
      signInWithProvider(provider);
    });

    // Sign in function
    function signInWithProvider(provider) {
      firebase.auth().signInWithPopup(provider)
        .then((result) => {
          authModal.style.display = 'none';
          updateUserProfile(result.user);
          loadUserChats();
          
          // Focus on input after successful sign-in
          userInput.focus();
          
          // Update greeting with user's name
          displayGreeting();
        })
        .catch((error) => {
          console.error("Authentication error:", error);
          alert("Authentication failed. Please try again.");
        });
    }

    // Get user's first name from different providers
    function getUserFirstName(user) {
      if (!user) return "Guest";
      
      // Check provider data
      const providerId = user.providerData && user.providerData[0] ? 
                         user.providerData[0].providerId : null;
      
      // For GitHub, use username if available
      if (providerId === 'github.com') {
        // GitHub usernames are often in the email (before @) or displayName
        if (user.email && user.email.includes('@github')) {
          return user.email.split('@')[0];
        }
        // GitHub often puts the username in displayName
        return user.displayName || "GitHub User";
      }
      
      // For Google, try to get first name from displayName
      if (providerId === 'google.com') {
        if (user.displayName && user.displayName.includes(' ')) {
          return user.displayName.split(' ')[0];
        }
      }
      
      // For other providers or fallback
      if (user.displayName) {
        // Try to get first name from full name
        return user.displayName.split(' ')[0];
      }
      
      // Try to get name from email (before @)
      if (user.email) {
        return user.email.split('@')[0];
      }
      
      // Final fallback
      return "User";
    }

    // Update user profile UI
    function updateUserProfile(user) {
      currentUser = user;
      const firstName = getUserFirstName(user);
      userAvatar.src = user.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(firstName)}&background=e65100&color=fff`;
      userName.textContent = firstName;
      
      // Update greeting with user's name
      displayGreeting();
    }

    // Auth state change listener
    firebase.auth().onAuthStateChanged((user) => {
      if (user) {
        updateUserProfile(user);
        loadUserChats();
      } else {
        currentUser = null;
        userAvatar.src = "https://ui-avatars.com/api/?name=Guest&background=e65100&color=fff";
        userName.textContent = "Sign in";
        chatHistory.innerHTML = '';
        displayGreeting(); // Update greeting for guest
      }
    });

    // Load user's chat history
    function loadUserChats() {
      if (!currentUser) return;
      
      chatHistory.innerHTML = '';

      conversations = {
        'chat1': {
          id: 'chat1',
          title: 'Poem about UCLM',
          timestamp: Date.now() - 86400000, // 1 day ago
          messages: [
            { role: 'user', content: 'Write a poem about the University of Cebu Lapu-Lapu and Mandaue.' },
            { role: 'assistant', content: 'In halls of wisdom, by the sea,\nUCLM stands proud and free.\nWhere minds are shaped and dreams take flight,\nA beacon of knowledge, shining bright.\n\nFrom Lapu-Lapu to Mandaue,\nYoung scholars gather to pursue\nThe path of learning, the quest for truth,\nGuided by mentors who nurture youth.\n\nWith blue and gold as banners high,\nAmbitions reach toward the sky.\nA community of hearts and minds,\nWhere future leaders are defined.\n\nUCLM, our cherished home,\nWhere seeds of greatness are daily sown.\nYour legacy in each graduate lives,\nIn all the knowledge that you give.' }
          ]
        },
        'chat2': {
          id: 'chat2',
          title: 'Student publications',
          timestamp: Date.now() - 43200000, // 12 hours ago
          messages: [
            { role: 'user', content: 'Explain the importance of student publications like SILAKBO.' },
            { role: 'assistant', content: 'Student publications like ANG SILAKBO play a crucial role in campus life and student development. They serve as the voice of the student body, providing a platform for expression, creativity, and discourse.\n\nThese publications document campus events, showcase student achievements, and preserve the institutional memory of the university. They create a historical record that captures the evolving culture and concerns of each generation of students.\n\nBeyond documentation, student publications develop essential skills in writing, editing, design, and teamwork. Students involved in publications gain practical experience in journalism, creative writing, and media production—valuable skills that enhance their academic learning and career prospects.\n\nPublications like ANG SILAKBO also foster community by connecting students across different programs and years. They create a shared experience and identity, helping students feel more connected to their institution and peers.\n\nPerhaps most importantly, student publications uphold principles of free speech and critical thinking. They encourage students to engage with important issues, form opinions, and participate in meaningful dialogue about matters affecting their education and society at large.\n\nIn the digital age, student publications like ANG SILAKBO continue to evolve, embracing new media formats while maintaining their core mission of amplifying student voices and enriching campus culture.' }
          ]
        },
        'chat3': {
          id: 'chat3',
          title: 'Campus life story',
          timestamp: Date.now() - 3600000, // 1 hour ago
          messages: [
            { role: 'user', content: 'Generate a short story about campus life.' },
            { role: 'assistant', content: '"The Library at Midnight"\n\nMia hadn\'t planned to spend her Friday night in the university library, but here she was at 11:30 PM, surrounded by textbooks and the soft glow of her laptop screen. The midterm for Professor Santos\'s Advanced Economics class was on Monday, and she was determined to master the material.\n\nThe library was nearly empty. Only a few dedicated—or desperate—students remained, scattered across the vast space like islands in a sea of knowledge. The usual chatter and footsteps had faded hours ago, replaced by the gentle hum of air conditioning and occasional turning of pages.\n\nAs Mia highlighted another passage in her textbook, she heard a soft thud from somewhere in the stacks. Curious, she peered around her study carrel.\n\n"Hello?" she called softly.\n\nA figure emerged from between the bookshelves—a tall young man with glasses and a UCLM Engineering hoodie.\n\n"Sorry," he whispered, holding up a thick calculus textbook. "Dropped this while trying to reach for another one."\n\nMia recognized him from her Statistics class. "You\'re Carlo, right?"\n\nHe looked surprised. "Yeah. You\'re... Mia? From Professor Lee\'s class?"\n\nShe nodded, and after a moment\'s hesitation, gestured to the empty chair across from her. "Want to join? Misery loves company."\n\nCarlo smiled gratefully and set his books down. "Thanks. I\'ve been here since dinner, and I was starting to talk to myself."\n\nAs the clock ticked toward midnight, they worked in comfortable silence, occasionally helping each other with difficult concepts or sharing snacks from the vending machine. When the library announced it would close in fifteen minutes, they packed up reluctantly.\n\n"Same time tomorrow?" Carlo asked as they walked out into the cool night air.\n\nMia smiled. "It\'s a date. I mean—" she stammered, "a study date."\n\nUnder the campus streetlights, they exchanged numbers and parted ways, both secretly looking forward to another late night at the library. Sometimes, Mia thought as she walked back to her dorm, the most unexpected connections happen in the quietest moments of campus life.' }
          ]
        }
      };
      
      // Add conversations to sidebar
      Object.values(conversations).sort((a, b) => b.timestamp - a.timestamp).forEach(chat => {
        addChatToHistory(chat.title, chat.timestamp, chat.id);
      });
    }

    // Add chat to history sidebar
    function addChatToHistory(title, timestamp, id = null) {
      const chatId = id || timestamp.toString();
      const chatItem = document.createElement('div');
      chatItem.className = 'chat-item';
      chatItem.dataset.id = chatId;
      
      chatItem.innerHTML = `
        <i class="fas fa-comment chat-item-icon"></i>
        <div class="chat-item-text">${title}</div>
        <div class="chat-item-actions">
          <button class="chat-item-action delete-chat" title="Delete Chat">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      `;
      
      chatItem.addEventListener('click', (e) => {
        if (e.target.closest('.delete-chat')) {
          e.stopPropagation();
          deleteChat(chatId);
        } else {
          loadChat(chatId);
        }
      });
      
      chatHistory.prepend(chatItem);
      return chatId;
    }

    // Load a specific chat
    function loadChat(chatId) {
      if (!conversations[chatId]) {
        console.error("Chat not found:", chatId);
        return;
      }
      
      // Update UI
      currentChatId = chatId;
      chatMessages = [...conversations[chatId].messages];
      
      // Update page title with chat title
      document.title = conversations[chatId].title;
      
      // Mark the active chat in sidebar
      document.querySelectorAll('.chat-item').forEach(item => {
        item.classList.remove('active');
        if (item.dataset.id === chatId) {
          item.classList.add('active');
        }
      });
      
      // Show message container and hide welcome screen
      welcomeScreen.style.display = 'none';
      emptyState.style.display = 'none';
      messageContainer.style.display = 'flex';
      
      // Update input container class for positioning
      inputContainer.classList.add('with-messages');
      
      // Clear and populate message container
      messageContainer.innerHTML = '';
      chatMessages.forEach(msg => {
        const sender = msg.role === 'user' ? 'user' : 'bot';
        const messageElement = addMessageToUI(msg.content, sender);
      });
      
      // Scroll to bottom
      chatContainer.scrollTop = chatContainer.scrollHeight;
      
      if (window.innerWidth <= 768) {
        sidebar.classList.remove('active');
        mainContent.classList.remove('sidebar-active');
        sidebarVisible = false;
      }
    }

    // Delete a chat
    function deleteChat(chatId) {
      if (confirm("Are you sure you want to delete this conversation?")) {
        // Remove from conversations object
        delete conversations[chatId];
        
        // Remove from UI
        const chatElement = document.querySelector(`.chat-item[data-id="${chatId}"]`);
        if (chatElement) {
          chatElement.remove();
        }
        
        // If this was the current chat, show empty state
        if (currentChatId === chatId) {
          currentChatId = null;
          chatMessages = [];
          messageContainer.style.display = 'none';
          welcomeScreen.style.display = 'none';
          emptyState.style.display = 'flex';
          inputContainer.classList.remove('with-messages');
          document.title = "CoralVIA"; // Reset title
        }
      }
    }

    // Clear all chat history
    clearHistoryBtn.addEventListener('click', () => {
      if (confirm("Are you sure you want to clear all conversation history?")) {
        conversations = {};
        chatHistory.innerHTML = '';
        currentChatId = null;
        chatMessages = [];
        messageContainer.style.display = 'none';
        welcomeScreen.style.display = 'flex';
        emptyState.style.display = 'none';
        inputContainer.classList.remove('with-messages');
        document.title = "CoralVIA"; // Reset title
      }
    });

    // Show welcome screen
    function showWelcomeScreen() {
      // Unmark any active chat
      document.querySelectorAll('.chat-item').forEach(item => {
        item.classList.remove('active');
      });
      
      currentChatId = null;
      chatMessages = [];
      messageContainer.style.display = 'none';
      emptyState.style.display = 'none';
      welcomeScreen.style.display = 'flex';
      inputContainer.classList.remove('with-messages');
      document.title = "CoralVIA"; // Reset title
    }

    // Helper function to detect content type
    function detectContentType(text) {
      // Check for essay, grammar, plagiarism related content
      const essayKeywords = [
        'essay', 'grammar', 'plagiarism', 'writing', 'proofread', 'edit', 
        'thesis', 'dissertation', 'paper', 'academic', 'research', 'literature',
        'review', 'summary', 'analyze', 'critique', 'paragraph', 'composition'
      ];
      
      // Check for code/programming related content
      const codeKeywords = [
        'code', 'program', 'function', 'variable', 'class', 'method', 
        'algorithm', 'javascript', 'python', 'java', 'c++', 'html', 
        'css', 'sql', 'database', 'api', 'framework', 'library', 
        'debugging', 'compiler', 'syntax', 'programming'
      ];
      
      const lowerText = text.toLowerCase();
      
      // Check if any essay keywords are in the text
      const isEssayRelated = essayKeywords.some(keyword => 
        lowerText.includes(keyword)
      );
      
      // Check if any code keywords are in the text
      const isCodeRelated = codeKeywords.some(keyword => 
        lowerText.includes(keyword)
      );
      
      // Also check for code patterns like brackets, indentation, etc.
      const hasCodePatterns = /\{\s*\n|\s{2,}if\s*\(|\s{2,}for\s*\(|function\s+\w+\s*\(|class\s+\w+|import\s+|from\s+\w+\s+import|console\.log|print\(/.test(text);
      
      if (isCodeRelated || hasCodePatterns) {
        return 'code';
      } else if (isEssayRelated) {
        return 'essay';
      } else {
        return 'normal';
      }
    }

    // Send message function
    async function sendMessage() {
      const userText = userInput.value.trim();
      if (!userText || isGeneratingResponse) return;
      
      // If we're on the welcome screen, start a new chat
      if (welcomeScreen.style.display !== 'none') {
        startNewChat();
      }
      
      // Add user message to UI
      addMessageToUI(userText, 'user');
      userInput.value = '';
      userInput.style.height = 'auto';
      sendBtn.disabled = true;
      
      // Show stop button, hide send button
      sendBtn.style.display = 'none';
      stopBtn.style.display = 'flex';
      
      // Add bot "typing" message
      const botMessageElement = addMessageToUI('', 'bot');
      const typingIndicator = document.createElement('div');
      typingIndicator.className = 'typing-indicator';
      typingIndicator.innerHTML = `
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
      `;
      botMessageElement.appendChild(typingIndicator);
      
      isGeneratingResponse = true;
      shouldStopResponse = false;
      
      try {
        const res = await fetch("https://api.cohere.ai/v1/chat", {
          method: "POST",
          headers: {
            "Authorization": "Bearer z99HUO9u2vu9E4YTRRfeue6hbdkdOcM8zWQDfbcq",
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            message: userText,
            model: "command-r",
            temperature: 0.7,
            stream: false
          })
        });

        const data = await res.json();
        
        // Remove typing indicator
        botMessageElement.removeChild(typingIndicator);
        
        // Only proceed if response wasn't stopped
        if (!shouldStopResponse) {
          // Get response text
          const responseText = data.text || "Sorry, I couldn't generate a response.";
          
          // Detect content type to determine display format
          const contentType = detectContentType(userText + " " + responseText);
          
          // Create appropriate interface based on content type
          if (contentType === 'essay') {
            createRichTextEditor(botMessageElement, responseText);
          } else if (contentType === 'code') {
            createTerminal(botMessageElement, responseText);
          } else {
            // Regular typing animation for normal content
            typeText(botMessageElement, responseText);
          }
          
          // Save message to chat history
          chatMessages.push(
            { role: 'user', content: userText },
            { role: 'assistant', content: responseText }
          );
          
          // Create or update conversation
          if (!currentChatId) {
            currentChatId = Date.now().toString();
            const chatTitle = userText.split(' ').slice(0, 4).join(' ') + '...';
            
            conversations[currentChatId] = {
              id: currentChatId,
              title: chatTitle,
              timestamp: Date.now(),
              messages: [...chatMessages]
            };
            
            // Update page title with initial prompt
            document.title = chatTitle;
            
            // Add to sidebar and mark as active
            addChatToHistory(chatTitle, Date.now(), currentChatId);
            document.querySelectorAll('.chat-item').forEach(item => {
              item.classList.remove('active');
              if (item.dataset.id === currentChatId) {
                item.classList.add('active');
              }
            });
          } else {
            // Update existing conversation
            conversations[currentChatId].messages = [...chatMessages];
          }
        } else {
          // If response was stopped, add a note
          botMessageElement.textContent = "Response stopped.";
        }
      } catch (err) {
        console.error("API Error:", err);
        botMessageElement.removeChild(typingIndicator);
        botMessageElement.textContent = "Sorry, something went wrong. Please try again.";
      } finally {
        // Reset UI state
        isGeneratingResponse = false;
        shouldStopResponse = false;
        stopBtn.style.display = 'none';
        sendBtn.style.display = 'flex';
        sendBtn.disabled = userInput.value.trim() === '';
      }
      
      // Scroll to bottom
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }
    
    // Create rich text editor for essay/grammar content
    function createRichTextEditor(element, text) {
      const editorContainer = document.createElement('div');
      editorContainer.className = 'rich-text-editor';
      
      // Create toolbar
      const toolbar = document.createElement('div');
      toolbar.className = 'editor-toolbar';
      toolbar.innerHTML = `
        <button class="toolbar-btn" title="Bold"><i class="fas fa-bold"></i></button>
        <button class="toolbar-btn" title="Italic"><i class="fas fa-italic"></i></button>
        <button class="toolbar-btn" title="Underline"><i class="fas fa-underline"></i></button>
        <div class="toolbar-separator"></div>
        <button class="toolbar-btn" title="Heading 1"><i class="fas fa-heading"></i>1</button>
        <button class="toolbar-btn" title="Heading 2"><i class="fas fa-heading"></i>2</button>
        <button class="toolbar-btn" title="Heading 3"><i class="fas fa-heading"></i>3</button>
        <div class="toolbar-separator"></div>
        <button class="toolbar-btn" title="Bulleted List"><i class="fas fa-list-ul"></i></button>
        <button class="toolbar-btn" title="Numbered List"><i class="fas fa-list-ol"></i></button>
        <div class="toolbar-separator"></div>
        <button class="toolbar-btn" title="Quote"><i class="fas fa-quote-right"></i></button>
        <button class="toolbar-btn" title="Code"><i class="fas fa-code"></i></button>
        <div class="toolbar-separator"></div>
        <button class="toolbar-btn" title="Copy All"><i class="fas fa-copy"></i></button>
        <button class="toolbar-btn" title="Download as Text"><i class="fas fa-download"></i></button>
      `;
      
      // Create content area
      const content = document.createElement('div');
      content.className = 'editor-content';
      content.textContent = text;
      
      // Create status bar
      const statusBar = document.createElement('div');
      statusBar.className = 'editor-statusbar';
      statusBar.innerHTML = `
        <div>Essay/Writing Content</div>
        <div>${text.split(/\s+/).length} words</div>
      `;
      
      // Assemble editor
      editorContainer.appendChild(toolbar);
      editorContainer.appendChild(content);
      editorContainer.appendChild(statusBar);
      element.appendChild(editorContainer);
      
      // Add functionality to toolbar buttons
      const copyBtn = toolbar.querySelector('.toolbar-btn[title="Copy All"]');
      copyBtn.addEventListener('click', () => {
        navigator.clipboard.writeText(text);
        
        // Show copied tooltip
        const tooltip = document.createElement('div');
        tooltip.className = 'copy-tooltip show';
        tooltip.textContent = 'Copied!';
        copyBtn.appendChild(tooltip);
        
        setTimeout(() => {
          tooltip.classList.remove('show');
          setTimeout(() => tooltip.remove(), 300);
        }, 2000);
      });
      
      // Add download functionality
      const downloadBtn = toolbar.querySelector('.toolbar-btn[title="Download as Text"]');
      downloadBtn.addEventListener('click', () => {
        const blob = new Blob([text], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'essay-content.txt';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      });
      
      // Add styling functionality to other buttons
      const styleButtons = toolbar.querySelectorAll('.toolbar-btn:not([title="Copy All"]):not([title="Download as Text"])');
      styleButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          btn.classList.toggle('active');
          // In a real implementation, this would apply the style to selected text
        });
      });
    }
    
    // Create terminal for code content
    function createTerminal(element, text) {
      const terminalContainer = document.createElement('div');
      terminalContainer.className = 'terminal';
      
      // Create terminal header
      const header = document.createElement('div');
      header.className = 'terminal-header';
      header.innerHTML = `
        <div class="terminal-title">Terminal</div>
        <div class="terminal-actions">
          <button class="terminal-action" title="Copy Code"><i class="fas fa-copy"></i></button>
          <button class="terminal-action" title="Download"><i class="fas fa-download"></i></button>
        </div>
      `;
      
      // Create terminal content
      const content = document.createElement('div');
      content.className = 'terminal-content';
      
      // Format code with prompt
      const lines = text.split('\n');
      
      // Add initial prompt line
      const promptLine = document.createElement('div');
      promptLine.className = 'terminal-line';
      promptLine.innerHTML = `
        <span class="terminal-prompt">$</span>
        <span class="terminal-output">echo "Code Output:"</span>
      `;
      content.appendChild(promptLine);
      
      // Add code output
      lines.forEach(line => {
        const lineDiv = document.createElement('div');
        lineDiv.className = 'terminal-line';
        lineDiv.innerHTML = `<span class="terminal-output">${line || ' '}</span>`;
        content.appendChild(lineDiv);
      });
      
      // Add blinking cursor at the end
      const cursorLine = document.createElement('div');
      cursorLine.className = 'terminal-line';
      cursorLine.innerHTML = `
        <span class="terminal-prompt">$</span>
        <span class="terminal-cursor"></span>
      `;
      content.appendChild(cursorLine);
      
      // Assemble terminal
      terminalContainer.appendChild(header);
      terminalContainer.appendChild(content);
      element.appendChild(terminalContainer);
      
      // Add copy functionality
      const copyBtn = header.querySelector('.terminal-action[title="Copy Code"]');
      copyBtn.addEventListener('click', () => {
        navigator.clipboard.writeText(text);
        
        // Show copied tooltip
        const tooltip = document.createElement('div');
        tooltip.className = 'copy-tooltip show';
        tooltip.textContent = 'Copied!';
        copyBtn.appendChild(tooltip);
        
        setTimeout(() => {
          tooltip.classList.remove('show');
          setTimeout(() => tooltip.remove(), 300);
        }, 2000);
      });
      
      // Add download functionality
      const downloadBtn = header.querySelector('.terminal-action[title="Download"]');
      downloadBtn.addEventListener('click', () => {
        const blob = new Blob([text], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'code-snippet.txt';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      });
    }
    
    // Function to animate text typing for AI responses
    function typeText(element, text) {
      let i = 0;
      const typingSpeed = 10; // milliseconds per character
      
      // Create a span for the typing animation
      const typingSpan = document.createElement('span');
      element.appendChild(typingSpan);
      
      function typeNextChar() {
        if (i < text.length && !shouldStopResponse) {
          typingSpan.textContent += text.charAt(i);
          i++;
          currentTypingInterval = setTimeout(typeNextChar, typingSpeed);
          
          // Scroll to bottom as text is being typed
          chatContainer.scrollTop = chatContainer.scrollHeight;
        } else {
          // Add copy button after typing is complete
          if (!shouldStopResponse) {
            addCopyButton(element.closest('.message'));
          }
          currentTypingInterval = null;
        }
      }
      
      typeNextChar();
    }

    // Add copy button to message
    function addCopyButton(messageElement) {
      if (!messageElement) return;
      
      const messageActions = document.createElement('div');
      messageActions.className = 'message-actions';
      
      const copyButton = document.createElement('button');
      copyButton.className = 'message-action-btn';
      copyButton.innerHTML = '<i class="fas fa-copy"></i>';
      copyButton.title = 'Copy to clipboard';
      
      const tooltip = document.createElement('span');
      tooltip.className = 'copy-tooltip';
      tooltip.textContent = 'Copied!';
      
      messageActions.appendChild(copyButton);
      messageActions.appendChild(tooltip);
      messageElement.appendChild(messageActions);
      
      copyButton.addEventListener('click', () => {
        // Check if message has a rich text editor or terminal
        const richTextEditor = messageElement.querySelector('.rich-text-editor');
        const terminal = messageElement.querySelector('.terminal');
        let textContent;
        
        if (richTextEditor) {
          // If it has a rich text editor, get text from editor content
          textContent = richTextEditor.querySelector('.editor-content').textContent;
        } else if (terminal) {
          // If it has a terminal, get text from terminal content (excluding prompts)
          const outputs = terminal.querySelectorAll('.terminal-output');
          textContent = Array.from(outputs).map(output => output.textContent).join('\n');
        } else {
          // Otherwise get from message text
          textContent = messageElement.querySelector('.message-text').textContent;
        }
        
        navigator.clipboard.writeText(textContent).then(() => {
          tooltip.classList.add('show');
          setTimeout(() => {
            tooltip.classList.remove('show');
          }, 2000);
        });
      });
    }

    // Start a new chat
    function startNewChat() {
      currentChatId = null;
      chatMessages = [];
      
      // Unmark any active chat
      document.querySelectorAll('.chat-item').forEach(item => {
        item.classList.remove('active');
      });
      
      // Show message container and hide welcome screen
      welcomeScreen.style.display = 'none';
      emptyState.style.display = 'none';
      messageContainer.style.display = 'flex';
      
      // Update input container class for positioning
      inputContainer.classList.add('with-messages');
      
      messageContainer.innerHTML = '';
      
      if (window.innerWidth <= 768) {
        sidebar.classList.remove('active');
        mainContent.classList.remove('sidebar-active');
        sidebarVisible = false;
      }
    }

    // Add message to UI
    function addMessageToUI(text, sender) {
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${sender}-message`;
      
      if (sender === 'user') {
        const avatarSrc = currentUser ? 
          currentUser.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(getUserFirstName(currentUser))}&background=e65100&color=fff` : 
          "https://ui-avatars.com/api/?name=Guest&background=e65100&color=fff";
        
        messageDiv.innerHTML = `
          <div class="message-content">
            <div class="message-sender">You</div>
            <div class="message-text">${text}</div>
          </div>
          <img src="${avatarSrc}" alt="User" class="message-avatar">
        `;
        messageDiv.classList.add('animate-slide-in-right');
        
        // Add copy button to user messages too
        addCopyButton(messageDiv);
      } else {
        messageDiv.innerHTML = `
          <img src="Coral.png" alt="CoralVIA" class="message-avatar">
          <div class="message-content">
            <div class="message-sender">CoralVIA</div>
            <div class="message-text"></div>
          </div>
        `;
        messageDiv.classList.add('animate-slide-in-left');
      }
      
      messageContainer.appendChild(messageDiv);
      return messageDiv.querySelector('.message-text');
    }

    // Sign out function
    function signOut() {
      firebase.auth().signOut().then(() => {
        currentUser = null;
        userAvatar.src = "https://ui-avatars.com/api/?name=Guest&background=e65100&color=fff";
        userName.textContent = "Sign in";
        chatHistory.innerHTML = '';
        showWelcomeScreen();
      }).catch((error) => {
        console.error("Sign out error:", error);
      });
    }

    // Add click event for user profile when signed in
    userProfile.addEventListener('click', () => {
      if (currentUser) {
        if(confirm('Do you want to sign out?')) {
          signOut();
        }
      } else {
        authModal.style.display = 'flex';
      }
    });

    // Initialize the app
    function init() {
      // Check if user is already signed in
      const user = firebase.auth().currentUser;
      if (user) {
        updateUserProfile(user);
        loadUserChats();
      }
      
      // Change greeting on page refresh
      document.addEventListener('visibilitychange', () => {
        if (document.visibilityState === 'visible' && welcomeScreen.style.display !== 'none') {
          currentGreetingIndex = (currentGreetingIndex + 1) % greetings.length;
          displayGreeting();
        }
      });
    }

    // Run initialization
    init();
  </script>
</body>
</html>
