<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANG SILAKBO - Memos</title>
    <link rel="icon" href="SILAKBO.png">
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.css' rel='stylesheet' />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #E65100;
            --secondary-color: #FF8C00;
            --accent-color: #FF4500;
            --background-color: #FFFFFF;
            --text-color: #333333;
            --light-bg: #f8f9fa;
            --border-color: #e0e0e0;
            --success-color: #4CAF50;
            --error-color: #F44336;
            --warning-color: #FF9800;
            --info-color: #2196F3;
            --transition-speed: 0.5s;
            --transition-easing: cubic-bezier(0.25, 0.1, 0.25, 1);
            --shadow-sm: 0 2px 5px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.15);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 20px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--text-color);
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Modern Dashboard Layout */
        .app-container {
            display: flex;
            min-height: 100vh;
            position: relative;
            overflow: hidden;
        }

        /* Header */
        .app-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 70px;
            background-color: var(--background-color);
            box-shadow: var(--shadow-md);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            z-index: 50;
            transition: all 0.3s var(--transition-easing);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .menu-toggle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s var(--transition-easing);
            background-color: var(--light-bg);
        }

        .menu-toggle:hover {
            background-color: rgba(230, 81, 0, 0.1);
            transform: rotate(90deg);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            width: 40px;
            height: 40px;
            object-fit: contain;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .app-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary-color);
            letter-spacing: 0.5px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .header-actions {
            display: flex;
            gap: 0.75rem;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 1rem;
            cursor: pointer;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-md);
            transition: all 0.3s var(--transition-easing);
        }

        .user-profile:hover {
            background-color: var(--light-bg);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1.2rem;
        }

        .user-info {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .user-role {
            font-size: 0.75rem;
            opacity: 0.7;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: linear-gradient(165deg, var(--primary-color), var(--accent-color));
            color: white;
            position: fixed;
            height: 100vh;
            left: 0;
            top: 0;
            z-index: 40;
            transition: all 0.4s var(--transition-easing);
            box-shadow: var(--shadow-lg);
            display: flex;
            flex-direction: column;
            transform: translateX(-280px);
            padding-top: 70px;
        }

        .sidebar.active {
            transform: translateX(0);
        }

        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .sidebar-section {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .sidebar-section h3 {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.8;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding-left: 0.5rem;
        }

        .sidebar-section h3 i {
            font-size: 1rem;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.3s var(--transition-easing);
            position: relative;
            overflow: hidden;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.1);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s var(--transition-easing);
            z-index: -1;
        }

        .nav-item:hover::before {
            transform: scaleX(1);
        }

        .nav-item:hover {
            transform: translateX(5px);
        }

        .nav-item i {
            font-size: 1.1rem;
            width: 20px;
            text-align: center;
        }

        .nav-item.active {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .filter-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.3s var(--transition-easing);
            position: relative;
            overflow: hidden;
        }

        .filter-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.1);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s var(--transition-easing);
            z-index: -1;
        }

        .filter-item:hover::before {
            transform: scaleX(1);
        }

        .filter-item:hover {
            transform: translateX(5px);
        }

        .filter-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: inline-block;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.3);
        }

        .filter-label {
            font-size: 0.9rem;
        }

        .filter-item.active {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .sidebar-footer {
            padding: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .add-event-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            background-color: white;
            color: var(--primary-color);
            border-radius: var(--radius-sm);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s var(--transition-easing);
            border: none;
            box-shadow: var(--shadow-md);
        }

        .add-event-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .add-event-btn i {
            font-size: 1rem;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 0;
            margin-top: 70px;
            transition: all 0.4s var(--transition-easing);
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .main-content.sidebar-active {
            margin-left: 280px;
        }

        /* Page Header */
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .page-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--primary-color);
            position: relative;
            display: inline-block;
        }

        .page-title::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 40px;
            height: 3px;
            background-color: var(--accent-color);
            transition: width 0.3s var(--transition-easing);
        }

        .page-title:hover::after {
            width: 100%;
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
        }

        @media (min-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: 2fr 1fr;
            }
        }

        /* Card Styles */
        .card {
            background-color: var(--background-color);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            overflow: hidden;
            transition: all 0.3s var(--transition-easing);
            display: flex;
            flex-direction: column;
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-5px);
        }

        .card-header {
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .card-body {
            padding: 1.5rem;
            flex: 1;
        }

        /* Calendar Card */
        .calendar-card {
            min-height: 700px;
        }

        .view-selector {
            display: flex;
            gap: 0.5rem;
            background-color: var(--light-bg);
            padding: 0.25rem;
            border-radius: var(--radius-md);
        }

        .view-option {
            padding: 0.5rem 1rem;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.3s var(--transition-easing);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .view-option.active {
            background-color: var(--primary-color);
            color: white;
        }

        .view-option:not(.active):hover {
            background-color: rgba(230, 81, 0, 0.1);
        }

        .calendar-navigation {
            display: flex;
            gap: 0.5rem;
        }

        #calendar {
            height: 100%;
            min-height: 600px;
        }

        /* Widgets */
        .widgets-container {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        /* Upcoming Events Widget */
        .upcoming-events {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .event-card {
            background-color: var(--light-bg);
            padding: 1rem;
            border-radius: var(--radius-md);
            border-left: 4px solid var(--primary-color);
            transition: all 0.3s var(--transition-easing);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .event-card:hover {
            transform: translateY(-3px) translateX(5px);
            box-shadow: var(--shadow-md);
        }

        .event-card-title {
            font-weight: 600;
            font-size: 1rem;
        }

        .event-card-time {
            font-size: 0.85rem;
            color: #666;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .event-card-time i {
            color: var(--primary-color);
        }

        /* Stats Widget */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .stat-item {
            text-align: center;
            padding: 1rem;
            border-radius: var(--radius-md);
            background-color: var(--light-bg);
            transition: all 0.3s var(--transition-easing);
            position: relative;
            overflow: hidden;
        }

        .stat-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(230, 81, 0, 0.05), rgba(255, 69, 0, 0.1));
            opacity: 0;
            transition: opacity 0.3s var(--transition-easing);
        }

        .stat-item:hover::before {
            opacity: 1;
        }

        .stat-item:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-sm);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
            position: relative;
            z-index: 1;
        }

        /* Quote Widget */
        #quote-widget {
            background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
            color: white;
        }

        .quote-content {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            transition: all 0.3s var(--transition-easing);
        }

        .quote-text {
            font-style: italic;
            line-height: 1.6;
            position: relative;
            padding-left: 1.5rem;
        }

        .quote-text::before {
            content: '"';
            position: absolute;
            left: 0;
            top: -0.5rem;
            font-size: 2rem;
            opacity: 0.7;
        }

        .quote-author {
            text-align: right;
            font-weight: 500;
            opacity: 0.9;
        }

        /* Weather Widget */
        .weather-widget {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 1.5rem;
            border-radius: var(--radius-md);
        }

        .weather-icon {
            font-size: 2.5rem;
            animation: weatherFloat 3s ease-in-out infinite;
        }

        @keyframes weatherFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .weather-info {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .weather-temp {
            font-size: 1.8rem;
            font-weight: 600;
        }

        .weather-desc {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1rem;
        }

        /* Button Styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.25rem;
            border-radius: var(--radius-md);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s var(--transition-easing);
            border: none;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.1);
            transform: scaleX(0);
            transform-origin: right;
            transition: transform 0.3s var(--transition-easing);
            z-index: -1;
        }

        .btn:hover::before {
            transform: scaleX(1);
            transform-origin: left;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--accent-color);
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }

        .btn-outline:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            padding: 0;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn-icon i {
            font-size: 1rem;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0);
            transition: background-color 0.4s var(--transition-easing);
            backdrop-filter: blur(0px);
        }

        .modal.show {
            display: block;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            animation: modalFadeIn 0.4s var(--transition-easing);
        }

        @keyframes modalFadeIn {
            from { background-color: rgba(0, 0, 0, 0); backdrop-filter: blur(0px); }
            to { background-color: rgba(0, 0, 0, 0.5); backdrop-filter: blur(5px); }
        }

        .modal-content {
            background-color: var(--background-color);
            margin: 5% auto;
            padding: 2rem;
            border-radius: var(--radius-lg);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            opacity: 0;
            transform: scale(0.8) translateY(-30px);
            transition: all 0.5s var(--transition-easing);
        }

        .modal.show .modal-content {
            opacity: 1;
            transform: scale(1) translateY(0);
            animation: modalContentShow 0.5s var(--transition-easing);
        }

        @keyframes modalContentShow {
            from { opacity: 0; transform: scale(0.8) translateY(-30px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s var(--transition-easing);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close:hover {
            color: var(--primary-color);
            background-color: rgba(230, 81, 0, 0.1);
            transform: rotate(90deg);
        }

        .modal-body {
            margin-bottom: 1.5rem;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }

        /* Form Styles */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.25rem;
        }

        @media (min-width: 768px) {
            .form-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .form-group {
            margin-bottom: 1rem;
            transition: all 0.3s var(--transition-easing);
        }

        .form-group:hover {
            transform: translateX(5px);
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            transition: color 0.3s var(--transition-easing);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-group:hover label {
            color: var(--primary-color);
        }

        .form-group label i {
            color: var(--primary-color);
            opacity: 0.8;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            transition: all 0.3s var(--transition-easing);
            box-shadow: var(--shadow-sm);
            font-family: 'Poppins', sans-serif;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(230, 81, 0, 0.2);
            outline: none;
            transform: translateY(-3px);
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .color-dropdown {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .color-dropdown-content {
            display: none;
            position: absolute;
            background-color: #fff;
            min-width: 100%;
            box-shadow: var(--shadow-lg);
            z-index: 10;
            border-radius: var(--radius-md);
            max-height: 250px;
            overflow-y: auto;
            transform-origin: top center;
            transform: scaleY(0.8);
            opacity: 0;
            transition: all 0.3s var(--transition-easing);
        }

        .color-dropdown-content.show {
            display: block;
            transform: scaleY(1);
            opacity: 1;
        }

        .color-option {
            padding: 12px 16px;
            text-decoration: none;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s var(--transition-easing);
        }

        .color-option:hover {
            background-color: var(--light-bg);
            transform: translateX(5px);
        }

        .color-preview {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            margin-right: 12px;
            box-shadow: var(--shadow-sm);
            transition: transform 0.3s var(--transition-easing);
        }

        .color-option:hover .color-preview {
            transform: scale(1.2);
        }

        /* Notification System */
        #notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
            pointer-events: none;
        }

        .notification {
            padding: 15px 20px;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 280px;
            max-width: 350px;
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s var(--transition-easing);
            pointer-events: auto;
            position: relative;
            overflow: hidden;
        }

        .notification::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background-color: rgba(255, 255, 255, 0.5);
            animation: notificationTimer 3s linear forwards;
        }

        @keyframes notificationTimer {
            to { width: 100%; }
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
            animation: notificationBounce 0.5s var(--transition-easing);
        }

        @keyframes notificationBounce {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(-10px); }
            75% { transform: translateX(5px); }
        }

        .notification-success {
            background-color: var(--success-color);
            color: white;
        }

        .notification-error {
            background-color: var(--error-color);
            color: white;
        }

        .notification-warning {
            background-color: var(--warning-color);
            color: white;
        }

        .notification-info {
            background-color: var(--info-color);
            color: white;
        }

        /* Dark Mode Toggle */
        .dark-mode-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s var(--transition-easing);
        }

        .dark-mode-toggle:hover {
            transform: scale(1.1) rotate(15deg);
        }

        /* Dark Mode Styles */
        .dark-mode {
            --background-color: #121212;
            --light-bg: #1e1e1e;
            --text-color: #e0e0e0;
            --border-color: #333333;
        }

        .dark-mode .fc-theme-standard .fc-scrollgrid,
        .dark-mode .fc-theme-standard td,
        .dark-mode .fc-theme-standard th {
            border-color: #333333;
        }

        .dark-mode .fc-col-header-cell {
            background-color: #1e1e1e;
        }
        
        .dark-mode .form-control {
            background-color: #1e1e1e;
            color: #e0e0e0;
        }
        
        .dark-mode .color-dropdown-content,
        .dark-mode .color-option {
            background-color: #1e1e1e;
            color: #e0e0e0;
        }
        
        .dark-mode .color-option:hover {
            background-color: #2a2a2a;
        }

        /* Loading animation */
        .loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive Styles */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-280px);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content.sidebar-active {
                margin-left: 0;
            }
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .page-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .app-header {
                padding: 0 1rem;
            }
            
            .app-title {
                font-size: 1.2rem;
            }
            
            .user-profile {
                display: none;
            }
        }

        /* FullCalendar Custom Styles */
        .fc .fc-toolbar {
            flex-wrap: wrap;
            gap: 0.8rem;
            margin-bottom: 1.5rem !important;
        }

        .fc .fc-toolbar-title {
            font-size: 1.5rem !important;
            font-weight: 600;
            color: var(--primary-color);
            transition: all 0.3s var(--transition-easing);
        }

        .fc .fc-toolbar-title:hover {
            transform: scale(1.05);
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
        }

        .fc .fc-button-primary {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
            transition: all 0.3s var(--transition-easing);
            font-weight: 500;
            padding: 0.6rem 1rem;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
        }

        .fc .fc-button-primary:hover {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }

        .fc .fc-button-primary:not(:disabled).fc-button-active,
        .fc .fc-button-primary:not(:disabled):active {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .fc .fc-daygrid-day-frame {
            min-height: 100px;
            transition: background-color 0.3s var(--transition-easing);
        }

        .fc-view-harness {
            transition: height 0.5s var(--transition-easing) !important;
        }

        .fc-view-harness.fc-view-harness-active {
            animation: viewFadeIn 0.5s var(--transition-easing);
        }

        @keyframes viewFadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .fc .fc-dayGridMonth-view .fc-daygrid-body {
            animation: fadeSlideIn 0.6s var(--transition-easing);
        }

        .fc .fc-timeGridWeek-view .fc-timegrid-body {
            animation: fadeSlideUp 0.6s var(--transition-easing);
        }

        .fc .fc-timeGridDay-view .fc-timegrid-body {
            animation: fadeZoomIn 0.6s var(--transition-easing);
        }

        @keyframes fadeSlideIn {
            from {
                opacity: 0;
                transform: translateX(-10px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes fadeSlideUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeZoomIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .fc-day {
            transition: background-color 0.3s var(--transition-easing);
        }

        .fc-day:hover {
            background-color: rgba(255, 140, 0, 0.05);
        }

        .fc .fc-day-today {
            position: relative;
            overflow: hidden;
        }

        .fc .fc-day-today::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255, 140, 0, 0.2) 0%, rgba(255, 140, 0, 0) 70%);
            animation: pulseToday 2s infinite;
        }

        @keyframes pulseToday {
            0% {
                transform: scale(0.95);
                opacity: 0.7;
            }
            50% {
                transform: scale(1.05);
                opacity: 0.3;
            }
            100% {
                transform: scale(0.95);
                opacity: 0.7;
            }
        }

        .fc-event {
            cursor: pointer;
            transition: all 0.3s var(--transition-easing);
            border-radius: var(--radius-md);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .fc-event:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: var(--shadow-md);
            z-index: 5;
        }

        /* Animation Styles */
        .new-event-highlight {
            animation: pulse 0.5s cubic-bezier(0.25, 0.1, 0.25, 1) 3;
            box-shadow: 0 0 0 3px var(--accent-color) !important;
        }
        
        .print-animation {
            animation: flash 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
        }
        
        .capture-animation {
            animation: flash 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
        }
        
        @keyframes flash {
            0% { filter: brightness(1); }
            50% { filter: brightness(1.3); }
            100% { filter: brightness(1); }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <div class="menu-toggle" id="menu-toggle">
                    <i class="fas fa-bars"></i>
                </div>
                <div class="logo-container">
                    <img src="SILAKBO.png" alt="SILAKBO Logo" class="logo">
                    <h1 class="app-title"><strong>ANG SILAKBO</strong></h1>
                </div>
            </div>
            <div class="header-right">
                <div class="header-actions">
                    <a href="Ang Silakbo Admin Panel.html" class="btn btn-secondary">
                        <i class="fas fa-home"></i> Home
                    </a>
                    <button class="btn btn-outline" id="sync-button">
                        <i class="fas fa-sync-alt"></i> Sync
                    </button>
                </div>
                <div class="user-profile">
                    <div class="user-avatar">S</div>
                    <div class="user-info">
                        <div class="user-name">SILAKBO</div>
                        <div class="user-role">Admin</div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <h3><i class="fas fa-home"></i> Navigation</h3>
                    <div class="nav-item active">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Calendar</span>
                    </div>
                    <div class="nav-item">
                        <i class="fas fa-tasks"></i>
                        <span>Tasks</span>
                    </div>
                    <div class="nav-item">
                        <i class="fas fa-chart-line"></i>
                        <span>Analytics</span>
                    </div>
                    <div class="nav-item">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3><i class="fas fa-filter"></i> Filters</h3>
                    <div class="filter-item">
                        <span class="filter-color" style="background-color: #FF0000;"></span>
                        <span class="filter-label">Important</span>
                    </div>
                    <div class="filter-item">
                        <span class="filter-color" style="background-color: #0000FF;"></span>
                        <span class="filter-label">Meetings</span>
                    </div>
                    <div class="filter-item">
                        <span class="filter-color" style="background-color: #00FF00;"></span>
                        <span class="filter-label">Personal</span>
                    </div>
                    <div class="filter-item">
                        <span class="filter-color" style="background-color: #FFA500;"></span>
                        <span class="filter-label">Events</span>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3><i class="fas fa-calendar-day"></i> Upcoming</h3>
                    <div id="upcoming-events-list">
                        <div class="event-card" style="border-left-color: #FF0000;">
                            <div class="event-card-title">Board Meeting</div>
                            <div class="event-card-time"><i class="far fa-clock"></i> Today, 2:00 PM</div>
                        </div>
                        <div class="event-card" style="border-left-color: #0000FF;">
                            <div class="event-card-title">Team Sync</div>
                            <div class="event-card-time"><i class="far fa-clock"></i> Tomorrow, 10:00 AM</div>
                        </div>
                        <div class="event-card" style="border-left-color: #FFA500;">
                            <div class="event-card-title">Community Event</div>
                            <div class="event-card-time"><i class="far fa-clock"></i> Friday, 6:00 PM</div>
                        </div>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3><i class="fas fa-cloud-sun"></i> Weather</h3>
                    <div class="weather-widget">
                        <div class="weather-icon"><i class="fas fa-sun"></i></div>
                        <div class="weather-info">
                            <div class="weather-temp">28°C</div>
                            <div class="weather-desc">Sunny (eme eme ra ni mess hart)</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="sidebar-footer">
                <button class="add-event-btn" id="add-event-btn">
                    <i class="fas fa-plus"></i> Add New Event
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="main-content">
            <div class="page-header">
                <h1 class="page-title">Memos Dashboard</h1>
            </div>

            <div class="dashboard-grid">
                <div class="card calendar-card">
                    <div class="card-header">
                        <div class="view-selector">
                            <div class="view-option active" data-view="dayGridMonth">
                                <i class="fas fa-calendar-alt"></i> Month
                            </div>
                            <div class="view-option" data-view="timeGridWeek">
                                <i class="fas fa-calendar-week"></i> Week
                            </div>
                            <div class="view-option" data-view="timeGridDay">
                                <i class="fas fa-calendar-day"></i> Day
                            </div>
                        </div>
                        <div class="calendar-navigation">
                            <button class="btn btn-outline btn-icon" id="today-btn">
                                <i class="fas fa-calendar-day"></i>
                            </button>
                            <button class="btn btn-outline btn-icon" id="prev-btn">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="btn btn-outline btn-icon" id="next-btn">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="calendar"></div>
                    </div>
                </div>

                <div class="widgets-container">
                    <div class="card" id="stats-widget">
                        <div class="card-header">
                            <div class="card-title"><i class="fas fa-chart-pie"></i> Statistics</div>
                        </div>
                        <div class="card-body">
                            <div class="stats-grid">
                                <div class="stat-item">
                                    <div class="stat-value" id="total-events">0</div>
                                    <div class="stat-label">Total Events</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="upcoming-events">0</div>
                                    <div class="stat-label">Upcoming</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="this-month">0</div>
                                    <div class="stat-label">This Month</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="completed-events">0</div>
                                    <div class="stat-label">Completed</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card" id="quote-widget">
                        <div class="card-header">
                            <div class="card-title"><i class="fas fa-quote-left"></i> Inspiration</div>
                        </div>
                        <div class="card-body">
                            <div class="quote-content">
                                <div class="loading-spinner"></div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-title"><i class="fas fa-tools"></i> Actions</div>
                        </div>
                        <div class="card-body">
                            <div class="action-buttons">
                                <button class="btn btn-primary" onclick="printCalendar()">
                                    <i class="fas fa-print"></i> Print Calendar
                                </button>
                                <button class="btn btn-primary" onclick="saveAsImage()">
                                    <i class="fas fa-image"></i> Save as Image
                                </button>
                                <button class="btn btn-primary" id="export-btn">
                                    <i class="fas fa-file-export"></i> Export Events
                                </button>
                                <button class="btn btn-primary" id="import-btn">
                                    <i class="fas fa-file-import"></i> Import Events
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Event Modal -->
    <div id="eventModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle"><i class="fas fa-plus-circle"></i> Add Event</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <form id="eventForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="eventTitle"><i class="fas fa-heading"></i> Title</label>
                            <input type="text" id="eventTitle" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="eventCategory"><i class="fas fa-tag"></i> Category</label>
                            <select id="eventCategory" class="form-control">
                                <option value="important">Important</option>
                                <option value="meeting">Meeting</option>
                                <option value="personal">Personal</option>
                                <option value="event">Event</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="eventColor"><i class="fas fa-palette"></i> Color</label>
                            <div class="color-dropdown">
                                <button type="button" class="btn btn-outline" style="width: 100%;" onclick="toggleColorDropdown()">
                                    <i class="fas fa-palette"></i> Select Color
                                </button>
                                <div id="colorDropdown" class="color-dropdown-content"></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="eventStart"><i class="fas fa-clock"></i> Start</label>
                            <input type="datetime-local" id="eventStart" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="eventEnd"><i class="fas fa-clock"></i> End</label>
                            <input type="datetime-local" id="eventEnd" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="eventLocation"><i class="fas fa-map-marker-alt"></i> Location</label>
                            <input type="text" id="eventLocation" class="form-control">
                        </div>
                        <div class="form-group full-width">
                            <label for="eventDescription"><i class="fas fa-align-left"></i> Description</label>
                            <textarea id="eventDescription" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="eventReminder"><i class="fas fa-bell"></i> Reminder</label>
                            <select id="eventReminder" class="form-control">
                                <option value="none">None</option>
                                <option value="15">15 minutes before</option>
                                <option value="30">30 minutes before</option>
                                <option value="60">1 hour before</option>
                                <option value="1440">1 day before</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="eventPriority"><i class="fas fa-flag"></i> Priority</label>
                            <select id="eventPriority" class="form-control">
                                <option value="low">Low</option>
                                <option value="medium" selected>Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline" id="cancelBtn">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveEventBtn"><i class="fas fa-save"></i> Save Event</button>
                <button type="button" class="btn btn-outline" id="deleteEventBtn" style="display: none; background-color: #F44336; color: white;">
                    <i class="fas fa-trash"></i> Delete Event
                </button>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div id="exportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title"><i class="fas fa-file-export"></i> Export Events</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="exportFormat"><i class="fas fa-file-code"></i> Format</label>
                    <select id="exportFormat" class="form-control">
                        <option value="json">JSON</option>
                        <option value="csv">CSV</option>
                        <option value="ical">iCalendar</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="exportDateRange"><i class="fas fa-calendar-alt"></i> Date Range</label>
                    <select id="exportDateRange" class="form-control">
                        <option value="all">All Events</option>
                        <option value="future">Future Events</option>
                        <option value="past">Past Events</option>
                        <option value="month">This Month</option>
                        <option value="custom">Custom Range</option>
                    </select>
                </div>
                <div id="customDateRange" style="display: none;">
                    <div class="form-group">
                        <label for="exportStartDate"><i class="fas fa-calendar-day"></i> Start Date</label>
                        <input type="date" id="exportStartDate" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="exportEndDate"><i class="fas fa-calendar-day"></i> End Date</label>
                        <input type="date" id="exportEndDate" class="form-control">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline" id="cancelExportBtn">Cancel</button>
                <button type="button" class="btn btn-primary" id="confirmExportBtn"><i class="fas fa-download"></i> Export</button>
            </div>
        </div>
    </div>

    <!-- Import Modal -->
    <div id="importModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title"><i class="fas fa-file-import"></i> Import Events</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="importFile"><i class="fas fa-file-upload"></i> Select File</label>
                    <input type="file" id="importFile" class="form-control" accept=".json,.csv,.ics">
                </div>
                <div class="form-group">
                    <label for="importOptions"><i class="fas fa-cog"></i> Import Options</label>
                    <select id="importOptions" class="form-control">
                        <option value="add">Add to existing events</option>
                        <option value="replace">Replace all events</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline" id="cancelImportBtn">Cancel</button>
                <button type="button" class="btn btn-primary" id="confirmImportBtn"><i class="fas fa-upload"></i> Import</button>
            </div>
        </div>
    </div>

    <div class="dark-mode-toggle" id="darkModeToggle">
        <i class="fas fa-moon"></i>
    </div>

    <div id="notification-container"></div>

    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.js'></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-analytics.js"></script>
    <script>
        // Code protection - Make it harder to view source in developer tools
        (function() {
            // Disable right-click
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
            });
            
            // Disable F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U
            document.addEventListener('keydown', function(e) {
                if (
                    e.keyCode === 123 || // F12
                    (e.ctrlKey && e.shiftKey && e.keyCode === 73) || // Ctrl+Shift+I
                    (e.ctrlKey && e.shiftKey && e.keyCode === 74) || // Ctrl+Shift+J
                    (e.ctrlKey && e.keyCode === 85) // Ctrl+U
                ) {
                    e.preventDefault();
                    return false;
                }
            });
            
            // Additional protection - obfuscate variable names in runtime
            const _0x5a7c=['log','warn','debug','info','error','exception','trace'];
            (function(_0x4c97f0,_0x5a7c1a){const _0x866db2=function(_0x262ad1){while(--_0x262ad1){_0x4c97f0['push'](_0x4c97f0['shift']());}};_0x866db2(++_0x5a7c1a);}(_0x5a7c,0x16a));
        })();

        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDSe2c9-8xqShoHEW-D7BXXAyD5N9uXWEs",
            authDomain: "ang-silakbo.firebaseapp.com",
            databaseURL: "https://ang-silakbo-default-rtdb.firebaseio.com",
            projectId: "ang-silakbo",
            storageBucket: "ang-silakbo.appspot.com",
            messagingSenderId: "1006400633782",
            appId: "1:1006400633782:web:ef4a93c1d445cb825b9f17",
            measurementId: "G-TSDTG2YJ94"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const analytics = firebase.analytics();

        let calendar;
        let currentEvent = null;
        let currentView = 'dayGridMonth';
        let animationInProgress = false;

        const colors = [
            { name: 'Red', value: '#FF0000' },
            { name: 'Blue', value: '#0000FF' },
            { name: 'Green', value: '#00FF00' },
            { name: 'Yellow', value: '#FFFF00' },
            { name: 'Purple', value: '#800080' },
            { name: 'Orange', value: '#FFA500' },
            { name: 'Pink', value: '#FFC0CB' },
            { name: 'Teal', value: '#008080' },
            { name: 'Brown', value: '#A52A2A' },
            { name: 'Gray', value: '#808080' }
        ];

        const categoryColors = {
            important: '#FF0000',
            meeting: '#0000FF',
            personal: '#00FF00',
            event: '#FFA500',
            other: '#808080'
        };

        document.addEventListener('DOMContentLoaded', function() {
            initializeCalendar();
            setupEventListeners();
            setupColorDropdown();
            fetchQuote();
            updateStatistics();
            
            // Check for dark mode preference
            if (localStorage.getItem('darkMode') === 'enabled') {
                document.body.classList.add('dark-mode');
                document.getElementById('darkModeToggle').innerHTML = '<i class="fas fa-sun"></i>';
            }
        });

        function initializeCalendar() {
            const calendarEl = document.getElementById('calendar');
            calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                headerToolbar: false, // We'll use our custom header
                editable: true,
                selectable: true,
                selectMirror: true,
                dayMaxEvents: true,
                select: function(info) {
                    openModal(info.startStr, info.endStr);
                },
                eventClick: function(info) {
                    openModal(info.event.startStr, info.event.endStr, info.event);
                },
                eventTimeFormat: {
                    hour: 'numeric',
                    minute: '2-digit',
                    meridiem: 'short'
                },
                eventContent: function(arg) {
                    const timeText = arg.timeText ? `<div class="fc-event-time">${arg.timeText}</div>` : '';
                    const priorityIcon = arg.event.extendedProps.priority === 'high' ? 
                        '<i class="fas fa-exclamation-circle" style="margin-right: 5px;"></i>' : '';
                    
                    return {
                        html: `
                            <div class="fc-event-main-frame" style="background-color: ${arg.event.backgroundColor}; color: ${getContrastColor(arg.event.backgroundColor)}; padding: 6px 10px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.15);">
                                ${timeText}
                                <div class="fc-event-title-container">
                                    <div class="fc-event-title fc-sticky">${priorityIcon}${arg.event.title}</div>
                                </div>
                            </div>
                        `
                    };
                },
                datesSet: function(dateInfo) {
                    // Track view changes for animations
                    if (currentView !== dateInfo.view.type && !animationInProgress) {
                        animationInProgress = true;
                        
                        // Add animation class based on the view type
                        const viewHarness = document.querySelector('.fc-view-harness');
                        if (viewHarness) {
                            viewHarness.style.opacity = '0';
                            viewHarness.style.transform = 'scale(0.95)';
                            
                            setTimeout(() => {
                                viewHarness.style.opacity = '1';
                                viewHarness.style.transform = 'scale(1)';
                                
                                // Apply specific animation class based on view type
                                if (dateInfo.view.type === 'dayGridMonth') {
                                    viewHarness.classList.add('month-view-animation');
                                } else if (dateInfo.view.type === 'timeGridWeek') {
                                    viewHarness.classList.add('week-view-animation');
                                } else if (dateInfo.view.type === 'timeGridDay') {
                                    viewHarness.classList.add('day-view-animation');
                                }
                                
                                animationInProgress = false;
                            }, 100);
                        }
                        
                        currentView = dateInfo.view.type;
                    }
                    
                    // Update the active view in the view selector
                    document.querySelectorAll('.view-option').forEach(option => {
                        option.classList.remove('active');
                    });
                    document.querySelector(`.view-option[data-view="${dateInfo.view.type}"]`).classList.add('active');
                    
                    // Update upcoming events list
                    updateUpcomingEvents();
                    
                    // Update statistics
                    updateStatistics();
                }
            });

            calendar.render();
            loadEvents();
        }

        function setupEventListeners() {
            // Menu toggle
            document.getElementById('menu-toggle').addEventListener('click', function() {
                const sidebar = document.getElementById('sidebar');
                const mainContent = document.getElementById('main-content');
                sidebar.classList.toggle('active');
                mainContent.classList.toggle('sidebar-active');
                
                // Change icon
                const icon = this.querySelector('i');
                if (sidebar.classList.contains('active')) {
                    icon.classList.remove('fa-bars');
                    icon.classList.add('fa-times');
                } else {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            });
            
            // View selector
            document.querySelectorAll('.view-option').forEach(option => {
                option.addEventListener('click', function() {
                    const view = this.getAttribute('data-view');
                    calendar.changeView(view);
                });
            });
            
            // Navigation buttons
            document.getElementById('today-btn').addEventListener('click', function() {
                calendar.today();
            });
            
            document.getElementById('prev-btn').addEventListener('click', function() {
                calendar.prev();
            });
            
            document.getElementById('next-btn').addEventListener('click', function() {
                calendar.next();
            });
            
            // Add event button
            document.getElementById('add-event-btn').addEventListener('click', function() {
                const now = new Date();
                const start = now.toISOString().slice(0, 16);
                const end = new Date(now.getTime() + 60 * 60 * 1000).toISOString().slice(0, 16);
                openModal(start, end);
            });
            
            // Modal close buttons
            document.querySelectorAll('.close, #cancelBtn').forEach(el => {
                el.addEventListener('click', function() {
                    closeModal('eventModal');
                });
            });
            
            // Save event button
            document.getElementById('saveEventBtn').addEventListener('click', function() {
                saveEvent();
            });
            
            // Delete event button
            document.getElementById('deleteEventBtn').addEventListener('click', function() {
                if (currentEvent) {
                    deleteEvent(currentEvent.id);
                }
            });
            
            // Export button
            document.getElementById('export-btn').addEventListener('click', function() {
                openModal('exportModal');
            });
            
            document.getElementById('exportDateRange').addEventListener('change', function() {
                if (this.value === 'custom') {
                    document.getElementById('customDateRange').style.display = 'block';
                } else {
                    document.getElementById('customDateRange').style.display = 'none';
                }
            });
            
            document.getElementById('cancelExportBtn').addEventListener('click', function() {
                closeModal('exportModal');
            });
            
            document.getElementById('confirmExportBtn').addEventListener('click', function() {
                exportEvents();
                closeModal('exportModal');
            });
            
            // Import button
            document.getElementById('import-btn').addEventListener('click', function() {
                openModal('importModal');
            });
            
            document.getElementById('cancelImportBtn').addEventListener('click', function() {
                closeModal('importModal');
            });
            
            document.getElementById('confirmImportBtn').addEventListener('click', function() {
                importEvents();
                closeModal('importModal');
            });
            
            // Sync button
            document.getElementById('sync-button').addEventListener('click', function() {
                this.querySelector('i').classList.add('fa-spin');
                showNotification('Syncing calendar...', 'info');
                
                loadEvents();
                
                setTimeout(() => {
                    this.querySelector('i').classList.remove('fa-spin');
                    showNotification('Calendar synced successfully!', 'success');
                }, 1500);
            });
            
            // Dark mode toggle
            document.getElementById('darkModeToggle').addEventListener('click', function() {
                document.body.classList.toggle('dark-mode');
                if (document.body.classList.contains('dark-mode')) {
                    localStorage.setItem('darkMode', 'enabled');
                    this.innerHTML = '<i class="fas fa-sun"></i>';
                    showNotification('Dark mode enabled', 'info');
                } else {
                    localStorage.setItem('darkMode', 'disabled');
                    this.innerHTML = '<i class="fas fa-moon"></i>';
                    showNotification('Light mode enabled', 'info');
                }
            });
            
            // Close modals when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    closeModal(event.target.id);
                }
                
                // Close color dropdown when clicking outside
                if (!event.target.matches('.color-dropdown .btn') && 
                    !event.target.closest('#colorDropdown')) {
                    document.getElementById('colorDropdown').classList.remove('show');
                }
            });
            
            // Filter items
            document.querySelectorAll('.filter-item').forEach(item => {
                item.addEventListener('click', function() {
                    this.classList.toggle('active');
                    const color = this.querySelector('.filter-color').style.backgroundColor;
                    filterEventsByColor(color);
                });
            });
            
            // Event category change
            document.getElementById('eventCategory').addEventListener('change', function() {
                const category = this.value;
                const color = categoryColors[category] || colors[0].value;
                selectColor(color);
            });
            
            // Navigation items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show notification for demo purposes
                    const navText = this.querySelector('span').textContent;
                    showNotification(`Navigated to ${navText}`, 'info');
                });
            });
        }

        function setupColorDropdown() {
            const colorDropdown = document.getElementById('colorDropdown');
            colorDropdown.innerHTML = ''; // Clear existing options
            
            colors.forEach((color, index) => {
                const colorOption = document.createElement('div');
                colorOption.className = 'color-option';
                colorOption.innerHTML = `
                    <span class="color-preview" style="background-color: ${color.value}"></span>
                    <span>${color.name}</span>
                `;
                colorOption.addEventListener('click', () => {
                    selectColor(color.value);
                    toggleColorDropdown();
                });
                
                // Add staggered animation delay
                colorOption.style.animationDelay = `${index * 0.05}s`;
                colorDropdown.appendChild(colorOption);
            });
        }

        function toggleColorDropdown() {
            const dropdown = document.getElementById('colorDropdown');
            dropdown.classList.toggle('show');
        }

        function selectColor(color) {
            const colorButton = document.querySelector('.color-dropdown .btn');
            colorButton.style.backgroundColor = color;
            colorButton.style.color = getContrastColor(color);
            colorButton.innerHTML = `<i class="fas fa-palette"></i> ${getColorName(color)}`;
        }
        
        function getColorName(colorValue) {
            const color = colors.find(c => c.value.toLowerCase() === colorValue.toLowerCase());
            return color ? color.name : 'Custom';
        }

        function openModal(start, end, event = null) {
            currentEvent = event;
            const modalId = event ? 'eventModal' : (start ? 'eventModal' : 'exportModal');
            const modal = document.getElementById(modalId);
            
            if (modalId === 'eventModal') {
                const form = document.getElementById('eventForm');
                const title = document.getElementById('modalTitle');
                const deleteBtn = document.getElementById('deleteEventBtn');
                
                if (event) {
                    title.innerHTML = '<i class="fas fa-edit"></i> Edit Event';
                    form.eventTitle.value = event.title;
                    form.eventStart.value = event.start.toISOString().slice(0, 16);
                    form.eventEnd.value = event.end ? event.end.toISOString().slice(0, 16) : '';
                    form.eventDescription.value = event.extendedProps.description || '';
                    form.eventLocation.value = event.extendedProps.location || '';
                    form.eventReminder.value = event.extendedProps.reminder || 'none';
                    form.eventCategory.value = event.extendedProps.category || 'other';
                    form.eventPriority.value = event.extendedProps.priority || 'medium';
                    selectColor(event.backgroundColor);
                    deleteBtn.style.display = 'inline-block';
                } else {
                    title.innerHTML = '<i class="fas fa-plus-circle"></i> Add Event';
                    form.reset();
                    form.eventStart.value = start.slice(0, 16);
                    form.eventEnd.value = end.slice(0, 16);
                    
                    // Set default color based on category
                    const defaultCategory = form.eventCategory.value;
                    const defaultColor = categoryColors[defaultCategory] || colors[0].value;
                    selectColor(defaultColor);
                    
                    deleteBtn.style.display = 'none';
                }
            }

            modal.classList.add('show');
            
            // Add entrance animation for modal content
            setTimeout(() => {
                const modalContent = modal.querySelector('.modal-content');
                if (modalContent) {
                    modalContent.style.opacity = '1';
                    modalContent.style.transform = 'scale(1) translateY(0)';
                }
            }, 50);
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            const modalContent = modal.querySelector('.modal-content');
            
            // Exit animation
            if (modalContent) {
                modalContent.style.opacity = '0';
                modalContent.style.transform = 'scale(0.8) translateY(-20px)';
            }
            
            setTimeout(() => {
                modal.classList.remove('show');
            }, 300);
        }

        function saveEvent() {
            const form = document.getElementById('eventForm');
            const category = form.eventCategory.value;
            
            const eventData = {
                title: form.eventTitle.value,
                start: form.eventStart.value,
                end: form.eventEnd.value,
                backgroundColor: document.querySelector('.color-dropdown .btn').style.backgroundColor || categoryColors[category],
                description: form.eventDescription.value,
                location: form.eventLocation.value,
                reminder: form.eventReminder.value,
                category: category,
                priority: form.eventPriority.value
            };

            if (currentEvent) {
                updateEvent(currentEvent.id, eventData);
            } else {
                addEvent(eventData);
            }

            closeModal('eventModal');
        }

        function addEvent(eventData) {
            // Show loading indicator
            showNotification('Adding event...', 'info');
            
            db.collection('events').add(eventData)
                .then((docRef) => {
                    console.log('Event added with ID: ', docRef.id);
                    
                    // Add with animation
                    const newEvent = {
                        id: docRef.id,
                        ...eventData
                    };
                    
                    calendar.addEvent(newEvent);
                    
                    // Highlight the new event
                    setTimeout(() => {
                        const eventEl = document.querySelector(`[data-event-id="${docRef.id}"]`);
                        if (eventEl) {
                            eventEl.classList.add('new-event-highlight');
                            setTimeout(() => {
                                eventEl.classList.remove('new-event-highlight');
                            }, 2000);
                        }
                    }, 100);
                    
                    showNotification('Event added successfully!', 'success');
                    updateUpcomingEvents();
                    updateStatistics();
                })
                .catch((error) => {
                    console.error('Error adding event: ', error);
                    showNotification('Error adding event', 'error');
                });
        }

        function updateEvent(eventId, eventData) {
            showNotification('Updating event...', 'info');
            
            db.collection('events').doc(eventId).update(eventData)
                .then(() => {
                    console.log('Event updated successfully');
                    const event = calendar.getEventById(eventId);
                    if (event) {
                        event.remove();
                    }
                    
                    calendar.addEvent({
                        id: eventId,
                        ...eventData
                    });
                    
                    showNotification('Event updated successfully!', 'success');
                    updateUpcomingEvents();
                    updateStatistics();
                })
                .catch((error) => {
                    console.error('Error updating event: ', error);
                    showNotification('Error updating event', 'error');
                });
        }

        function deleteEvent(eventId) {
            if (confirm('Are you sure you want to delete this event?')) {
                showNotification('Deleting event...', 'info');
                
                // Add delete animation
                const eventEl = document.querySelector(`[data-event-id="${eventId}"]`);
                if (eventEl) {
                    eventEl.style.transition = 'all 0.5s cubic-bezier(0.25, 0.1, 0.25, 1)';
                    eventEl.style.transform = 'translateX(100px)';
                    eventEl.style.opacity = '0';
                }
                
                db.collection('events').doc(eventId).delete()
                    .then(() => {
                        console.log('Event deleted successfully');
                        setTimeout(() => {
                            const event = calendar.getEventById(eventId);
                            if (event) {
                                event.remove();
                            }
                            closeModal('eventModal');
                            showNotification('Event deleted successfully!', 'success');
                            updateUpcomingEvents();
                            updateStatistics();
                        }, 300);
                    })
                    .catch((error) => {
                        console.error('Error deleting event: ', error);
                        showNotification('Error deleting event', 'error');
                    });
            }
        }

        function loadEvents() {
            showNotification('Loading events...', 'info');
            
            // Clear existing events
            calendar.removeAllEvents();
            
            db.collection('events').get()
                .then((querySnapshot) => {
                    let count = 0;
                    querySnapshot.forEach((doc) => {
                        const eventData = doc.data();
                        setTimeout(() => {
                            calendar.addEvent({
                                id: doc.id,
                                ...eventData
                            });
                        }, count * 50); // Staggered loading for visual effect
                        count++;
                    });
                    
                    if (count > 0) {
                        showNotification(`Loaded ${count} events successfully!`, 'success');
                    } else {
                        showNotification('No events found. Create your first event!', 'info');
                    }
                    
                    updateUpcomingEvents();
                    updateStatistics();
                })
                .catch((error) => {
                    console.error('Error loading events: ', error);
                    showNotification('Error loading events', 'error');
                });
        }

        function updateUpcomingEvents() {
            const upcomingList = document.getElementById('upcoming-events-list');
            upcomingList.innerHTML = '';
            
            const now = new Date();
            const events = calendar.getEvents();
            
            // Sort events by start date
            const upcomingEvents = events
                .filter(event => new Date(event.start) >= now)
                .sort((a, b) => new Date(a.start) - new Date(b.start))
                .slice(0, 5); // Get only the next 5 events
            
            if (upcomingEvents.length === 0) {
                upcomingList.innerHTML = '<div class="event-card"><div class="event-card-title">No upcoming events</div></div>';
                return;
            }
            
            upcomingEvents.forEach((event, index) => {
                const eventDate = new Date(event.start);
                let dateText;
                
                // Format the date text
                const today = new Date();
                const tomorrow = new Date(today);
                tomorrow.setDate(tomorrow.getDate() + 1);
                
                if (eventDate.toDateString() === today.toDateString()) {
                    dateText = 'Today';
                } else if (eventDate.toDateString() === tomorrow.toDateString()) {
                    dateText = 'Tomorrow';
                } else {
                    const options = { weekday: 'long' };
                    dateText = new Intl.DateTimeFormat('en-US', options).format(eventDate);
                }
                
                // Format the time
                const timeText = eventDate.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
                
                const eventCard = document.createElement('div');
                eventCard.className = 'event-card';
                eventCard.style.borderLeftColor = event.backgroundColor;
                eventCard.style.animationDelay = `${index * 0.1}s`;
                eventCard.innerHTML = `
                    <div class="event-card-title">${event.title}</div>
                    <div class="event-card-time"><i class="far fa-clock"></i> ${dateText}, ${timeText}</div>
                `;
                
                eventCard.addEventListener('click', () => {
                    openModal(event.startStr, event.endStr, event);
                });
                
                upcomingList.appendChild(eventCard);
                
                // Add entrance animation
                setTimeout(() => {
                    eventCard.style.opacity = '1';
                    eventCard.style.transform = 'translateX(0)';
                }, 50 + (index * 100));
            });
        }

        function updateStatistics() {
            const events = calendar.getEvents();
            const now = new Date();
            const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);
            const monthEnd = new Date(now.getFullYear(), now.getMonth() + 1, 0);
            
            // Animate counting up
            animateCounter('total-events', events.length);
            
            // Upcoming events
            const upcomingCount = events.filter(event => new Date(event.start) >= now).length;
            animateCounter('upcoming-events', upcomingCount);
            
            // This month events
            const thisMonthCount = events.filter(event => {
                const eventDate = new Date(event.start);
                return eventDate >= monthStart && eventDate <= monthEnd;
            }).length;
            animateCounter('this-month', thisMonthCount);
            
            // Completed events
            const completedCount = events.filter(event => new Date(event.end) < now).length;
            animateCounter('completed-events', completedCount);
        }
        
        function animateCounter(elementId, targetValue) {
            const element = document.getElementById(elementId);
            const startValue = parseInt(element.textContent) || 0;
            const duration = 1000; // ms
            const stepTime = 50;
            const steps = duration / stepTime;
            const increment = (targetValue - startValue) / steps;
            let currentValue = startValue;
            let currentStep = 0;
            
            const timer = setInterval(() => {
                currentStep++;
                currentValue += increment;
                
                if (currentStep >= steps) {
                    clearInterval(timer);
                    element.textContent = targetValue;
                } else {
                    element.textContent = Math.round(currentValue);
                }
            }, stepTime);
        }

        function filterEventsByColor(color) {
            const events = calendar.getEvents();
            events.forEach(event => {
                if (event.backgroundColor === color) {
                    event.setProp('display', event.display === 'none' ? 'auto' : 'none');
                }
            });
        }

        function printCalendar() {
            // Add print animation
            const calendarEl = document.getElementById('calendar');
            calendarEl.classList.add('print-animation');
            
            showNotification('Preparing to print...', 'info');
            
            setTimeout(() => {
                calendarEl.classList.remove('print-animation');
                window.print();
            }, 500);
        }

        function saveAsImage() {
            showNotification('Preparing image...', 'info');
            
            const calendarEl = document.getElementById('calendar');
            calendarEl.classList.add('capture-animation');
            
            setTimeout(() => {
                html2canvas(document.querySelector("#calendar")).then(canvas => {
                    calendarEl.classList.remove('capture-animation');
                    let link = document.createElement('a');
                    link.download = 'SILAKBO_calendar.png';
                    link.href = canvas.toDataURL();
                    link.click();
                    showNotification('Image saved successfully!', 'success');
                }).catch(err => {
                    console.error('Error saving image:', err);
                    showNotification('Error saving image', 'error');
                    calendarEl.classList.remove('capture-animation');
                });
            }, 500);
        }

        function exportEvents() {
            const format = document.getElementById('exportFormat').value;
            const dateRange = document.getElementById('exportDateRange').value;
            
            let events = calendar.getEvents();
            const now = new Date();
            
            // Filter events based on date range
            if (dateRange === 'future') {
                events = events.filter(event => new Date(event.start) >= now);
            } else if (dateRange === 'past') {
                events = events.filter(event => new Date(event.end) < now);
            } else if (dateRange === 'month') {
                const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);
                const monthEnd = new Date(now.getFullYear(), now.getMonth() + 1, 0);
                events = events.filter(event => {
                    const eventDate = new Date(event.start);
                    return eventDate >= monthStart && eventDate <= monthEnd;
                });
            } else if (dateRange === 'custom') {
                const startDate = new Date(document.getElementById('exportStartDate').value);
                const endDate = new Date(document.getElementById('exportEndDate').value);
                events = events.filter(event => {
                    const eventDate = new Date(event.start);
                    return eventDate >= startDate && eventDate <= endDate;
                });
            }
            
            // Convert events to the selected format
            let data;
            let fileName;
            let mimeType;
            
            if (format === 'json') {
                data = JSON.stringify(events.map(event => ({
                    id: event.id,
                    title: event.title,
                    start: event.startStr,
                    end: event.endStr,
                    backgroundColor: event.backgroundColor,
                    description: event.extendedProps.description,
                    location: event.extendedProps.location,
                    reminder: event.extendedProps.reminder,
                    category: event.extendedProps.category,
                    priority: event.extendedProps.priority
                })), null, 2);
                fileName = 'silakbo_events.json';
                mimeType = 'application/json';
            } else if (format === 'csv') {
                const headers = ['Title', 'Start', 'End', 'Color', 'Description', 'Location', 'Reminder', 'Category', 'Priority'];
                const rows = events.map(event => [
                    event.title,
                    event.startStr,
                    event.endStr,
                    event.backgroundColor,
                    event.extendedProps.description || '',
                    event.extendedProps.location || '',
                    event.extendedProps.reminder || '',
                    event.extendedProps.category || '',
                    event.extendedProps.priority || ''
                ]);
                
                data = [headers, ...rows].map(row => row.join(',')).join('\n');
                fileName = 'silakbo_events.csv';
                mimeType = 'text/csv';
            } else if (format === 'ical') {
                // Simple iCalendar format
                let icalData = [
                    'BEGIN:VCALENDAR',
                    'VERSION:2.0',
                    'PRODID:-//SILAKBO//Calendar//EN'
                ];
                
                events.forEach(event => {
                    const startDate = new Date(event.start);
                    const endDate = new Date(event.end || event.start);
                    
                    // Format dates for iCal
                    const formatDate = (date) => {
                        return date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
                    };
                    
                    icalData = [
                        ...icalData,
                        'BEGIN:VEVENT',
                        `UID:${event.id}`,
                        `DTSTAMP:${formatDate(new Date())}`,
                        `DTSTART:${formatDate(startDate)}`,
                        `DTEND:${formatDate(endDate)}`,
                        `SUMMARY:${event.title}`,
                        `DESCRIPTION:${event.extendedProps.description || ''}`,
                        `LOCATION:${event.extendedProps.location || ''}`,
                        'END:VEVENT'
                    ];
                });
                
                icalData.push('END:VCALENDAR');
                data = icalData.join('\r\n');
                fileName = 'silakbo_events.ics';
                mimeType = 'text/calendar';
            }
            
            // Create and trigger download
            const blob = new Blob([data], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = fileName;
            link.click();
            
            showNotification(`Exported ${events.length} events successfully!`, 'success');
        }

        function importEvents() {
            const fileInput = document.getElementById('importFile');
            const importOption = document.getElementById('importOptions').value;
            
            if (!fileInput.files || fileInput.files.length === 0) {
                showNotification('Please select a file to import', 'warning');
                return;
            }
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    let events = [];
                    
                    if (file.name.endsWith('.json')) {
                        events = JSON.parse(e.target.result);
                    } else if (file.name.endsWith('.csv')) {
                        const lines = e.target.result.split('\n');
                        const headers = lines[0].split(',');
                        
                        for (let i = 1; i < lines.length; i++) {
                            if (!lines[i].trim()) continue;
                            
                            const values = lines[i].split(',');
                            const event = {
                                title: values[0],
                                start: values[1],
                                end: values[2],
                                backgroundColor: values[3],
                                description: values[4],
                                location: values[5],
                                reminder: values[6],
                                category: values[7],
                                priority: values[8]
                            };
                            events.push(event);
                        }
                    } else if (file.name.endsWith('.ics')) {
                        // Simple iCal parser
                        const lines = e.target.result.split(/\r\n|\n|\r/);
                        let currentEvent = null;
                        
                        for (let i = 0; i < lines.length; i++) {
                            const line = lines[i];
                            
                            if (line === 'BEGIN:VEVENT') {
                                currentEvent = {};
                            } else if (line === 'END:VEVENT' && currentEvent) {
                                events.push(currentEvent);
                                currentEvent = null;
                            } else if (currentEvent) {
                                const [key, value] = line.split(':');
                                
                                if (key === 'SUMMARY') {
                                    currentEvent.title = value;
                                } else if (key === 'DTSTART') {
                                    currentEvent.start = formatICalDate(value);
                                } else if (key === 'DTEND') {
                                    currentEvent.end = formatICalDate(value);
                                } else if (key === 'DESCRIPTION') {
                                    currentEvent.description = value;
                                } else if (key === 'LOCATION') {
                                    currentEvent.location = value;
                                }
                            }
                        }
                    }
                    
                    if (events.length === 0) {
                        showNotification('No events found in the file', 'warning');
                        return;
                    }
                    
                    // Clear existing events if replace option is selected
                    if (importOption === 'replace') {
                        if (confirm(`Are you sure you want to replace all existing events with ${events.length} imported events?`)) {
                            // Remove all events from calendar
                            calendar.removeAllEvents();
                            
                            // Remove all events from database
                            db.collection('events').get().then((querySnapshot) => {
                                const batch = db.batch();
                                querySnapshot.forEach((doc) => {
                                    batch.delete(doc.ref);
                                });
                                return batch.commit();
                            }).then(() => {
                                importEventsToDatabase(events);
                            });
                        }
                    } else {
                        importEventsToDatabase(events);
                    }
                } catch (error) {
                    console.error('Error importing events:', error);
                    showNotification('Error importing events: ' + error.message, 'error');
                }
            };
            
            if (file.name.endsWith('.json') || file.name.endsWith('.ics')) {
                reader.readAsText(file);
            } else if (file.name.endsWith('.csv')) {
                reader.readAsText(file);
            } else {
                showNotification('Unsupported file format. Please use JSON, CSV, or ICS files.', 'warning');
            }
        }

        function importEventsToDatabase(events) {
            showNotification(`Importing ${events.length} events...`, 'info');
            
            let successCount = 0;
            let errorCount = 0;
            
            events.forEach((event, index) => {
                setTimeout(() => {
                    db.collection('events').add(event)
                        .then((docRef) => {
                            calendar.addEvent({
                                id: docRef.id,
                                ...event
                            });
                            successCount++;
                            
                            if (successCount + errorCount === events.length) {
                                showNotification(`Imported ${successCount} events successfully!`, 'success');
                                updateUpcomingEvents();
                                updateStatistics();
                            }
                        })
                        .catch((error) => {
                            console.error('Error importing event:', error);
                            errorCount++;
                            
                            if (successCount + errorCount === events.length) {
                                if (errorCount > 0) {
                                    showNotification(`Imported ${successCount} events with ${errorCount} errors.`, 'warning');
                                } else {
                                    showNotification(`Imported ${successCount} events successfully!`, 'success');
                                }
                                updateUpcomingEvents();
                                updateStatistics();
                            }
                        });
                }, index * 100); // Stagger imports to avoid overwhelming the database
            });
        }

        function formatICalDate(dateStr) {
            // Format: 20210101T120000Z
            const year = dateStr.substr(0, 4);
            const month = dateStr.substr(4, 2);
            const day = dateStr.substr(6, 2);
            const hour = dateStr.substr(9, 2);
            const minute = dateStr.substr(11, 2);
            const second = dateStr.substr(13, 2);
            
            return `${year}-${month}-${day}T${hour}:${minute}:${second}Z`;
        }

        function fetchQuote() {
            const quoteWidget = document.getElementById('quote-widget');
            
            // Simulate loading with animation
            setTimeout(() => {
                if (quoteWidget) {
                    // Add fade-out animation
                    quoteWidget.querySelector('.quote-content').style.opacity = '0';
                    quoteWidget.querySelector('.quote-content').style.transform = 'translateY(10px)';
                    
                    setTimeout(() => {
                        quoteWidget.querySelector('.quote-content').innerHTML = `
                            <div class="quote-text">"What would life be if we had no courage to attempt anything? The sadness will last forever—but so will the beauty, the wonder, and the love that we leave behind. Even in the darkest moments, there is light if we choose to see it. Keep going, keep creating, and never stop believing that something inside you is worth sharing with the world."</div>
                            <div class="quote-author">- Vincent Van Gogh</div>
                        `;
                        
                        // Add fade-in animation
                        quoteWidget.querySelector('.quote-content').style.opacity = '1';
                        quoteWidget.querySelector('.quote-content').style.transform = 'translateY(0)';
                    }, 300);
                } else {
                    console.error('Quote widget element not found');
                }
            }, 1500);
        }

        function getContrastColor(hexcolor) {
            if (!hexcolor) return 'black';
            
            // Handle rgba format
            if (hexcolor.startsWith('rgba') || hexcolor.startsWith('rgb')) {
                const rgbMatch = hexcolor.match(/\d+/g);
                if (rgbMatch && rgbMatch.length >= 3) {
                    const r = parseInt(rgbMatch[0]);
                    const g = parseInt(rgbMatch[1]);
                    const b = parseInt(rgbMatch[2]);
                    const yiq = ((r*299)+(g*587)+(b*114))/1000;
                    return (yiq >= 128) ? 'black' : 'white';
                }
                return 'black';
            }
            
            // Handle hex format
            hexcolor = hexcolor.replace("#", "");
            var r = parseInt(hexcolor.substr(0,2),16);
            var g = parseInt(hexcolor.substr(2,2),16);
            var b = parseInt(hexcolor.substr(4,2),16);
            var yiq = ((r*299)+(g*587)+(b*114))/1000;
            return (yiq >= 128) ? 'black' : 'white';
        }

        // Notification system
        function showNotification(message, type = 'info') {
            // Create notification container if it doesn't exist
            let container = document.getElementById('notification-container');
            if (!container) {
                container = document.createElement('div');
                container.id = 'notification-container';
                document.body.appendChild(container);
            }
            
            // Create notification
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            
            // Set type-specific styles and icon
            let icon = '';
            if (type === 'success') {
                icon = '<i class="fas fa-check-circle"></i>';
            } else if (type === 'error') {
                icon = '<i class="fas fa-exclamation-circle"></i>';
            } else if (type === 'warning') {
                icon = '<i class="fas fa-exclamation-triangle"></i>';
            } else {
                icon = '<i class="fas fa-info-circle"></i>';
            }
            
            notification.innerHTML = `${icon} <span>${message}</span>`;
            container.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            
            // Auto remove after delay
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>
