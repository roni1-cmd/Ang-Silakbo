<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANG SILAKBO - Memos</title>
    <link rel="icon" href="SILAKBO.png">
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.css' rel='stylesheet' />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #E65100;
            --secondary-color: #FF8C00;
            --accent-color: #FF4500;
            --background-color: #FFFFFF;
            --text-color: #333333;
            --light-bg: #f8f9fa;
            --border-color: #e0e0e0;
            --success-color: #4CAF50;
            --error-color: #F44336;
            --warning-color: #FF9800;
            --info-color: #2196F3;
            --transition-speed: 0.3s;
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.03);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.09);
            --radius-sm: 16px;
            --radius-md: 20px;
            --radius-lg: 28px;
            --radius-xl: 32px;
            --header-height: 80px;
            --sidebar-width: 300px;
            --glass-bg: rgba(255, 255, 255, 0.8);
            --glass-border: rgba(255, 255, 255, 0.18);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--text-color);
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Layout */
        .app-container {
            display: flex;
            min-height: 100vh;
            position: relative;
        }

        /* Header */
        .app-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--header-height);
            background-color: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: var(--shadow-sm);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2.5rem;
            z-index: 50;
            transition: all var(--transition-speed) ease;
            border-bottom: 1px solid var(--glass-border);
            border-radius: 0 0 var(--radius-sm) var(--radius-sm);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1.8rem;
        }

        .menu-toggle {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            background-color: rgba(230, 81, 0, 0.1);
            color: var(--primary-color);
        }

        .menu-toggle:hover {
            background-color: rgba(230, 81, 0, 0.2);
            transform: scale(1.05);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 1.2rem;
        }

        .logo {
            width: 48px;
            height: 48px;
            object-fit: contain;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .app-title {
            font-size: 1.6rem;
            font-weight: 600;
            color: var(--primary-color);
            letter-spacing: 0.5px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1.8rem;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 1.2rem;
            cursor: pointer;
            padding: 0.6rem 1.2rem;
            border-radius: var(--radius-md);
            transition: all var(--transition-speed) ease;
            background-color: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid var(--glass-border);
        }

        .user-profile:hover {
            background-color: rgba(255, 255, 255, 0.8);
            transform: translateY(-2px);
        }

        .user-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1.3rem;
            box-shadow: 0 4px 10px rgba(230, 81, 0, 0.3);
        }

        .user-info {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-weight: 600;
            font-size: 1rem;
        }

        .user-role {
            font-size: 0.8rem;
            opacity: 0.7;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(135deg, rgba(230, 81, 0, 0.95), rgba(255, 69, 0, 0.95));
            color: white;
            position: fixed;
            height: 100vh;
            left: 0;
            top: 0;
            z-index: 40;
            transition: transform var(--transition-speed) ease;
            box-shadow: var(--shadow-lg);
            display: flex;
            flex-direction: column;
            transform: translateX(-100%);
            padding-top: var(--header-height);
            border-radius: 0 var(--radius-lg) var(--radius-lg) 0;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }

        .sidebar.active {
            transform: translateX(0);
        }

        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 2.5rem;
        }

        .sidebar-section {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            background-color: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: var(--radius-md);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-section h3 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            opacity: 0.9;
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
            padding-left: 0.5rem;
            font-weight: 500;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.9rem 1.2rem;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            position: relative;
        }

        .nav-item:hover {
            background-color: rgba(255, 255, 255, 0.15);
            transform: translateX(5px);
        }

        .nav-item i {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        .nav-item.active {
            background-color: rgba(255, 255, 255, 0.25);
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .filter-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.9rem 1.2rem;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
        }

        .filter-item:hover {
            background-color: rgba(255, 255, 255, 0.15);
            transform: translateX(5px);
        }

        .filter-color {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: inline-block;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.4);
        }

        .filter-label {
            font-size: 0.95rem;
        }

        .filter-item.active {
            background-color: rgba(255, 255, 255, 0.25);
            font-weight: 500;
        }

        .sidebar-footer {
            padding: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            gap: 1.2rem;
        }

        .add-event-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            padding: 1rem 1.2rem;
            background-color: white;
            color: var(--primary-color);
            border-radius: var(--radius-sm);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            border: none;
            box-shadow: var(--shadow-md);
        }

        .add-event-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
            background-color: rgba(255, 255, 255, 0.9);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 0;
            margin-top: var(--header-height);
            transition: margin-left var(--transition-speed) ease;
            padding: 2.5rem;
            display: flex;
            flex-direction: column;
            gap: 2.5rem;
        }

        .main-content.sidebar-active {
            margin-left: var(--sidebar-width);
        }

        /* Page Header */
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .page-title {
            font-size: 2rem;
            font-weight: 600;
            color: var(--primary-color);
            position: relative;
        }

        .page-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 50px;
            height: 4px;
            background-color: var(--accent-color);
            border-radius: 4px;
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2.5rem;
        }

        @media (min-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: 2fr 1fr;
            }
        }

        /* Card Styles */
        .card {
            background-color: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: var(--radius-lg);
            box-shadow: var(--glass-shadow);
            overflow: hidden;
            transition: all var(--transition-speed) ease;
            display: flex;
            flex-direction: column;
            border: 1px solid var(--glass-border);
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-5px);
        }

        .card-header {
            padding: 1.8rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--glass-border);
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 0.7rem;
        }

        .card-body {
            padding: 1.8rem;
            flex: 1;
        }

        /* Calendar Card */
        .calendar-card {
            min-height: 700px;
        }

        .view-selector {
            display: flex;
            gap: 0.5rem;
            background-color: rgba(248, 249, 250, 0.7);
            padding: 0.3rem;
            border-radius: var(--radius-md);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid var(--glass-border);
        }

        .view-option {
            padding: 0.6rem 1.2rem;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
        }

        .view-option.active {
            background-color: var(--primary-color);
            color: white;
            box-shadow: 0 4px 10px rgba(230, 81, 0, 0.3);
        }

        .view-option:not(.active):hover {
            background-color: rgba(230, 81, 0, 0.1);
        }

        .calendar-navigation {
            display: flex;
            gap: 0.7rem;
        }

        #calendar {
            height: 100%;
            min-height: 600px;
        }

        /* Widgets */
        .widgets-container {
            display: flex;
            flex-direction: column;
            gap: 2.5rem;
        }

        /* Upcoming Events Widget */
        .upcoming-events {
            display: flex;
            flex-direction: column;
            gap: 1.2rem;
        }

        .event-card {
            background-color: rgba(248, 249, 250, 0.7);
            padding: 1.2rem;
            border-radius: var(--radius-md);
            border-left: 4px solid var(--primary-color);
            transition: all var(--transition-speed) ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            gap: 0.7rem;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow-sm);
        }

        .event-card:hover {
            transform: translateX(5px);
            box-shadow: var(--shadow-md);
            background-color: rgba(255, 255, 255, 0.9);
        }

        .event-card-title {
            font-weight: 600;
            font-size: 1.05rem;
        }

        .event-card-time {
            font-size: 0.9rem;
            color: #666;
            display: flex;
            align-items: center;
            gap: 0.7rem;
        }

        .event-card-time i {
            color: var(--primary-color);
        }

        /* Stats Widget */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.2rem;
        }

        .stat-item {
            background-color: rgba(248, 249, 250, 0.7);
            border-radius: var(--radius-md);
            padding: 1.5rem;
            text-align: center;
            transition: all var(--transition-speed) ease;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid var(--glass-border);
        }

        .stat-item:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-sm);
            background-color: rgba(255, 255, 255, 0.9);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.7rem;
        }

        .stat-label {
            font-size: 0.95rem;
            color: #666;
        }

        /* Quote Widget */
        #quote-widget {
            background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
            color: white;
        }

        .quote-content {
            display: flex;
            flex-direction: column;
            gap: 1.2rem;
            transition: all var(--transition-speed) ease;
        }

        .quote-text {
            font-style: italic;
            line-height: 1.7;
            position: relative;
            padding-left: 1.8rem;
            font-size: 1.05rem;
        }

        .quote-text::before {
            content: '"';
            position: absolute;
            left: 0;
            top: -0.5rem;
            font-size: 2.2rem;
            opacity: 0.7;
        }

        .quote-author {
            text-align: right;
            font-weight: 500;
            opacity: 0.9;
        }

        /* Weather Widget */
        .weather-widget {
            display: flex;
            align-items: center;
            gap: 1.8rem;
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.9), rgba(41, 128, 185, 0.9));
            color: white;
            padding: 1.8rem;
            border-radius: var(--radius-md);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(41, 128, 185, 0.2);
        }

        .weather-icon {
            font-size: 2.8rem;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .weather-info {
            display: flex;
            flex-direction: column;
            gap: 0.7rem;
        }

        .weather-temp {
            font-size: 2rem;
            font-weight: 600;
        }

        .weather-desc {
            font-size: 0.95rem;
            opacity: 0.9;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 1.2rem;
            margin-top: 1.2rem;
        }

        /* Button Styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.7rem;
            padding: 0.9rem 1.5rem;
            border-radius: var(--radius-md);
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            border: none;
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--accent-color);
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-outline {
            background-color: rgba(255, 255, 255, 0.7);
            border: 1px solid var(--glass-border);
            color: var(--text-color);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }

        .btn-outline:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background-color: rgba(255, 255, 255, 0.9);
        }

        .btn-icon {
            width: 48px;
            height: 48px;
            padding: 0;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(8px);
        }

        .modal.show {
            display: block;
            animation: modalFadeIn 0.3s ease;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background-color: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            margin: 5% auto;
            padding: 2.5rem;
            border-radius: var(--radius-xl);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--glass-shadow);
            transform: translateY(20px);
            opacity: 0;
            transition: all 0.3s ease;
            border: 1px solid var(--glass-border);
        }

        .modal.show .modal-content {
            transform: translateY(0);
            opacity: 1;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.8rem;
            padding-bottom: 1.2rem;
            border-bottom: 1px solid var(--glass-border);
        }

        .modal-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 0.7rem;
        }

        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close:hover {
            color: var(--primary-color);
            background-color: rgba(230, 81, 0, 0.1);
        }

        .modal-body {
            margin-bottom: 1.8rem;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1.2rem;
            padding-top: 1.2rem;
            border-top: 1px solid var(--glass-border);
        }

        /* Form Styles */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        @media (min-width: 768px) {
            .form-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .form-group {
            margin-bottom: 1.2rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.7rem;
            font-weight: 500;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
        }

        .form-group label i {
            color: var(--primary-color);
        }

        .form-control {
            width: 100%;
            padding: 0.9rem 1.2rem;
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-md);
            transition: all var(--transition-speed) ease;
            font-family: 'Poppins', sans-serif;
            background-color: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }

        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(230, 81, 0, 0.2);
            outline: none;
            background-color: rgba(255, 255, 255, 0.9);
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .color-dropdown {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .color-dropdown-content {
            display: none;
            position: absolute;
            background-color: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            min-width: 100%;
            box-shadow: var(--glass-shadow);
            z-index: 10;
            border-radius: var(--radius-md);
            max-height: 250px;
            overflow-y: auto;
            transform-origin: top center;
            transform: scaleY(0.8);
            opacity: 0;
            transition: all var(--transition-speed) ease;
            border: 1px solid var(--glass-border);
        }

        .color-dropdown-content.show {
            display: block;
            transform: scaleY(1);
            opacity: 1;
        }

        .color-option {
            padding: 12px 16px;
            text-decoration: none;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
        }

        .color-option:hover {
            background-color: rgba(248, 249, 250, 0.9);
        }

        .color-preview {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            margin-right: 16px;
            box-shadow: var(--shadow-sm);
        }

        /* Notification System */
        #notification-container {
            position: fixed;
            top: 24px;
            right: 24px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 12px;
            pointer-events: none;
        }

        .notification {
            padding: 16px 24px;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 16px;
            min-width: 300px;
            max-width: 380px;
            transform: translateX(100%);
            opacity: 0;
            transition: all var(--transition-speed) ease;
            pointer-events: auto;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .notification::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background-color: rgba(255, 255, 255, 0.5);
            animation: notificationTimer 3s linear forwards;
        }

        @keyframes notificationTimer {
            to { width: 100%; }
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .notification-success {
            background-color: rgba(76, 175, 80, 0.9);
            color: white;
        }

        .notification-error {
            background-color: rgba(244, 67, 54, 0.9);
            color: white;
        }

        .notification-warning {
            background-color: rgba(255, 152, 0, 0.9);
            color: white;
        }

        .notification-info {
            background-color: rgba(33, 150, 243, 0.9);
            color: white;
        }

        /* Dark Mode Toggle */
        .dark-mode-toggle {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 100;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            transition: all var(--transition-speed) ease;
        }

        .dark-mode-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 30px rgba(230, 81, 0, 0.3);
        }

        /* Dark Mode Styles */
        .dark-mode {
            --background-color: #121212;
            --light-bg: #1e1e1e;
            --text-color: #e0e0e0;
            --border-color: #333333;
            --glass-bg: rgba(30, 30, 30, 0.8);
            --glass-border: rgba(255, 255, 255, 0.08);
        }

        .dark-mode .fc-theme-standard .fc-scrollgrid,
        .dark-mode .fc-theme-standard td,
        .dark-mode .fc-theme-standard th {
            border-color: #333333;
        }

        .dark-mode .fc-col-header-cell {
            background-color: #1e1e1e;
        }
        
        .dark-mode .form-control {
            background-color: rgba(30, 30, 30, 0.7);
            color: #e0e0e0;
        }
        
        .dark-mode .color-dropdown-content,
        .dark-mode .color-option {
            background-color: rgba(30, 30, 30, 0.9);
            color: #e0e0e0;
        }
        
        .dark-mode .color-option:hover {
            background-color: #2a2a2a;
        }

        /* Loading animation */
        .loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive Styles */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content.sidebar-active {
                margin-left: 0;
            }
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .page-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .app-header {
                padding: 0 1.2rem;
            }
            
            .app-title {
                font-size: 1.4rem;
            }
            
            .user-profile {
                display: none;
            }
        }

        /* FullCalendar Custom Styles */
        .fc .fc-toolbar {
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1.8rem !important;
        }

        .fc .fc-toolbar-title {
            font-size: 1.6rem !important;
            font-weight: 600;
            color: var(--primary-color);
        }

        .fc .fc-button-primary {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
            transition: all var(--transition-speed) ease;
            font-weight: 500;
            padding: 0.7rem 1.2rem;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
        }

        .fc .fc-button-primary:hover {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }

        .fc .fc-button-primary:not(:disabled).fc-button-active,
        .fc .fc-button-primary:not(:disabled):active {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .fc .fc-daygrid-day-frame {
            min-height: 120px;
            transition: background-color var(--transition-speed) ease;
        }

        .fc-view-harness {
            transition: height 0.5s ease !important;
        }

        .fc-day {
            transition: background-color var(--transition-speed) ease;
        }

        .fc-day:hover {
            background-color: rgba(255, 140, 0, 0.05);
        }

        .fc .fc-day-today {
            background-color: rgba(255, 140, 0, 0.1);
        }

        .fc-event {
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            border-radius: var(--radius-md);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .fc-event:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
            z-index: 5;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <div class="menu-toggle" id="menu-toggle">
                    <i class="fas fa-bars"></i>
                </div>
                <div class="logo-container">
                    <img src="SILAKBO.png" alt="SILAKBO Logo" class="logo">
                    <h1 class="app-title"><strong>ANG SILAKBO</strong></h1>
                </div>
            </div>
            <div class="header-right">
                <div class="header-actions">
                    <a href="Ang Silakbo Admin Panel.html" class="btn btn-secondary">
                        <i class="fas fa-home"></i> Home
                    </a>
                    <button class="btn btn-outline" id="sync-button">
                        <i class="fas fa-sync-alt"></i> Sync
                    </button>
                </div>
                <div class="user-profile">
                    <div class="user-avatar">S</div>
                    <div class="user-info">
                        <div class="user-name">SILAKBO</div>
                        <div class="user-role">Admin</div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <h3><i class="fas fa-home"></i> Navigation</h3>
                    <div class="nav-item active">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Calendar</span>
                    </div>
                    <div class="nav-item">
                        <i class="fas fa-tasks"></i>
                        <span>Tasks</span>
                    </div>
                    <div class="nav-item">
                        <i class="fas fa-chart-line"></i>
                        <span>Analytics</span>
                    </div>
                    <div class="nav-item">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3><i class="fas fa-filter"></i> Filters</h3>
                    <div class="filter-item">
                        <span class="filter-color" style="background-color: #FF0000;"></span>
                        <span class="filter-label">Important</span>
                    </div>
                    <div class="filter-item">
                        <span class="filter-color" style="background-color: #0000FF;"></span>
                        <span class="filter-label">Meetings</span>
                    </div>
                    <div class="filter-item">
                        <span class="filter-color" style="background-color: #00FF00;"></span>
                        <span class="filter-label">Personal</span>
                    </div>
                    <div class="filter-item">
                        <span class="filter-color" style="background-color: #FFA500;"></span>
                        <span class="filter-label">Events</span>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3><i class="fas fa-calendar-day"></i> Upcoming</h3>
                    <div id="upcoming-events-list">
                        <div class="event-card" style="border-left-color: #FF0000;">
                            <div class="event-card-title">Board Meeting</div>
                            <div class="event-card-time"><i class="far fa-clock"></i> Today, 2:00 PM</div>
                        </div>
                        <div class="event-card" style="border-left-color: #0000FF;">
                            <div class="event-card-title">Team Sync</div>
                            <div class="event-card-time"><i class="far fa-clock"></i> Tomorrow, 10:00 AM</div>
                        </div>
                        <div class="event-card" style="border-left-color: #FFA500;">
                            <div class="event-card-title">Community Event</div>
                            <div class="event-card-time"><i class="far fa-clock"></i> Friday, 6:00 PM</div>
                        </div>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3><i class="fas fa-cloud-sun"></i> Weather</h3>
                    <div class="weather-widget">
                        <div class="weather-icon"><i class="fas fa-sun"></i></div>
                        <div class="weather-info">
                            <div class="weather-temp">28°C</div>
                            <div class="weather-desc">Sunny (eme eme ra ni mess hart)</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="sidebar-footer">
                <button class="add-event-btn" id="add-event-btn">
                    <i class="fas fa-plus"></i> Add New Event
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="main-content">
            <div class="page-header">
                <h1 class="page-title">Memos Dashboard</h1>
            </div>

            <div class="dashboard-grid">
                <div class="card calendar-card">
                    <div class="card-header">
                        <div class="view-selector">
                            <div class="view-option active" data-view="dayGridMonth">
                                <i class="fas fa-calendar-alt"></i> Month
                            </div>
                            <div class="view-option" data-view="timeGridWeek">
                                <i class="fas fa-calendar-week"></i> Week
                            </div>
                            <div class="view-option" data-view="timeGridDay">
                                <i class="fas fa-calendar-day"></i> Day
                            </div>
                        </div>
                        <div class="calendar-navigation">
                            <button class="btn btn-outline btn-icon" id="today-btn">
                                <i class="fas fa-calendar-day"></i>
                            </button>
                            <button class="btn btn-outline btn-icon" id="prev-btn">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="btn btn-outline btn-icon" id="next-btn">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="calendar"></div>
                    </div>
                </div>

                <div class="widgets-container">
                    <div class="card" id="stats-widget">
                        <div class="card-header">
                            <div class="card-title"><i class="fas fa-chart-pie"></i> Statistics</div>
                        </div>
                        <div class="card-body">
                            <div class="stats-grid">
                                <div class="stat-item">
                                    <div class="stat-value" id="total-events">0</div>
                                    <div class="stat-label">Total Events</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="upcoming-events">0</div>
                                    <div class="stat-label">Upcoming</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="this-month">0</div>
                                    <div class="stat-label">This Month</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="completed-events">0</div>
                                    <div class="stat-label">Completed</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card" id="quote-widget">
                        <div class="card-header">
                            <div class="card-title"><i class="fas fa-quote-left"></i> Inspiration</div>
                        </div>
                        <div class="card-body">
                            <div class="quote-content">
                                <div class="loading-spinner"></div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-title"><i class="fas fa-tools"></i> Actions</div>
                        </div>
                        <div class="card-body">
                            <div class="action-buttons">
                                <button class="btn btn-primary" onclick="printCalendar()">
                                    <i class="fas fa-print"></i> Print Calendar
                                </button>
                                <button class="btn btn-primary" onclick="saveAsImage()">
                                    <i class="fas fa-image"></i> Save as Image
                                </button>
                                <button class="btn btn-primary" id="export-btn">
                                    <i class="fas fa-file-export"></i> Export Events
                                </button>
                                <button class="btn btn-primary" id="import-btn">
                                    <i class="fas fa-file-import"></i> Import Events
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Event Modal -->
    <div id="eventModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle"><i class="fas fa-plus-circle"></i> Add Event</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <form id="eventForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="eventTitle"><i class="fas fa-heading"></i> Title</label>
                            <input type="text" id="eventTitle" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="eventCategory"><i class="fas fa-tag"></i> Category</label>
                            <select id="eventCategory" class="form-control">
                                <option value="important">Important</option>
                                <option value="meeting">Meeting</option>
                                <option value="personal">Personal</option>
                                <option value="event">Event</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="eventColor"><i class="fas fa-palette"></i> Color</label>
                            <div class="color-dropdown">
                                <button type="button" class="btn btn-outline" style="width: 100%;" onclick="toggleColorDropdown()">
                                    <i class="fas fa-palette"></i> Select Color
                                </button>
                                <div id="colorDropdown" class="color-dropdown-content"></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="eventStart"><i class="fas fa-clock"></i> Start</label>
                            <input type="datetime-local" id="eventStart" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="eventEnd"><i class="fas fa-clock"></i> End</label>
                            <input type="datetime-local" id="eventEnd" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="eventLocation"><i class="fas fa-map-marker-alt"></i> Location</label>
                            <input type="text" id="eventLocation" class="form-control">
                        </div>
                        <div class="form-group full-width">
                            <label for="eventDescription"><i class="fas fa-align-left"></i> Description</label>
                            <textarea id="eventDescription" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="eventReminder"><i class="fas fa-bell"></i> Reminder</label>
                            <select id="eventReminder" class="form-control">
                                <option value="none">None</option>
                                <option value="15">15 minutes before</option>
                                <option value="30">30 minutes before</option>
                                <option value="60">1 hour before</option>
                                <option value="1440">1 day before</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="eventPriority"><i class="fas fa-flag"></i> Priority</label>
                            <select id="eventPriority" class="form-control">
                                <option value="low">Low</option>
                                <option value="medium" selected>Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline" id="cancelBtn">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveEventBtn"><i class="fas fa-save"></i> Save Event</button>
                <button type="button" class="btn btn-outline" id="deleteEventBtn" style="display: none; background-color: #F44336; color: white;">
                    <i class="fas fa-trash"></i> Delete Event
                </button>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div id="exportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title"><i class="fas fa-file-export"></i> Export Events</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="exportFormat"><i class="fas fa-file-code"></i> Format</label>
                    <select id="exportFormat" class="form-control">
                        <option value="json">JSON</option>
                        <option value="csv">CSV</option>
                        <option value="ical">iCalendar</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="exportDateRange"><i class="fas fa-calendar-alt"></i> Date Range</label>
                    <select id="exportDateRange" class="form-control">
                        <option value="all">All Events</option>
                        <option value="future">Future Events</option>
                        <option value="past">Past Events</option>
                        <option value="month">This Month</option>
                        <option value="custom">Custom Range</option>
                    </select>
                </div>
                <div id="customDateRange" style="display: none;">
                    <div class="form-group">
                        <label for="exportStartDate"><i class="fas fa-calendar-day"></i> Start Date</label>
                        <input type="date" id="exportStartDate" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="exportEndDate"><i class="fas fa-calendar-day"></i> End Date</label>
                        <input type="date" id="exportEndDate" class="form-control">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline" id="cancelExportBtn">Cancel</button>
                <button type="button" class="btn btn-primary" id="confirmExportBtn"><i class="fas fa-download"></i> Export</button>
            </div>
        </div>
    </div>

    <!-- Import Modal -->
    <div id="importModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title"><i class="fas fa-file-import"></i> Import Events</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="importFile"><i class="fas fa-file-upload"></i> Select File</label>
                    <input type="file" id="importFile" class="form-control" accept=".json,.csv,.ics">
                </div>
                <div class="form-group">
                    <label for="importOptions"><i class="fas fa-cog"></i> Import Options</label>
                    <select id="importOptions" class="form-control">
                        <option value="add">Add to existing events</option>
                        <option value="replace">Replace all events</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline" id="cancelImportBtn">Cancel</button>
                <button type="button" class="btn btn-primary" id="confirmImportBtn"><i class="fas fa-upload"></i> Import</button>
            </div>
        </div>
    </div>

    <div class="dark-mode-toggle" id="darkModeToggle">
        <i class="fas fa-moon"></i>
    </div>

    <div id="notification-container"></div>

    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.js'></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-analytics.js"></script>
    <script>
        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDSe2c9-8xqShoHEW-D7BXXAyD5N9uXWEs",
            authDomain: "ang-silakbo.firebaseapp.com",
            databaseURL: "https://ang-silakbo-default-rtdb.firebaseio.com",
            projectId: "ang-silakbo",
            storageBucket: "ang-silakbo.appspot.com",
            messagingSenderId: "1006400633782",
            appId: "1:1006400633782:web:ef4a93c1d445cb825b9f17",
            measurementId: "G-TSDTG2YJ94"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const analytics = firebase.analytics();

        let calendar;
        let currentEvent = null;
        let currentView = 'dayGridMonth';

        const colors = [
            { name: 'Red', value: '#FF0000' },
            { name: 'Blue', value: '#0000FF' },
            { name: 'Green', value: '#00FF00' },
            { name: 'Yellow', value: '#FFFF00' },
            { name: 'Purple', value: '#800080' },
            { name: 'Orange', value: '#FFA500' },
            { name: 'Pink', value: '#FFC0CB' },
            { name: 'Teal', value: '#008080' },
            { name: 'Brown', value: '#A52A2A' },
            { name: 'Gray', value: '#808080' }
        ];

        const categoryColors = {
            important: '#FF0000',
            meeting: '#0000FF',
            personal: '#00FF00',
            event: '#FFA500',
            other: '#808080'
        };

        document.addEventListener('DOMContentLoaded', function() {
            initializeCalendar();
            setupEventListeners();
            setupColorDropdown();
            fetchQuote();
            updateStatistics();
            
            // Check for dark mode preference
            if (localStorage.getItem('darkMode') === 'enabled') {
                document.body.classList.add('dark-mode');
                document.getElementById('darkModeToggle').innerHTML = '<i class="fas fa-sun"></i>';
            }
        });

        function initializeCalendar() {
            const calendarEl = document.getElementById('calendar');
            calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                headerToolbar: false, // We'll use our custom header
                editable: true,
                selectable: true,
                selectMirror: true,
                dayMaxEvents: true,
                select: function(info) {
                    openModal(info.startStr, info.endStr);
                },
                eventClick: function(info) {
                    openModal(info.event.startStr, info.event.endStr, info.event);
                },
                eventTimeFormat: {
                    hour: 'numeric',
                    minute: '2-digit',
                    meridiem: 'short'
                },
                eventContent: function(arg) {
                    const timeText = arg.timeText ? `<div class="fc-event-time">${arg.timeText}</div>` : '';
                    const priorityIcon = arg.event.extendedProps.priority === 'high' ? 
                        '<i class="fas fa-exclamation-circle" style="margin-right: 5px;"></i>' : '';
                    
                    return {
                        html: `
                            <div class="fc-event-main-frame" style="background-color: ${arg.event.backgroundColor}; color: ${getContrastColor(arg.event.backgroundColor)}; padding: 8px 12px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                ${timeText}
                                <div class="fc-event-title-container">
                                    <div class="fc-event-title fc-sticky">${priorityIcon}${arg.event.title}</div>
                                </div>
                            </div>
                        `
                    };
                },
                datesSet: function(dateInfo) {
                    // Update the active view in the view selector
                    document.querySelectorAll('.view-option').forEach(option => {
                        option.classList.remove('active');
                    });
                    document.querySelector(`.view-option[data-view="${dateInfo.view.type}"]`).classList.add('active');
                    
                    // Update upcoming events list
                    updateUpcomingEvents();
                    
                    // Update statistics
                    updateStatistics();
                    
                    currentView = dateInfo.view.type;
                }
            });

            calendar.render();
            loadEvents();
        }

        function setupEventListeners() {
            // Menu toggle
            document.getElementById('menu-toggle').addEventListener('click', function() {
                const sidebar = document.getElementById('sidebar');
                const mainContent = document.getElementById('main-content');
                sidebar.classList.toggle('active');
                mainContent.classList.toggle('sidebar-active');
                
                // Change icon
                const icon = this.querySelector('i');
                if (sidebar.classList.contains('active')) {
                    icon.classList.remove('fa-bars');
                    icon.classList.add('fa-times');
                } else {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            });
            
            // View selector
            document.querySelectorAll('.view-option').forEach(option => {
                option.addEventListener('click', function() {
                    const view = this.getAttribute('data-view');
                    calendar.changeView(view);
                });
            });
            
            // Navigation buttons
            document.getElementById('today-btn').addEventListener('click', function() {
                calendar.today();
            });
            
            document.getElementById('prev-btn').addEventListener('click', function() {
                calendar.prev();
            });
            
            document.getElementById('next-btn').addEventListener('click', function() {
                calendar.next();
            });
            
            // Add event button
            document.getElementById('add-event-btn').addEventListener('click', function() {
                const now = new Date();
                const start = now.toISOString().slice(0, 16);
                const end = new Date(now.getTime() + 60 * 60 * 1000).toISOString().slice(0, 16);
                openModal(start, end);
            });
            
            // Modal close buttons
            document.querySelectorAll('.close, #cancelBtn').forEach(el => {
                el.addEventListener('click', function() {
                    closeModal('eventModal');
                });
            });
            
            // Save event button
            document.getElementById('saveEventBtn').addEventListener('click', function() {
                saveEvent();
            });
            
            // Delete event button
            document.getElementById('deleteEventBtn').addEventListener('click', function() {
                if (currentEvent) {
                    deleteEvent(currentEvent.id);
                }
            });
            
            // Export button
            document.getElementById('export-btn').addEventListener('click', function() {
                openModal('exportModal');
            });
            
            document.getElementById('exportDateRange').addEventListener('change', function() {
                if (this.value === 'custom') {
                    document.getElementById('customDateRange').style.display = 'block';
                } else {
                    document.getElementById('customDateRange').style.display = 'none';
                }
            });
            
            document.getElementById('cancelExportBtn').addEventListener('click', function() {
                closeModal('exportModal');
            });
            
            document.getElementById('confirmExportBtn').addEventListener('click', function() {
                exportEvents();
                closeModal('exportModal');
            });
            
            // Import button
            document.getElementById('import-btn').addEventListener('click', function() {
                openModal('importModal');
            });
            
            document.getElementById('cancelImportBtn').addEventListener('click', function() {
                closeModal('importModal');
            });
            
            document.getElementById('confirmImportBtn').addEventListener('click', function() {
                importEvents();
                closeModal('importModal');
            });
            
            // Sync button
            document.getElementById('sync-button').addEventListener('click', function() {
                this.querySelector('i').classList.add('fa-spin');
                showNotification('Syncing calendar...', 'info');
                
                loadEvents();
                
                setTimeout(() => {
                    this.querySelector('i').classList.remove('fa-spin');
                    showNotification('Calendar synced successfully!', 'success');
                }, 1500);
            });
            
            // Dark mode toggle
            document.getElementById('darkModeToggle').addEventListener('click', function() {
                document.body.classList.toggle('dark-mode');
                if (document.body.classList.contains('dark-mode')) {
                    localStorage.setItem('darkMode', 'enabled');
                    this.innerHTML = '<i class="fas fa-sun"></i>';
                    showNotification('Dark mode enabled', 'info');
                } else {
                    localStorage.setItem('darkMode', 'disabled');
                    this.innerHTML = '<i class="fas fa-moon"></i>';
                    showNotification('Light mode enabled', 'info');
                }
            });
            
            // Close modals when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    closeModal(event.target.id);
                }
                
                // Close color dropdown when clicking outside
                if (!event.target.matches('.color-dropdown .btn') && 
                    !event.target.closest('#colorDropdown')) {
                    document.getElementById('colorDropdown').classList.remove('show');
                }
            });
            
            // Filter items
            document.querySelectorAll('.filter-item').forEach(item => {
                item.addEventListener('click', function() {
                    this.classList.toggle('active');
                    const color = this.querySelector('.filter-color').style.backgroundColor;
                    filterEventsByColor(color);
                });
            });
            
            // Event category change
            document.getElementById('eventCategory').addEventListener('change', function() {
                const category = this.value;
                const color = categoryColors[category] || colors[0].value;
                selectColor(color);
            });
            
            // Navigation items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show notification for demo purposes
                    const navText = this.querySelector('span').textContent;
                    showNotification(`Navigated to ${navText}`, 'info');
                });
            });
        }

        function setupColorDropdown() {
            const colorDropdown = document.getElementById('colorDropdown');
            colorDropdown.innerHTML = ''; // Clear existing options
            
            colors.forEach(color => {
                const colorOption = document.createElement('div');
                colorOption.className = 'color-option';
                colorOption.innerHTML = `
                    <span class="color-preview" style="background-color: ${color.value}"></span>
                    <span>${color.name}</span>
                `;
                colorOption.addEventListener('click', () => {
                    selectColor(color.value);
                    toggleColorDropdown();
                });
                
                colorDropdown.appendChild(colorOption);
            });
        }

        function toggleColorDropdown() {
            const dropdown = document.getElementById('colorDropdown');
            dropdown.classList.toggle('show');
        }

        function selectColor(color) {
            const colorButton = document.querySelector('.color-dropdown .btn');
            colorButton.style.backgroundColor = color;
            colorButton.style.color = getContrastColor(color);
            colorButton.innerHTML = `<i class="fas fa-palette"></i> ${getColorName(color)}`;
        }
        
        function getColorName(colorValue) {
            const color = colors.find(c => c.value.toLowerCase() === colorValue.toLowerCase());
            return color ? color.name : 'Custom';
        }

        function openModal(start, end, event = null) {
            currentEvent = event;
            const modalId = event ? 'eventModal' : (start ? 'eventModal' : 'exportModal');
            const modal = document.getElementById(modalId);
            
            if (modalId === 'eventModal') {
                const form = document.getElementById('eventForm');
                const title = document.getElementById('modalTitle');
                const deleteBtn = document.getElementById('deleteEventBtn');
                
                if (event) {
                    title.innerHTML = '<i class="fas fa-edit"></i> Edit Event';
                    form.eventTitle.value = event.title;
                    form.eventStart.value = event.start.toISOString().slice(0, 16);
                    form.eventEnd.value = event.end ? event.end.toISOString().slice(0, 16) : '';
                    form.eventDescription.value = event.extendedProps.description || '';
                    form.eventLocation.value = event.extendedProps.location || '';
                    form.eventReminder.value = event.extendedProps.reminder || 'none';
                    form.eventCategory.value = event.extendedProps.category || 'other';
                    form.eventPriority.value = event.extendedProps.priority || 'medium';
                    selectColor(event.backgroundColor);
                    deleteBtn.style.display = 'inline-block';
                } else {
                    title.innerHTML = '<i class="fas fa-plus-circle"></i> Add Event';
                    form.reset();
                    form.eventStart.value = start.slice(0, 16);
                    form.eventEnd.value = end.slice(0, 16);
                    
                    // Set default color based on category
                    const defaultCategory = form.eventCategory.value;
                    const defaultColor = categoryColors[defaultCategory] || colors[0].value;
                    selectColor(defaultColor);
                    
                    deleteBtn.style.display = 'none';
                }
            }

            modal.classList.add('show');
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('show');
        }

        function saveEvent() {
            const form = document.getElementById('eventForm');
            const category = form.eventCategory.value;
            
            const eventData = {
                title: form.eventTitle.value,
                start: form.eventStart.value,
                end: form.eventEnd.value,
                backgroundColor: document.querySelector('.color-dropdown .btn').style.backgroundColor || categoryColors[category],
                description: form.eventDescription.value,
                location: form.eventLocation.value,
                reminder: form.eventReminder.value,
                category: category,
                priority: form.eventPriority.value
            };

            if (currentEvent) {
                updateEvent(currentEvent.id, eventData);
            } else {
                addEvent(eventData);
            }

            closeModal('eventModal');
        }

        function addEvent(eventData) {
            // Show loading indicator
            showNotification('Adding event...', 'info');
            
            db.collection('events').add(eventData)
                .then((docRef) => {
                    console.log('Event added with ID: ', docRef.id);
                    
                    const newEvent = {
                        id: docRef.id,
                        ...eventData
                    };
                    
                    calendar.addEvent(newEvent);
                    
                    showNotification('Event added successfully!', 'success');
                    updateUpcomingEvents();
                    updateStatistics();
                })
                .catch((error) => {
                    console.error('Error adding event: ', error);
                    showNotification('Error adding event', 'error');
                });
        }

        function updateEvent(eventId, eventData) {
            showNotification('Updating event...', 'info');
            
            db.collection('events').doc(eventId).update(eventData)
                .then(() => {
                    console.log('Event updated successfully');
                    const event = calendar.getEventById(eventId);
                    if (event) {
                        event.remove();
                    }
                    
                    calendar.addEvent({
                        id: eventId,
                        ...eventData
                    });
                    
                    showNotification('Event updated successfully!', 'success');
                    updateUpcomingEvents();
                    updateStatistics();
                })
                .catch((error) => {
                    console.error('Error updating event: ', error);
                    showNotification('Error updating event', 'error');
                });
        }

        function deleteEvent(eventId) {
            if (confirm('Are you sure you want to delete this event?')) {
                showNotification('Deleting event...', 'info');
                
                db.collection('events').doc(eventId).delete()
                    .then(() => {
                        console.log('Event deleted successfully');
                        const event = calendar.getEventById(eventId);
                        if (event) {
                            event.remove();
                        }
                        closeModal('eventModal');
                        showNotification('Event deleted successfully!', 'success');
                        updateUpcomingEvents();
                        updateStatistics();
                    })
                    .catch((error) => {
                        console.error('Error deleting event: ', error);
                        showNotification('Error deleting event', 'error');
                    });
            }
        }

        function loadEvents() {
            showNotification('Loading events...', 'info');
            
            // Clear existing events
            calendar.removeAllEvents();
            
            db.collection('events').get()
                .then((querySnapshot) => {
                    let count = 0;
                    querySnapshot.forEach((doc) => {
                        const eventData = doc.data();
                        calendar.addEvent({
                            id: doc.id,
                            ...eventData
                        });
                        count++;
                    });
                    
                    if (count > 0) {
                        showNotification(`Loaded ${count} events successfully!`, 'success');
                    } else {
                        showNotification('No events found. Create your first event!', 'info');
                    }
                    
                    updateUpcomingEvents();
                    updateStatistics();
                })
                .catch((error) => {
                    console.error('Error loading events: ', error);
                    showNotification('Error loading events', 'error');
                });
        }

        function updateUpcomingEvents() {
            const upcomingList = document.getElementById('upcoming-events-list');
            upcomingList.innerHTML = '';
            
            const now = new Date();
            const events = calendar.getEvents();
            
            // Sort events by start date
            const upcomingEvents = events
                .filter(event => new Date(event.start) >= now)
                .sort((a, b) => new Date(a.start) - new Date(b.start))
                .slice(0, 5); // Get only the next 5 events
            
            if (upcomingEvents.length === 0) {
                upcomingList.innerHTML = '<div class="event-card"><div class="event-card-title">No upcoming events</div></div>';
                return;
            }
            
            upcomingEvents.forEach(event => {
                const eventDate = new Date(event.start);
                let dateText;
                
                // Format the date text
                const today = new Date();
                const tomorrow = new Date(today);
                tomorrow.setDate(tomorrow.getDate() + 1);
                
                if (eventDate.toDateString() === today.toDateString()) {
                    dateText = 'Today';
                } else if (eventDate.toDateString() === tomorrow.toDateString()) {
                    dateText = 'Tomorrow';
                } else {
                    const options = { weekday: 'long' };
                    dateText = new Intl.DateTimeFormat('en-US', options).format(eventDate);
                }
                
                // Format the time
                const timeText = eventDate.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
                
                const eventCard = document.createElement('div');
                eventCard.className = 'event-card';
                eventCard.style.borderLeftColor = event.backgroundColor;
                eventCard.innerHTML = `
                    <div class="event-card-title">${event.title}</div>
                    <div class="event-card-time"><i class="far fa-clock"></i> ${dateText}, ${timeText}</div>
                `;
                
                eventCard.addEventListener('click', () => {
                    openModal(event.startStr, event.endStr, event);
                });
                
                upcomingList.appendChild(eventCard);
            });
        }

        function updateStatistics() {
            const events = calendar.getEvents();
            const now = new Date();
            const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);
            const monthEnd = new Date(now.getFullYear(), now.getMonth() + 1, 0);
            
            // Total events
            document.getElementById('total-events').textContent = events.length;
            
            // Upcoming events
            const upcomingCount = events.filter(event => new Date(event.start) >= now).length;
            document.getElementById('upcoming-events').textContent = upcomingCount;
            
            // This month events
            const thisMonthCount = events.filter(event => {
                const eventDate = new Date(event.start);
                return eventDate >= monthStart && eventDate <= monthEnd;
            }).length;
            document.getElementById('this-month').textContent = thisMonthCount;
            
            // Completed events
            const completedCount = events.filter(event => new Date(event.end) < now).length;
            document.getElementById('completed-events').textContent = completedCount;
        }

        function filterEventsByColor(color) {
            const events = calendar.getEvents();
            events.forEach(event => {
                if (event.backgroundColor === color) {
                    event.setProp('display', event.display === 'none' ? 'auto' : 'none');
                }
            });
        }

        function printCalendar() {
            showNotification('Preparing to print...', 'info');
            setTimeout(() => {
                window.print();
            }, 500);
        }

        function saveAsImage() {
            showNotification('Preparing image...', 'info');
            
            html2canvas(document.querySelector("#calendar")).then(canvas => {
                let link = document.createElement('a');
                link.download = 'SILAKBO_calendar.png';
                link.href = canvas.toDataURL();
                link.click();
                showNotification('Image saved successfully!', 'success');
            }).catch(err => {
                console.error('Error saving image:', err);
                showNotification('Error saving image', 'error');
            });
        }

        function exportEvents() {
            const format = document.getElementById('exportFormat').value;
            const dateRange = document.getElementById('exportDateRange').value;
            
            let events = calendar.getEvents();
            const now = new Date();
            
            // Filter events based on date range
            if (dateRange === 'future') {
                events = events.filter(event => new Date(event.start) >= now);
            } else if (dateRange === 'past') {
                events = events.filter(event => new Date(event.end) < now);
            } else if (dateRange === 'month') {
                const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);
                const monthEnd = new Date(now.getFullYear(), now.getMonth() + 1, 0);
                events = events.filter(event => {
                    const eventDate = new Date(event.start);
                    return eventDate >= monthStart && eventDate <= monthEnd;
                });
            } else if (dateRange === 'custom') {
                const startDate = new Date(document.getElementById('exportStartDate').value);
                const endDate = new Date(document.getElementById('exportEndDate').value);
                events = events.filter(event => {
                    const eventDate = new Date(event.start);
                    return eventDate >= startDate && eventDate <= endDate;
                });
            }
            
            // Convert events to the selected format
            let data;
            let fileName;
            let mimeType;
            
            if (format === 'json') {
                data = JSON.stringify(events.map(event => ({
                    id: event.id,
                    title: event.title,
                    start: event.startStr,
                    end: event.endStr,
                    backgroundColor: event.backgroundColor,
                    description: event.extendedProps.description,
                    location: event.extendedProps.location,
                    reminder: event.extendedProps.reminder,
                    category: event.extendedProps.category,
                    priority: event.extendedProps.priority
                })), null, 2);
                fileName = 'silakbo_events.json';
                mimeType = 'application/json';
            } else if (format === 'csv') {
                const headers = ['Title', 'Start', 'End', 'Color', 'Description', 'Location', 'Reminder', 'Category', 'Priority'];
                const rows = events.map(event => [
                    event.title,
                    event.startStr,
                    event.endStr,
                    event.backgroundColor,
                    event.extendedProps.description || '',
                    event.extendedProps.location || '',
                    event.extendedProps.reminder || '',
                    event.extendedProps.category || '',
                    event.extendedProps.priority || ''
                ]);
                
                data = [headers, ...rows].map(row => row.join(',')).join('\n');
                fileName = 'silakbo_events.csv';
                mimeType = 'text/csv';
            } else if (format === 'ical') {
                // Simple iCalendar format
                let icalData = [
                    'BEGIN:VCALENDAR',
                    'VERSION:2.0',
                    'PRODID:-//SILAKBO//Calendar//EN'
                ];
                
                events.forEach(event => {
                    const startDate = new Date(event.start);
                    const endDate = new Date(event.end || event.start);
                    
                    // Format dates for iCal
                    const formatDate = (date) => {
                        return date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
                    };
                    
                    icalData = [
                        ...icalData,
                        'BEGIN:VEVENT',
                        `UID:${event.id}`,
                        `DTSTAMP:${formatDate(new Date())}`,
                        `DTSTART:${formatDate(startDate)}`,
                        `DTEND:${formatDate(endDate)}`,
                        `SUMMARY:${event.title}`,
                        `DESCRIPTION:${event.extendedProps.description || ''}`,
                        `LOCATION:${event.extendedProps.location || ''}`,
                        'END:VEVENT'
                    ];
                });
                
                icalData.push('END:VCALENDAR');
                data = icalData.join('\r\n');
                fileName = 'silakbo_events.ics';
                mimeType = 'text/calendar';
            }
            
            // Create and trigger download
            const blob = new Blob([data], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = fileName;
            link.click();
            
            showNotification(`Exported ${events.length} events successfully!`, 'success');
        }

        function importEvents() {
            const fileInput = document.getElementById('importFile');
            const importOption = document.getElementById('importOptions').value;
            
            if (!fileInput.files || fileInput.files.length === 0) {
                showNotification('Please select a file to import', 'warning');
                return;
            }
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    let events = [];
                    
                    if (file.name.endsWith('.json')) {
                        events = JSON.parse(e.target.result);
                    } else if (file.name.endsWith('.csv')) {
                        const lines = e.target.result.split('\n');
                        const headers = lines[0].split(',');
                        
                        for (let i = 1; i < lines.length; i++) {
                            if (!lines[i].trim()) continue;
                            
                            const values = lines[i].split(',');
                            const event = {
                                title: values[0],
                                start: values[1],
                                end: values[2],
                                backgroundColor: values[3],
                                description: values[4],
                                location: values[5],
                                reminder: values[6],
                                category: values[7],
                                priority: values[8]
                            };
                            events.push(event);
                        }
                    } else if (file.name.endsWith('.ics')) {
                        // Simple iCal parser
                        const lines = e.target.result.split(/\r\n|\n|\r/);
                        let currentEvent = null;
                        
                        for (let i = 0; i < lines.length; i++) {
                            const line = lines[i];
                            
                            if (line === 'BEGIN:VEVENT') {
                                currentEvent = {};
                            } else if (line === 'END:VEVENT' && currentEvent) {
                                events.push(currentEvent);
                                currentEvent = null;
                            } else if (currentEvent) {
                                const [key, value] = line.split(':');
                                
                                if (key === 'SUMMARY') {
                                    currentEvent.title = value;
                                } else if (key === 'DTSTART') {
                                    currentEvent.start = formatICalDate(value);
                                } else if (key === 'DTEND') {
                                    currentEvent.end = formatICalDate(value);
                                } else if (key === 'DESCRIPTION') {
                                    currentEvent.description = value;
                                } else if (key === 'LOCATION') {
                                    currentEvent.location = value;
                                }
                            }
                        }
                    }
                    
                    if (events.length === 0) {
                        showNotification('No events found in the file', 'warning');
                        return;
                    }
                    
                    // Clear existing events if replace option is selected
                    if (importOption === 'replace') {
                        if (confirm(`Are you sure you want to replace all existing events with ${events.length} imported events?`)) {
                            // Remove all events from calendar
                            calendar.removeAllEvents();
                            
                            // Remove all events from database
                            db.collection('events').get().then((querySnapshot) => {
                                const batch = db.batch();
                                querySnapshot.forEach((doc) => {
                                    batch.delete(doc.ref);
                                });
                                return batch.commit();
                            }).then(() => {
                                importEventsToDatabase(events);
                            });
                        }
                    } else {
                        importEventsToDatabase(events);
                    }
                } catch (error) {
                    console.error('Error importing events:', error);
                    showNotification('Error importing events: ' + error.message, 'error');
                }
            };
            
            if (file.name.endsWith('.json') || file.name.endsWith('.ics')) {
                reader.readAsText(file);
            } else if (file.name.endsWith('.csv')) {
                reader.readAsText(file);
            } else {
                showNotification('Unsupported file format. Please use JSON, CSV, or ICS files.', 'warning');
            }
        }

        function importEventsToDatabase(events) {
            showNotification(`Importing ${events.length} events...`, 'info');
            
            let successCount = 0;
            let errorCount = 0;
            
            events.forEach((event, index) => {
                setTimeout(() => {
                    db.collection('events').add(event)
                        .then((docRef) => {
                            calendar.addEvent({
                                id: docRef.id,
                                ...event
                            });
                            successCount++;
                            
                            if (successCount + errorCount === events.length) {
                                showNotification(`Imported ${successCount} events successfully!`, 'success');
                                updateUpcomingEvents();
                                updateStatistics();
                            }
                        })
                        .catch((error) => {
                            console.error('Error importing event:', error);
                            errorCount++;
                            
                            if (successCount + errorCount === events.length) {
                                if (errorCount > 0) {
                                    showNotification(`Imported ${successCount} events with ${errorCount} errors.`, 'warning');
                                } else {
                                    showNotification(`Imported ${successCount} events successfully!`, 'success');
                                }
                                updateUpcomingEvents();
                                updateStatistics();
                            }
                        });
                }, index * 100); // Stagger imports to avoid overwhelming the database
            });
        }

        function formatICalDate(dateStr) {
            // Format: 20210101T120000Z
            const year = dateStr.substr(0, 4);
            const month = dateStr.substr(4, 2);
            const day = dateStr.substr(6, 2);
            const hour = dateStr.substr(9, 2);
            const minute = dateStr.substr(11, 2);
            const second = dateStr.substr(13, 2);
            
            return `${year}-${month}-${day}T${hour}:${minute}:${second}Z`;
        }

        function fetchQuote() {
            const quoteWidget = document.getElementById('quote-widget');
            
            // Simulate loading with animation
            setTimeout(() => {
                if (quoteWidget) {
                    quoteWidget.querySelector('.quote-content').innerHTML = `
                        <div class="quote-text">"What would life be if we had no courage to attempt anything? The sadness will last forever—but so will the beauty, the wonder, and the love that we leave behind. Even in the darkest moments, there is light if we choose to see it. Keep going, keep creating, and never stop believing that something inside you is worth sharing with the world."</div>
                        <div class="quote-author">- Vincent Van Gogh</div>
                    `;
                } else {
                    console.error('Quote widget element not found');
                }
            }, 1500);
        }

        function getContrastColor(hexcolor) {
            if (!hexcolor) return 'black';
            
            // Handle rgba format
            if (hexcolor.startsWith('rgba') || hexcolor.startsWith('rgb')) {
                const rgbMatch = hexcolor.match(/\d+/g);
                if (rgbMatch && rgbMatch.length >= 3) {
                    const r = parseInt(rgbMatch[0]);
                    const g = parseInt(rgbMatch[1]);
                    const b = parseInt(rgbMatch[2]);
                    const yiq = ((r*299)+(g*587)+(b*114))/1000;
                    return (yiq >= 128) ? 'black' : 'white';
                }
                return 'black';
            }
            
            // Handle hex format
            hexcolor = hexcolor.replace("#", "");
            var r = parseInt(hexcolor.substr(0,2),16);
            var g = parseInt(hexcolor.substr(2,2),16);
            var b = parseInt(hexcolor.substr(4,2),16);
            var yiq = ((r*299)+(g*587)+(b*114))/1000;
            return (yiq >= 128) ? 'black' : 'white';
        }

        // Notification system
        function showNotification(message, type = 'info') {
            // Create notification container if it doesn't exist
            let container = document.getElementById('notification-container');
            if (!container) {
                container = document.createElement('div');
                container.id = 'notification-container';
                document.body.appendChild(container);
            }
            
            // Create notification
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            
            // Set type-specific styles and icon
            let icon = '';
            if (type === 'success') {
                icon = '<i class="fas fa-check-circle"></i>';
            } else if (type === 'error') {
                icon = '<i class="fas fa-exclamation-circle"></i>';
            } else if (type === 'warning') {
                icon = '<i class="fas fa-exclamation-triangle"></i>';
            } else {
                icon = '<i class="fas fa-info-circle"></i>';
            }
            
            notification.innerHTML = `${icon} <span>${message}</span>`;
            container.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            
            // Auto remove after delay
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>
