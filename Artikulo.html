<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ANG SILAKBO â€¢ The Official Publication of UCLM-SHS</title>
<link rel="icon" href="SILAKBO (1).png">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<!-- Typography -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;0,800;0,900;1,400;1,500;1,600;1,700&family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400;1,700&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
<!-- Google Material Icons -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
<style>
    :root {
        /* Light theme colors */
        --primary: #121212;
        --primary-light: #2A2A2A;
        --secondary: #FF6B00;
        --secondary-light: #FF8A3D;
        --secondary-dark: #E05A00;
        --text-dark: #121212;
        --text-light: #5F5F5F;
        --text-muted: #9E9E9E;
        --background: #FFFFFF;
        --surface: #FFFFFF;
        --surface-elevated: #F8F9FA;
        --border: #E5E7EB;
        --border-light: #F3F4F6;
        --shadow: rgba(0, 0, 0, 0.06);
        --shadow-hover: rgba(0, 0, 0, 0.1);
        --shadow-strong: rgba(0, 0, 0, 0.12);
        
        /* Typography */
        --headline-font: 'Playfair Display', serif;
        --body-font: 'Source Sans Pro', sans-serif;
        --article-font: 'Merriweather', serif;
        
        /* Spacing and sizing */
        --radius-sm: 8px;
        --radius-md: 12px;
        --radius-lg: 16px;
        --radius-xl: 24px;
        --radius-2xl: 32px;
        --spacing-xs: 0.5rem;
        --spacing-sm: 1rem;
        --spacing-md: 1.5rem;
        --spacing-lg: 2rem;
        --spacing-xl: 3rem;
        --spacing-2xl: 4rem;
        
        /* Transitions */
        --transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
        --transition-fast: all 0.15s cubic-bezier(0.4, 0.0, 0.2, 1);
    }

    [data-theme="dark"] {
        --primary: #FFFFFF;
        --primary-light: #F5F5F5;
        --text-dark: #FFFFFF;
        --text-light: #B0B0B0;
        --text-muted: #6B7280;
        --background: #0F172A;
        --surface: #1E293B;
        --surface-elevated: #334155;
        --border: #374151;
        --border-light: #4B5563;
        --shadow: rgba(0, 0, 0, 0.3);
        --shadow-hover: rgba(0, 0, 0, 0.4);
        --shadow-strong: rgba(0, 0, 0, 0.5);
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: var(--body-font);
        background-color: var(--background);
        color: var(--text-dark);
        line-height: 1.6;
        transition: var(--transition);
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
        width: 6px;
    }

    ::-webkit-scrollbar-track {
        background: var(--surface);
    }

    ::-webkit-scrollbar-thumb {
        background: var(--border);
        border-radius: var(--radius-sm);
    }

    ::-webkit-scrollbar-thumb:hover {
        background: var(--text-muted);
    }

    /* Header */
    .header {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid var(--border);
        position: sticky;
        top: 0;
        z-index: 100;
        transition: var(--transition);
    }

    [data-theme="dark"] .header {
        background: rgba(15, 23, 42, 0.95);
    }

    .header-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: var(--spacing-md) var(--spacing-lg);
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .logo {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        text-decoration: none;
        color: var(--text-dark);
    }

    .logo-img {
        width: 40px;
        height: 40px;
        border-radius: var(--radius-md);
        object-fit: cover;
    }

    .logo-text {
        font-family: var(--headline-font);
        font-size: 1.5rem;
        font-weight: 800;
        color: var(--secondary);
    }

    .nav {
        display: flex;
        align-items: center;
        gap: var(--spacing-lg);
    }

    .nav-links {
        display: flex;
        gap: var(--spacing-lg);
        list-style: none;
    }

    .nav-link {
        color: var(--text-light);
        text-decoration: none;
        font-weight: 500;
        padding: var(--spacing-xs) var(--spacing-sm);
        border-radius: var(--radius-md);
        transition: var(--transition);
        position: relative;
    }

    .nav-link:hover,
    .nav-link.active {
        color: var(--secondary);
        background: rgba(255, 107, 0, 0.1);
    }

    .header-actions {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
    }

    .icon-btn {
        background: none;
        border: none;
        color: var(--text-light);
        cursor: pointer;
        padding: var(--spacing-xs);
        border-radius: var(--radius-md);
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .icon-btn:hover {
        color: var(--secondary);
        background: var(--surface-elevated);
    }

    .theme-toggle {
        background: var(--surface-elevated);
        border: 1px solid var(--border);
        color: var(--text-dark);
        padding: var(--spacing-xs);
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: var(--transition);
    }

    .theme-toggle:hover {
        background: var(--secondary);
        color: white;
        border-color: var(--secondary);
    }

    .mobile-menu-btn {
        display: none;
    }

    /* Main Content */
    .main {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 var(--spacing-lg);
    }

    /* Hero Section - Magazine Style */
    .hero-section {
        padding: var(--spacing-2xl) 0;
        margin-bottom: var(--spacing-2xl);
    }

    .hero-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--spacing-2xl);
        height: 600px;
    }

    .hero-main {
        position: relative;
        border-radius: var(--radius-2xl);
        overflow: hidden;
        cursor: pointer;
        transition: var(--transition);
        background: linear-gradient(135deg, var(--surface) 0%, var(--surface-elevated) 100%);
        box-shadow: 0 8px 32px var(--shadow);
    }

    .hero-main:hover {
        transform: translateY(-8px);
        box-shadow: 0 16px 48px var(--shadow-hover);
    }

    .hero-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: var(--transition);
    }

    .hero-main:hover .hero-image {
        transform: scale(1.05);
    }

    .hero-overlay {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
        padding: var(--spacing-2xl);
        color: white;
    }

    .hero-category {
        display: inline-block;
        background: var(--secondary);
        color: white;
        padding: var(--spacing-xs) var(--spacing-md);
        border-radius: var(--radius-lg);
        font-size: 0.8rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: var(--spacing-md);
    }

    .hero-title {
        font-family: var(--headline-font);
        font-size: 2.5rem;
        font-weight: 700;
        line-height: 1.2;
        margin-bottom: var(--spacing-md);
    }

    .hero-excerpt {
        font-size: 1.1rem;
        line-height: 1.6;
        opacity: 0.9;
        margin-bottom: var(--spacing-md);
    }

    .hero-meta {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        font-size: 0.9rem;
        opacity: 0.8;
    }

    .meta-item {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
    }

    .meta-item .material-icons {
        font-size: 16px;
    }

    .hero-secondary {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-lg);
    }

    .secondary-story {
        display: flex;
        gap: var(--spacing-md);
        background: var(--surface);
        border-radius: var(--radius-xl);
        padding: var(--spacing-md);
        cursor: pointer;
        transition: var(--transition);
        border: 1px solid var(--border-light);
        box-shadow: 0 4px 16px var(--shadow);
    }

    .secondary-story:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 24px var(--shadow-hover);
    }

    .secondary-image {
        width: 120px;
        height: 120px;
        border-radius: var(--radius-lg);
        object-fit: cover;
        flex-shrink: 0;
    }

    .secondary-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }

    .secondary-category {
        color: var(--secondary);
        font-size: 0.8rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: var(--spacing-xs);
    }

    .secondary-title {
        font-family: var(--headline-font);
        font-size: 1.1rem;
        font-weight: 600;
        line-height: 1.3;
        color: var(--text-dark);
        margin-bottom: var(--spacing-xs);
    }

    .secondary-meta {
        color: var(--text-muted);
        font-size: 0.8rem;
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
    }

    /* Featured Stories Section */
    .featured-section {
        margin-bottom: var(--spacing-2xl);
    }

    .section-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--spacing-xl);
    }

    .section-title {
        font-family: var(--headline-font);
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--text-dark);
        position: relative;
    }

    .section-title::after {
        content: '';
        position: absolute;
        bottom: -8px;
        left: 0;
        width: 60px;
        height: 4px;
        background: var(--secondary);
        border-radius: var(--radius-sm);
    }

    .view-all-btn {
        color: var(--secondary);
        text-decoration: none;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
        transition: var(--transition);
    }

    .view-all-btn:hover {
        transform: translateX(4px);
    }

    /* Magazine Grid Layout */
    .magazine-grid {
        display: grid;
        grid-template-columns: 2fr 1fr 1fr;
        grid-template-rows: 1fr 1fr;
        gap: var(--spacing-lg);
        height: 500px;
        margin-bottom: var(--spacing-2xl);
    }

    .magazine-card {
        position: relative;
        border-radius: var(--radius-xl);
        overflow: hidden;
        cursor: pointer;
        transition: var(--transition);
        background: var(--surface);
        box-shadow: 0 4px 20px var(--shadow);
    }

    .magazine-card:hover {
        transform: translateY(-6px);
        box-shadow: 0 12px 32px var(--shadow-hover);
    }

    .magazine-card.large {
        grid-row: 1 / 3;
    }

    .magazine-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: var(--transition);
    }

    .magazine-card:hover .magazine-image {
        transform: scale(1.05);
    }

    .magazine-overlay {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
        padding: var(--spacing-lg);
        color: white;
    }

    .magazine-card.large .magazine-overlay {
        padding: var(--spacing-xl);
    }

    .magazine-category {
        display: inline-block;
        background: var(--secondary);
        color: white;
        padding: var(--spacing-xs) var(--spacing-sm);
        border-radius: var(--radius-md);
        font-size: 0.7rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: var(--spacing-sm);
    }

    .magazine-title {
        font-family: var(--headline-font);
        font-weight: 600;
        line-height: 1.3;
        margin-bottom: var(--spacing-xs);
    }

    .magazine-card.large .magazine-title {
        font-size: 1.8rem;
        margin-bottom: var(--spacing-sm);
    }

    .magazine-card:not(.large) .magazine-title {
        font-size: 1rem;
    }

    .magazine-meta {
        font-size: 0.8rem;
        opacity: 0.8;
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
    }

    /* Latest Stories - Modern Layout */
    .latest-section {
        margin-bottom: var(--spacing-2xl);
    }

    .stories-masonry {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: var(--spacing-xl);
        margin-bottom: var(--spacing-xl);
    }

    .story-card {
        background: var(--surface);
        border-radius: var(--radius-xl);
        overflow: hidden;
        cursor: pointer;
        transition: var(--transition);
        border: 1px solid var(--border-light);
        box-shadow: 0 4px 20px var(--shadow);
        height: fit-content;
    }

    .story-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 12px 32px var(--shadow-hover);
    }

    .story-image-container {
        position: relative;
        overflow: hidden;
        height: 240px;
    }

    .story-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: var(--transition);
    }

    .story-card:hover .story-image {
        transform: scale(1.05);
    }

    .story-content {
        padding: var(--spacing-xl);
    }

    .story-category {
        display: inline-block;
        background: var(--secondary);
        color: white;
        padding: var(--spacing-xs) var(--spacing-md);
        border-radius: var(--radius-lg);
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: var(--spacing-md);
    }

    .story-title {
        font-family: var(--headline-font);
        font-size: 1.4rem;
        font-weight: 600;
        line-height: 1.3;
        color: var(--text-dark);
        margin-bottom: var(--spacing-md);
    }

    .story-excerpt {
        color: var(--text-light);
        line-height: 1.6;
        margin-bottom: var(--spacing-lg);
    }

    .story-meta {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding-top: var(--spacing-md);
        border-top: 1px solid var(--border-light);
        color: var(--text-muted);
        font-size: 0.9rem;
    }

    .story-author {
        font-weight: 600;
        color: var(--text-dark);
    }

    .story-date {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
    }

    /* Load More */
    .load-more {
        text-align: center;
        margin: var(--spacing-2xl) 0;
    }

    .load-more-btn {
        background: var(--surface);
        color: var(--secondary);
        border: 2px solid var(--secondary);
        padding: var(--spacing-md) var(--spacing-xl);
        border-radius: var(--radius-xl);
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        display: inline-flex;
        align-items: center;
        gap: var(--spacing-sm);
        font-size: 1rem;
    }

    .load-more-btn:hover {
        background: var(--secondary);
        color: white;
        transform: translateY(-4px);
        box-shadow: 0 8px 24px rgba(255, 107, 0, 0.3);
    }

    /* Footer */
    .footer {
        background: var(--surface);
        border-top: 1px solid var(--border);
        padding: var(--spacing-xl) 0;
        margin-top: var(--spacing-2xl);
    }

    .footer-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 var(--spacing-lg);
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .footer-logo {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
    }

    .footer-logo-img {
        width: 32px;
        height: 32px;
        border-radius: var(--radius-md);
    }

    .footer-logo-text {
        font-family: var(--headline-font);
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--secondary);
    }

    .footer-links {
        display: flex;
        gap: var(--spacing-lg);
    }

    .footer-link {
        color: var(--text-light);
        text-decoration: none;
        font-size: 0.9rem;
        transition: var(--transition);
    }

    .footer-link:hover {
        color: var(--secondary);
    }

    .footer-social {
        display: flex;
        gap: var(--spacing-sm);
    }

    .social-link {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background: var(--surface-elevated);
        border: 1px solid var(--border);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--text-light);
        transition: var(--transition);
    }

    .social-link:hover {
        background: var(--secondary);
        color: white;
        transform: translateY(-2px);
    }

    /* Search Overlay */
    .search-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        z-index: 1000;
        display: none;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transition: var(--transition);
    }

    .search-overlay.active {
        display: flex;
        opacity: 1;
    }

    .search-container {
        background: var(--surface);
        border-radius: var(--radius-2xl);
        padding: var(--spacing-2xl);
        width: 90%;
        max-width: 600px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .search-input {
        width: 100%;
        padding: var(--spacing-lg);
        border: 2px solid var(--border);
        border-radius: var(--radius-xl);
        background: var(--surface-elevated);
        color: var(--text-dark);
        font-size: 1.2rem;
        font-family: var(--body-font);
        transition: var(--transition);
    }

    .search-input:focus {
        outline: none;
        border-color: var(--secondary);
        box-shadow: 0 0 0 4px rgba(255, 107, 0, 0.1);
    }

    .search-close {
        position: absolute;
        top: var(--spacing-lg);
        right: var(--spacing-lg);
        background: var(--surface);
        border: none;
        color: var(--text-dark);
        width: 50px;
        height: 50px;
        border-radius: 50%;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 16px var(--shadow);
    }

    .search-close:hover {
        background: var(--secondary);
        color: white;
        transform: rotate(90deg);
    }

    /* Article Modal */
    .modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        backdrop-filter: blur(10px);
        z-index: 2000;
        display: none;
        opacity: 0;
        transition: var(--transition);
    }

    .modal.active {
        display: block;
        opacity: 1;
    }

    .modal-content {
        background: var(--background);
        width: 100%;
        height: 100%;
        overflow-y: auto;
        position: relative;
    }

    .modal-header {
        background: var(--surface);
        border-bottom: 1px solid var(--border);
        padding: var(--spacing-md) var(--spacing-lg);
        position: sticky;
        top: 0;
        z-index: 10;
        backdrop-filter: blur(10px);
    }

    .modal-close {
        position: fixed;
        top: var(--spacing-lg);
        right: var(--spacing-lg);
        background: var(--surface);
        border: none;
        color: var(--text-dark);
        width: 50px;
        height: 50px;
        border-radius: 50%;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2001;
        box-shadow: 0 4px 20px var(--shadow);
    }

    .modal-close:hover {
        background: var(--secondary);
        color: white;
        transform: rotate(90deg);
    }

    .article-container {
        max-width: 800px;
        margin: 0 auto;
        padding: var(--spacing-2xl);
    }

    .article-header {
        margin-bottom: var(--spacing-2xl);
        text-align: center;
    }

    .article-title {
        font-family: var(--headline-font);
        font-size: 3rem;
        font-weight: 700;
        line-height: 1.2;
        margin-bottom: var(--spacing-md);
        color: var(--text-dark);
    }

    .article-meta {
        display: flex;
        justify-content: center;
        gap: var(--spacing-lg);
        color: var(--text-muted);
        margin-bottom: var(--spacing-lg);
    }

    .article-cover {
        width: 100%;
        max-height: 500px;
        object-fit: cover;
        border-radius: var(--radius-2xl);
        margin-bottom: var(--spacing-2xl);
    }

    .article-content {
        font-family: var(--article-font);
        font-size: 1.1rem;
        line-height: 1.8;
        color: var(--text-dark);
    }

    .article-content p {
        margin-bottom: var(--spacing-md);
    }

    .article-content h2 {
        font-family: var(--headline-font);
        font-size: 2rem;
        font-weight: 600;
        margin: var(--spacing-2xl) 0 var(--spacing-md);
        color: var(--text-dark);
    }

    .article-content h3 {
        font-family: var(--headline-font);
        font-size: 1.5rem;
        font-weight: 600;
        margin: var(--spacing-xl) 0 var(--spacing-sm);
        color: var(--text-dark);
    }

    /* Drop cap for first paragraph */
    .article-content > p:first-of-type::first-letter {
        font-family: var(--headline-font);
        float: left;
        font-size: 4rem;
        line-height: 0.8;
        padding-right: var(--spacing-sm);
        margin-top: 0.2rem;
        color: var(--secondary);
        font-weight: 700;
    }

    /* Share Actions */
    .article-actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: var(--spacing-2xl);
        padding-top: var(--spacing-lg);
        border-top: 1px solid var(--border);
    }

    .share-options {
        display: flex;
        gap: var(--spacing-sm);
    }

    .share-btn {
        background: var(--surface-elevated);
        border: 1px solid var(--border);
        color: var(--text-light);
        width: 50px;
        height: 50px;
        border-radius: 50%;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .share-btn:hover {
        background: var(--secondary);
        color: white;
        border-color: var(--secondary);
        transform: translateY(-2px);
    }

    /* Toast */
    .toast {
        position: fixed;
        bottom: var(--spacing-lg);
        left: 50%;
        transform: translateX(-50%) translateY(100px);
        background: var(--text-dark);
        color: var(--background);
        padding: var(--spacing-sm) var(--spacing-lg);
        border-radius: var(--radius-xl);
        font-weight: 500;
        z-index: 3000;
        opacity: 0;
        transition: var(--transition);
        box-shadow: 0 8px 32px var(--shadow-strong);
    }

    .toast.show {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
    }

    /* Skeleton Loading */
    .skeleton {
        background: linear-gradient(90deg, var(--surface-elevated) 0%, var(--border-light) 50%, var(--surface-elevated) 100%);
        background-size: 200% 100%;
        animation: skeleton-loading 1.5s infinite;
        border-radius: var(--radius-md);
    }

    @keyframes skeleton-loading {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
    }

    /* Reading Progress */
    .reading-progress {
        position: fixed;
        top: 0;
        left: 0;
        width: 0;
        height: 3px;
        background: var(--secondary);
        z-index: 1001;
        transition: width 0.1s ease;
    }

    /* Mobile Responsive */
    @media (max-width: 1024px) {
        .hero-grid {
            grid-template-columns: 1fr;
            height: auto;
        }

        .hero-main {
            height: 400px;
        }

        .magazine-grid {
            grid-template-columns: 1fr 1fr;
            height: auto;
        }

        .magazine-card.large {
            grid-column: 1 / -1;
            height: 300px;
        }

        .stories-masonry {
            grid-template-columns: repeat(2, 1fr);
        }

        .footer-container {
            flex-direction: column;
            gap: var(--spacing-lg);
            text-align: center;
        }

        .footer-logo {
            justify-content: center;
        }

        .footer-social {
            justify-content: center;
        }
    }

    @media (max-width: 768px) {
        .header-container {
            padding: var(--spacing-sm) var(--spacing-md);
        }

        .nav-links {
            display: none;
        }

        .mobile-menu-btn {
            display: block;
        }

        .main {
            padding: 0 var(--spacing-md);
        }

        .hero-section {
            padding: var(--spacing-xl) 0;
        }

        .hero-secondary {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--spacing-md);
        }

        .secondary-story {
            flex-direction: column;
        }

        .secondary-image {
            width: 100%;
            height: 200px;
        }

        .magazine-grid {
            grid-template-columns: 1fr;
            gap: var(--spacing-md);
        }

        .magazine-card.large {
            grid-column: 1;
            height: 250px;
        }

        .stories-masonry {
            grid-template-columns: 1fr;
        }

        .section-title {
            font-size: 2rem;
        }

        .hero-title {
            font-size: 2rem;
        }

        .article-title {
            font-size: 2rem;
        }

        .article-meta {
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .article-actions {
            flex-direction: column;
            gap: var(--spacing-md);
            align-items: stretch;
        }

        .share-options {
            justify-content: center;
        }

        .footer-links {
            flex-direction: column;
            gap: var(--spacing-md);
        }
    }

    @media (max-width: 480px) {
        .main {
            padding: 0 var(--spacing-sm);
        }

        .hero-overlay,
        .magazine-overlay {
            padding: var(--spacing-md);
        }

        .story-content {
            padding: var(--spacing-md);
        }

        .article-container {
            padding: var(--spacing-md);
        }

        .search-container {
            padding: var(--spacing-lg);
        }
    }

    /* Mobile Menu */
    .mobile-menu {
        position: fixed;
        top: 0;
        left: -100%;
        width: 280px;
        height: 100%;
        background: var(--surface);
        z-index: 1500;
        padding: var(--spacing-xl) var(--spacing-lg);
        transition: var(--transition);
        box-shadow: 0 0 30px var(--shadow);
    }

    .mobile-menu.active {
        left: 0;
    }

    .mobile-menu-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--spacing-xl);
        padding-bottom: var(--spacing-lg);
        border-bottom: 1px solid var(--border);
    }

    .mobile-nav-links {
        list-style: none;
    }

    .mobile-nav-links li {
        margin-bottom: var(--spacing-sm);
    }

    .mobile-nav-links a {
        color: var(--text-dark);
        text-decoration: none;
        font-weight: 500;
        padding: var(--spacing-sm);
        border-radius: var(--radius-md);
        display: block;
        transition: var(--transition);
    }

    .mobile-nav-links a:hover,
    .mobile-nav-links a.active {
        background: rgba(255, 107, 0, 0.1);
        color: var(--secondary);
    }

    .mobile-menu-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1400;
        opacity: 0;
        visibility: hidden;
        transition: var(--transition);
    }

    .mobile-menu-overlay.active {
        opacity: 1;
        visibility: visible;
    }
</style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-container">
            <a href="#" class="logo">
                <img src="SILAKBO.png" alt="Silakbo Logo" class="logo-img" onerror="this.src='https://via.placeholder.com/40x40?text=S'">
                <span class="logo-text">ANG SILAKBO</span>
            </a>

            <nav class="nav">
                <ul class="nav-links">
                    <li><a href="#" class="nav-link active" data-filter="all">All Stories</a></li>
                    <li><a href="#" class="nav-link" data-filter="article">Articles</a></li>
                    <li><a href="#" class="nav-link" data-filter="literary">Literary</a></li>
                    <li><a href="#" class="nav-link" data-filter="feature">Feature</a></li>
                    <li><a href="#" class="nav-link" data-filter="silak">Silak-salitaan</a></li>
                    <li><a href="#" class="nav-link" data-filter="photostory">Photostory</a></li>
                </ul>
            </nav>

            <div class="header-actions">
                <button class="icon-btn" id="searchBtn">
                    <i class="material-icons">search</i>
                </button>
                <button class="theme-toggle" id="themeToggle">
                    <i class="material-icons">dark_mode</i>
                </button>
                <button class="icon-btn mobile-menu-btn" id="mobileMenuBtn">
                    <i class="material-icons">menu</i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Hero Section -->
        <section class="hero-section">
            <div class="hero-grid" id="heroGrid">
                <!-- Hero Main Skeleton -->
                <div class="hero-main">
                    <div class="skeleton" style="width: 100%; height: 100%;"></div>
                </div>
                
                <!-- Hero Secondary Skeleton -->
                <div class="hero-secondary">
                    <div class="secondary-story">
                        <div class="skeleton secondary-image"></div>
                        <div class="secondary-content">
                            <div class="skeleton" style="height: 16px; width: 60px; margin-bottom: 8px;"></div>
                            <div class="skeleton" style="height: 20px; width: 100%; margin-bottom: 8px;"></div>
                            <div class="skeleton" style="height: 14px; width: 80px;"></div>
                        </div>
                    </div>
                    <div class="secondary-story">
                        <div class="skeleton secondary-image"></div>
                        <div class="secondary-content">
                            <div class="skeleton" style="height: 16px; width: 60px; margin-bottom: 8px;"></div>
                            <div class="skeleton" style="height: 20px; width: 100%; margin-bottom: 8px;"></div>
                            <div class="skeleton" style="height: 14px; width: 80px;"></div>
                        </div>
                    </div>
                    <div class="secondary-story">
                        <div class="skeleton secondary-image"></div>
                        <div class="secondary-content">
                            <div class="skeleton" style="height: 16px; width: 60px; margin-bottom: 8px;"></div>
                            <div class="skeleton" style="height: 20px; width: 100%; margin-bottom: 8px;"></div>
                            <div class="skeleton" style="height: 14px; width: 80px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Featured Stories Section -->
        <section class="featured-section">
            <div class="section-header">
                <h2 class="section-title">Featured Stories</h2>
                <a href="#" class="view-all-btn">
                    View All
                    <i class="material-icons">arrow_forward</i>
                </a>
            </div>
            
            <div class="magazine-grid" id="magazineGrid">
                <!-- Magazine Grid Skeleton -->
                <div class="magazine-card large">
                    <div class="skeleton" style="width: 100%; height: 100%;"></div>
                </div>
                <div class="magazine-card">
                    <div class="skeleton" style="width: 100%; height: 100%;"></div>
                </div>
                <div class="magazine-card">
                    <div class="skeleton" style="width: 100%; height: 100%;"></div>
                </div>
            </div>
        </section>

        <!-- Latest Stories -->
        <section class="latest-section">
            <div class="section-header">
                <h2 class="section-title">All Stories</h2>
            </div>
            
            <div class="stories-masonry" id="storiesGrid">
                <!-- Stories Skeleton -->
                <div class="story-card">
                    <div class="story-image-container">
                        <div class="skeleton story-image"></div>
                    </div>
                    <div class="story-content">
                        <div class="skeleton" style="height: 20px; width: 80px; margin-bottom: 1rem;"></div>
                        <div class="skeleton" style="height: 28px; width: 100%; margin-bottom: 1rem;"></div>
                        <div class="skeleton" style="height: 16px; width: 100%; margin-bottom: 0.5rem;"></div>
                        <div class="skeleton" style="height: 16px; width: 100%; margin-bottom: 0.5rem;"></div>
                        <div class="skeleton" style="height: 16px; width: 70%;"></div>
                    </div>
                </div>
                <div class="story-card">
                    <div class="story-image-container">
                        <div class="skeleton story-image"></div>
                    </div>
                    <div class="story-content">
                        <div class="skeleton" style="height: 20px; width: 80px; margin-bottom: 1rem;"></div>
                        <div class="skeleton" style="height: 28px; width: 100%; margin-bottom: 1rem;"></div>
                        <div class="skeleton" style="height: 16px; width: 100%; margin-bottom: 0.5rem;"></div>
                        <div class="skeleton" style="height: 16px; width: 100%; margin-bottom: 0.5rem;"></div>
                        <div class="skeleton" style="height: 16px; width: 70%;"></div>
                    </div>
                </div>
                <div class="story-card">
                    <div class="story-image-container">
                        <div class="skeleton story-image"></div>
                    </div>
                    <div class="story-content">
                        <div class="skeleton" style="height: 20px; width: 80px; margin-bottom: 1rem;"></div>
                        <div class="skeleton" style="height: 28px; width: 100%; margin-bottom: 1rem;"></div>
                        <div class="skeleton" style="height: 16px; width: 100%; margin-bottom: 0.5rem;"></div>
                        <div class="skeleton" style="height: 16px; width: 100%; margin-bottom: 0.5rem;"></div>
                        <div class="skeleton" style="height: 16px; width: 70%;"></div>
                    </div>
                </div>
            </div>

            <div class="load-more">
                <button class="load-more-btn" id="loadMoreBtn">
                    <i class="material-icons">expand_more</i>
                    Load More Stories
                </button>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-logo">
                <img src="SILAKBO.png" alt="Silakbo Logo" class="footer-logo-img" onerror="this.src='https://via.placeholder.com/32x32?text=S'">
                <span class="footer-logo-text">ANG SILAKBO ARCHIVES</span>
            </div>
            <div class="footer-links">
                <a href="About Us" class="footer-link">About Us</a>
                <a href="Chat Request" class="footer-link">Contact</a>
                <a href="Submissionposts" class="footer-link">Submit Work</a>
                <a href="Ang Silakbo Application" class="footer-link">Join Our Team</a>
                <a href="Privacy" class="footer-link">Privacy Policy</a>
            </div>
            <div class="footer-social">
                <a href="https://www.facebook.com/AngSilakboUCLM" class="social-link">
                    <i class="material-icons">facebook</i>
                </a>
                <a href="#" class="social-link">
                    <i class="material-icons">share</i>
                </a>
                <a href="uclm@angsilakbo.edu.ph" class="social-link">
                    <i class="material-icons">email</i>
                </a>
            </div>
        </div>
    </footer>

    <!-- Search Overlay -->
    <div class="search-overlay" id="searchOverlay">
        <div class="search-container">
            <form id="searchForm">
                <input type="text" class="search-input" placeholder="Search stories, authors, topics..." id="searchInput">
            </form>
        </div>
        <button class="search-close" id="searchClose">
            <i class="material-icons">close</i>
        </button>
    </div>

    <!-- Article Modal -->
    <div class="modal" id="articleModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="logo">
                    <img src="SILAKBO.png" alt="Silakbo Logo" class="logo-img" onerror="this.src='https://via.placeholder.com/40x40?text=S'">
                    <span class="logo-text">ANG SILAKBO</span>
                </div>
            </div>
            <div class="article-container" id="articleContainer">
                <!-- Article content will be loaded here -->
            </div>
        </div>
        <button class="modal-close" id="modalClose">
            <i class="material-icons">close</i>
        </button>
    </div>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-header">
            <div class="logo">
                <img src="SILAKBO.png" alt="Silakbo Logo" class="logo-img" onerror="this.src='https://via.placeholder.com/40x40?text=S'">
                <span class="logo-text">ANG SILAKBO</span>
            </div>
            <button class="icon-btn" id="mobileMenuClose">
                <i class="material-icons">close</i>
            </button>
        </div>
        <ul class="mobile-nav-links">
            <li><a href="#" class="active" data-filter="all">All Stories</a></li>
            <li><a href="#" data-filter="article">Articles</a></li>
            <li><a href="#" data-filter="literary">Literary</a></li>
            <li><a href="#" data-filter="feature">Feature</a></li>
            <li><a href="#" data-filter="silak">Silak-salitaan</a></li>
            <li><a href="#" data-filter="photostory">Photostory</a></li>
        </ul>
    </div>
    <div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>

    <!-- Toast -->
    <div class="toast" id="toast">Link copied to clipboard!</div>

    <!-- Reading Progress -->
    <div class="reading-progress" id="readingProgress"></div>

    <script>
        // Supabase Configuration
        const supabaseUrl = "https://uyxgsziyflquisckdwwc.supabase.co";
        const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV5eGdzeml5ZmxxdWlzY2tkd3djIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE1OTQyODUsImV4cCI6MjA1NzE3MDI4NX0.DoIEoWWuajDpBhD2UwLYzrKRyZNyBP4izasROCdIbkk";
        const { createClient } = window.supabase;
        const supabase = createClient(supabaseUrl, supabaseKey, {
            auth: { persistSession: false },
            headers: {
                'Access-Control-Allow-Origin': '*',
                'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type'
            }
        });

        // Global Variables
        let allPosts = [];
        let displayedPosts = 0;
        let postsPerPage = 6;
        let currentFilter = 'all';
        let currentPostId = null;
        let bookmarkedPosts = JSON.parse(localStorage.getItem('bookmarkedPosts')) || [];
        let viewCounts = JSON.parse(localStorage.getItem('viewCounts')) || {};

        // DOM Elements
        const heroGrid = document.getElementById('heroGrid');
        const magazineGrid = document.getElementById('magazineGrid');
        const storiesGrid = document.getElementById('storiesGrid');
        const loadMoreBtn = document.getElementById('loadMoreBtn');
        const searchBtn = document.getElementById('searchBtn');
        const searchOverlay = document.getElementById('searchOverlay');
        const searchClose = document.getElementById('searchClose');
        const searchForm = document.getElementById('searchForm');
        const searchInput = document.getElementById('searchInput');
        const themeToggle = document.getElementById('themeToggle');
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileMenu = document.getElementById('mobileMenu');
        const mobileMenuClose = document.getElementById('mobileMenuClose');
        const mobileMenuOverlay = document.getElementById('mobileMenuOverlay');
        const articleModal = document.getElementById('articleModal');
        const modalClose = document.getElementById('modalClose');
        const articleContainer = document.getElementById('articleContainer');
        const toast = document.getElementById('toast');
        const readingProgress = document.getElementById('readingProgress');

        // Initialize AOS
        document.addEventListener('DOMContentLoaded', function() {
            AOS.init({
                once: true,
                offset: 50,
                duration: 600,
                easing: 'ease-out-cubic'
            });
        });

        // Theme Management
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeIcon(savedTheme);
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        }

        function updateThemeIcon(theme) {
            const icon = themeToggle.querySelector('i');
            icon.textContent = theme === 'dark' ? 'light_mode' : 'dark_mode';
        }

        // Utility Functions
        function truncateText(text, wordCount) {
            if (!text) return '';
            const words = text.split(' ');
            if (words.length <= wordCount) return text;
            return words.slice(0, wordCount).join(' ') + '...';
        }

        function formatDate(dateString) {
            if (!dateString) return '';
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }

        function getRelativeTime(dateString) {
            if (!dateString) return '';
            const date = new Date(dateString);
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

            if (diffDays === 0) {
                const diffHours = Math.floor(diffTime / (1000 * 60 * 60));
                if (diffHours === 0) {
                    const diffMinutes = Math.floor(diffTime / (1000 * 60));
                    return diffMinutes === 0 ? 'Just now' : `${diffMinutes}m ago`;
                }
                return `${diffHours}h ago`;
            } else if (diffDays < 7) {
                return `${diffDays}d ago`;
            } else if (diffDays < 30) {
                const diffWeeks = Math.floor(diffDays / 7);
                return `${diffWeeks}w ago`;
            } else {
                return formatDate(dateString);
            }
        }

        function stripHtml(html) {
            if (!html) return '';
            const tmp = document.createElement('DIV');
            tmp.innerHTML = html;
            return tmp.textContent || tmp.innerText || '';
        }

        function getPostTitle(post) {
            return post.title || post.category.charAt(0).toUpperCase() + post.category.slice(1);
        }

        function getReadingTime(text) {
            const wordsPerMinute = 200;
            const wordCount = text.split(/\s+/).length;
            const readingTime = Math.ceil(wordCount / wordsPerMinute);
            return readingTime < 1 ? 1 : readingTime;
        }

        function generateSlug(text) {
            return text.toString().toLowerCase()
                .replace(/\s+/g, '-')
                .replace(/[^\w\-]+/g, '')
                .replace(/\-\-+/g, '-')
                .replace(/^-+/, '')
                .replace(/-+$/, '');
        }

        function getPostUrl(post) {
            const title = getPostTitle(post);
            const slug = generateSlug(title);
            return `${window.location.origin}${window.location.pathname}?post=${post.id}&title=${slug}`;
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('Link copied to clipboard!');
            }).catch(err => {
                console.error('Could not copy text: ', err);
            });
        }

        function showToast(message) {
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Post Management
        function toggleBookmark(postId) {
            const index = bookmarkedPosts.indexOf(postId);
            if (index === -1) {
                bookmarkedPosts.push(postId);
            } else {
                bookmarkedPosts.splice(index, 1);
            }
            localStorage.setItem('bookmarkedPosts', JSON.stringify(bookmarkedPosts));
            return bookmarkedPosts.includes(postId);
        }

        function isPostBookmarked(postId) {
            return bookmarkedPosts.includes(postId);
        }

        async function incrementViewCount(postId) {
            try {
                if (!viewCounts[postId]) {
                    viewCounts[postId] = true;
                    localStorage.setItem('viewCounts', JSON.stringify(viewCounts));
                    
                    const post = allPosts.find(p => p.id == postId);
                    if (post) {
                        const newViews = (post.views || 0) + 1;
                        post.views = newViews;
                        
                        const { error } = await supabase
                            .from('posts')
                            .update({ views: newViews })
                            .eq('id', postId);
                        
                        if (error) throw error;
                    }
                }
            } catch (error) {
                console.error('Error incrementing view count:', error);
            }
        }

        // Content Creation Functions
        function createHeroContent() {
            if (allPosts.length === 0) return;

            const filteredPosts = currentFilter === 'all' ? allPosts : allPosts.filter(post => post.category.toLowerCase() === currentFilter);
            if (filteredPosts.length === 0) return;

            const mainPost = filteredPosts[0];
            const secondaryPosts = filteredPosts.slice(1, 4);

            const title = getPostTitle(mainPost);
            const plainTextContent = stripHtml(mainPost.content || '');
            const excerpt = truncateText(plainTextContent, 25);
            const hasImage = mainPost.image_url ? true : false;
            const postDate = formatDate(mainPost.created_at || mainPost.date || mainPost.timestamp);
            const readingTime = getReadingTime(plainTextContent);

            let secondaryHtml = '';
            secondaryPosts.forEach(post => {
                const secTitle = getPostTitle(post);
                const secHasImage = post.image_url ? true : false;
                const secDate = getRelativeTime(post.created_at || post.date || post.timestamp);

                secondaryHtml += `
                    <div class="secondary-story" data-post-id="${post.id}" data-aos="fade-up" data-aos-delay="100">
                        <img src="${secHasImage ? post.image_url : 'https://via.placeholder.com/120x120?text=' + post.category}" 
                             alt="${secTitle}" class="secondary-image" 
                             onerror="this.src='https://via.placeholder.com/120x120?text=${post.category}'">
                        <div class="secondary-content">
                            <div class="secondary-category">${post.category}</div>
                            <h3 class="secondary-title">${secTitle}</h3>
                            <div class="secondary-meta">
                                <span>${post.author || 'Unknown'}</span>
                                <span>â€¢</span>
                                <span>${secDate}</span>
                            </div>
                        </div>
                    </div>
                `;
            });

            heroGrid.innerHTML = `
                <div class="hero-main" data-post-id="${mainPost.id}" data-aos="fade-up">
                    <img src="${hasImage ? mainPost.image_url : 'https://via.placeholder.com/800x600?text=' + mainPost.category}" 
                         alt="${title}" class="hero-image" 
                         onerror="this.src='https://via.placeholder.com/800x600?text=${mainPost.category}'">
                    <div class="hero-overlay">
                        <div class="hero-category">${mainPost.category}</div>
                        <h1 class="hero-title">${title}</h1>
                        <p class="hero-excerpt">${excerpt}</p>
                        <div class="hero-meta">
                            <div class="meta-item">
                                <i class="material-icons">person</i>
                                <span>By ${mainPost.author || 'Unknown'}</span>
                            </div>
                            <div class="meta-item">
                                <i class="material-icons">schedule</i>
                                <span>${readingTime} min read</span>
                            </div>
                            <div class="meta-item">
                                <i class="material-icons">event</i>
                                <span>${postDate}</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="hero-secondary">
                    ${secondaryHtml}
                </div>
            `;

            addEventListeners();
        }

        function createMagazineGrid() {
            if (allPosts.length < 3) return;

            const filteredPosts = currentFilter === 'all' ? allPosts : allPosts.filter(post => post.category.toLowerCase() === currentFilter);
            const magazinePosts = filteredPosts.slice(0, 3);

            let magazineHtml = '';
            magazinePosts.forEach((post, index) => {
                const title = getPostTitle(post);
                const hasImage = post.image_url ? true : false;
                const postDate = getRelativeTime(post.created_at || post.date || post.timestamp);
                const isLarge = index === 0;

                magazineHtml += `
                    <div class="magazine-card ${isLarge ? 'large' : ''}" data-post-id="${post.id}" data-aos="fade-up" data-aos-delay="${index * 100}">
                        <img src="${hasImage ? post.image_url : 'https://via.placeholder.com/400x300?text=' + post.category}" 
                             alt="${title}" class="magazine-image" 
                             onerror="this.src='https://via.placeholder.com/400x300
                             onerror="this.src='https://via.placeholder.com/400x300?text=${post.category}'">
                        <div class="magazine-overlay">
                            <div class="magazine-category">${post.category}</div>
                            <h3 class="magazine-title">${title}</h3>
                            <div class="magazine-meta">
                                <span>${post.author || 'Unknown'}</span>
                                <span>â€¢</span>
                                <span>${postDate}</span>
                            </div>
                        </div>
                    </div>
                `;
            });

            magazineGrid.innerHTML = magazineHtml;
            addEventListeners();
        }

        function createStoryCard(post, index = 0) {
            const title = getPostTitle(post);
            const plainTextContent = stripHtml(post.content || '');
            const excerpt = truncateText(plainTextContent, 20);
            const hasImage = post.image_url ? true : false;
            const postDate = getRelativeTime(post.created_at || post.date || post.timestamp);
            const readingTime = getReadingTime(plainTextContent);

            return `
                <div class="story-card" data-post-id="${post.id}" data-aos="fade-up" data-aos-delay="${index * 100}">
                    <div class="story-image-container">
                        <img src="${hasImage ? post.image_url : 'https://via.placeholder.com/400x240?text=' + post.category}" 
                             alt="${title}" class="story-image" 
                             onerror="this.src='https://via.placeholder.com/400x240?text=${post.category}'">
                    </div>
                    <div class="story-content">
                        <div class="story-category">${post.category}</div>
                        <h3 class="story-title">${title}</h3>
                        <p class="story-excerpt">${excerpt}</p>
                        <div class="story-meta">
                            <div>
                                <span class="story-author">${post.author || 'Unknown'}</span>
                            </div>
                            <div class="story-date">
                                <i class="material-icons">schedule</i>
                                <span>${readingTime} min read</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Content Loading Functions
        function loadStories() {
            const filteredPosts = currentFilter === 'all' ? allPosts : allPosts.filter(post => post.category.toLowerCase() === currentFilter);
            const startIndex = displayedPosts;
            const endIndex = Math.min(startIndex + postsPerPage, filteredPosts.length);
            const postsToDisplay = filteredPosts.slice(startIndex, endIndex);

            if (startIndex === 0) {
                storiesGrid.innerHTML = '';
            }

            postsToDisplay.forEach((post, index) => {
                storiesGrid.innerHTML += createStoryCard(post, startIndex + index);
            });

            displayedPosts = endIndex;
            
            if (displayedPosts >= filteredPosts.length) {
                loadMoreBtn.style.display = 'none';
            } else {
                loadMoreBtn.style.display = 'block';
            }

            addEventListeners();
        }

        function filterPosts(filter) {
            currentFilter = filter;
            displayedPosts = 0;
            
            // Update active nav link
            document.querySelectorAll('.nav-link, .mobile-nav-links a').forEach(link => {
                link.classList.remove('active');
                if (link.dataset.filter === filter) {
                    link.classList.add('active');
                }
            });

            createHeroContent();
            createMagazineGrid();
            loadStories();
        }

        function searchPosts(query) {
            if (!query.trim()) {
                filterPosts(currentFilter);
                return;
            }

            const results = allPosts.filter(post => {
                const title = getPostTitle(post).toLowerCase();
                const content = stripHtml(post.content || '').toLowerCase();
                const author = (post.author || '').toLowerCase();
                const category = (post.category || '').toLowerCase();
                
                query = query.toLowerCase();
                
                return title.includes(query) || 
                    content.includes(query) || 
                    author.includes(query) ||
                    category.includes(query);
            });

            // Display search results
            if (results.length === 0) {
                heroGrid.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; padding: 2rem; color: var(--text-light);">No results found for your search.</div>';
                magazineGrid.innerHTML = '';
                storiesGrid.innerHTML = '';
                loadMoreBtn.style.display = 'none';
                return;
            }

            // Show results in hero and magazine sections
            allPosts = results;
            displayedPosts = 0;
            createHeroContent();
            createMagazineGrid();
            loadStories();
        }

        // Article Modal Functions
        function openArticle(postId) {
            const post = allPosts.find(p => p.id == postId);
            if (!post) return;

            currentPostId = postId;
            const postUrl = getPostUrl(post);
            window.history.pushState({ postId }, '', postUrl);

            const hasImage = post.image_url ? true : false;
            const title = getPostTitle(post);
            const plainTextContent = stripHtml(post.content);
            const postDate = formatDate(post.created_at || post.date || post.timestamp);
            const readingTime = getReadingTime(plainTextContent);
            const viewCount = post.views || 0;

            let specialContent = '';
            if (post.category.toLowerCase() === 'silak') {
                specialContent = `
                    <div style="background: rgba(106, 27, 154, 0.1); border-radius: var(--radius-xl); padding: var(--spacing-xl); margin: var(--spacing-xl) 0;">
                        <h2 style="color: #6A1B9A; margin-bottom: var(--spacing-md); font-family: var(--headline-font);">Silak-salitaan</h2>
                        <h3 style="font-size: 1.5rem; margin-bottom: var(--spacing-sm);">${post.title || 'Salitang Filipino'}</h3>
                        <div style="font-style: italic; margin-bottom: var(--spacing-sm); color: var(--text-light);">${post.pronunciation || ''}</div>
                        <div style="font-weight: 600; color: #6A1B9A; margin-bottom: var(--spacing-sm);">${post.part_of_speech || 'Pangngalan'}</div>
                        <div style="margin-bottom: var(--spacing-md);">${post.definition || ''}</div>
                        ${hasImage ? `<img src="${post.image_url}" alt="${title}" style="width: 100%; border-radius: var(--radius-lg); margin: var(--spacing-md) 0;">` : ''}
                        <div style="font-style: italic; color: var(--text-light); border-left: 3px solid #6A1B9A; padding-left: var(--spacing-sm); margin-top: var(--spacing-sm);">${post.example || ''}</div>
                    </div>
                `;
            } else if (post.category.toLowerCase() === 'photostory') {
                specialContent = `
                    <div style="background: rgba(0, 121, 107, 0.1); border-radius: var(--radius-xl); padding: var(--spacing-xl); margin: var(--spacing-xl) 0;">
                        <h2 style="color: #00796B; margin-bottom: var(--spacing-md); font-family: var(--headline-font);">${title}</h2>
                        <div style="display: flex; gap: var(--spacing-md); margin-bottom: var(--spacing-md); color: var(--text-muted);">
                            <span>By: ${post.author || 'Unknown'}</span>
                            <span>${postDate}</span>
                        </div>
                        ${hasImage ? `<img src="${post.image_url}" alt="${title}" style="width: 100%; border-radius: var(--radius-lg); margin-bottom: var(--spacing-sm);">` : ''}
                        <div style="font-style: italic; text-align: center; margin-bottom: var(--spacing-md); color: var(--text-light);">${post.caption || 'Larawan: ' + title}</div>
                        <div>${plainTextContent}</div>
                    </div>
                `;
            }

            articleContainer.innerHTML = `
                <div class="article-header">
                    <div class="story-category">${post.category}</div>
                    <h1 class="article-title">${title}</h1>
                    <div class="article-meta">
                        <div class="meta-item">
                            <i class="material-icons">person</i>
                            <span>By ${post.author || 'Unknown'}</span>
                        </div>
                        <div class="meta-item">
                            <i class="material-icons">event</i>
                            <span>${postDate}</span>
                        </div>
                        <div class="meta-item">
                            <i class="material-icons">schedule</i>
                            <span>${readingTime} min read</span>
                        </div>
                        <div class="meta-item">
                            <i class="material-icons">visibility</i>
                            <span>${viewCount} views</span>
                        </div>
                    </div>
                </div>
                
                ${hasImage && !specialContent ? `<img src="${post.image_url}" alt="${title}" class="article-cover">` : ''}
                
                ${specialContent ? specialContent : `<div class="article-content">${post.content}</div>`}
                
                <div class="article-actions">
                    <div class="share-options">
                        <button class="share-btn" onclick="shareArticle('facebook', '${postUrl}', '${title}')" title="Share on Facebook">
                            <i class="material-icons">facebook</i>
                        </button>
                        <button class="share-btn" onclick="shareArticle('twitter', '${postUrl}', '${title}')" title="Share on Twitter">
                            <i class="material-icons">share</i>
                        </button>
                        <button class="share-btn" onclick="copyToClipboard('${postUrl}')" title="Copy link">
                            <i class="material-icons">link</i>
                        </button>
                    </div>
                    <button class="share-btn" onclick="toggleBookmark(${post.id})" title="${isPostBookmarked(post.id) ? 'Remove bookmark' : 'Bookmark this article'}">
                        <i class="material-icons">${isPostBookmarked(post.id) ? 'bookmark' : 'bookmark_border'}</i>
                    </button>
                </div>
            `;

            articleModal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Setup reading progress
            const modalContent = articleModal.querySelector('.modal-content');
            modalContent.addEventListener('scroll', updateReadingProgress);
            
            incrementViewCount(postId);
        }

        function closeArticle() {
            articleModal.classList.remove('active');
            document.body.style.overflow = 'auto';
            window.history.pushState({}, '', window.location.pathname);
            currentPostId = null;
        }

        function updateReadingProgress() {
            const modalContent = articleModal.querySelector('.modal-content');
            const scrollTop = modalContent.scrollTop;
            const scrollHeight = modalContent.scrollHeight;
            const clientHeight = modalContent.clientHeight;
            const scrollPercentage = (scrollTop / (scrollHeight - clientHeight)) * 100;
            readingProgress.style.width = `${Math.min(scrollPercentage, 100)}%`;
        }

        function shareArticle(platform, url, title) {
            let shareUrl = '';
            switch (platform) {
                case 'facebook':
                    shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;
                    break;
                case 'twitter':
                    shareUrl = `https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(title)}`;
                    break;
            }
            if (shareUrl) {
                window.open(shareUrl, '_blank', 'width=600,height=400');
            }
        }

        // Event Listeners
        function addEventListeners() {
            // Story click events
            document.querySelectorAll('[data-post-id]').forEach(element => {
                element.addEventListener('click', () => {
                    const postId = element.dataset.postId;
                    if (postId) {
                        openArticle(postId);
                    }
                });
            });
        }

        // Data Loading
        async function fetchPosts() {
            try {
                const { data: posts, error } = await supabase.from("posts").select("*");
                
                if (error) throw error;

                if (posts && posts.length > 0) {
                    allPosts = [...posts].sort((a, b) => {
                        const dateA = a.created_at || a.date || a.timestamp || a.id;
                        const dateB = b.created_at || b.date || b.timestamp || b.id;
                        return new Date(dateB) - new Date(dateA);
                    });
                } else {
                    // Sample data for demonstration
                    allPosts = [
                        {
                            id: 1,
                            title: "The Evolution of Filipino Literature in the Digital Age",
                            category: "Feature",
                            author: "Maria Santos",
                            created_at: "2025-03-25",
                            content: "<p>As technology continues to reshape our world, Filipino literature finds new expressions and audiences through digital platforms, creating unprecedented opportunities for young writers.</p><p>The digital revolution has transformed how we create, share, and consume literature. For Filipino writers, this shift has opened doors to global audiences while presenting new challenges in preserving cultural authenticity.</p><p>Young Filipino authors are increasingly turning to online platforms to share their work, bypassing traditional publishing routes that were once gatekeepers to literary recognition. This democratization of publishing has led to a flourishing of diverse voices and perspectives.</p>",
                            views: 120,
                            image_url: "https://via.placeholder.com/800x500?text=Filipino+Literature"
                        },
                        {
                            id: 2,
                            title: "Student Poets Win National Recognition",
                            category: "Literary",
                            author: "Juan Dela Cruz",
                            created_at: "2025-03-24",
                            content: "<p>Sophomore Miguel Santos received second place in the English Poetry division for his work 'Echoes of Manila,' a vivid portrayal of urban life and social inequality in the capital.</p><p>First-year student Sophia Lim earned an honorable mention for her experimental bilingual poetry that seamlessly weaves together English and Filipino, reflecting the linguistic reality of many young Filipinos today.</p>",
                            views: 85,
                            image_url: "https://via.placeholder.com/400x300?text=Student+Poets"
                        },
                        {
                            id: 3,
                            title: "Preserving Indigenous Filipino Words",
                            category: "Silak",
                            author: "Antonio Reyes",
                            created_at: "2025-03-23",
                            content: "<p>A new initiative by UCLM-SHS students aims to document and preserve indigenous Filipino words through digital storytelling and social media campaigns.</p>",
                            pronunciation: "sa-li-ta ng ni-nu-no",
                            part_of_speech: "Pangngalan",
                            definition: "Isang proyekto na naglalayong mapreserba ang mga katutubong salita ng Pilipinas sa pamamagitan ng digital storytelling at social media.",
                            example: "Ang Salita ng Ninuno ay nakatulong upang makilala ng mga kabataan ang kayamanang pangwika ng ating bansa.",
                            views: 65,
                            image_url: "https://via.placeholder.com/400x300?text=Indigenous+Words"
                        },
                        {
                            id: 4,
                            title: "A Day in Campus Life",
                            category: "Photostory",
                            author: "Gabriela Santos",
                            created_at: "2025-03-22",
                            content: "<p>This photo essay captures the vibrant daily life of UCLM-SHS students, from early morning study sessions to afternoon cultural performances and evening dormitory activities.</p>",
                            views: 92,
                            image_url: "https://via.placeholder.com/800x450?text=Campus+Life",
                            caption: "Students gather in the central plaza for the annual Buwan ng Wika celebration, showcasing traditional Filipino attire and performances."
                        },
                        {
                            id: 5,
                            title: "Rising Influence of Filipino Youth in Global Literature",
                            category: "Feature",
                            author: "Marco Bonifacio",
                            created_at: "2025-03-21",
                            content: "<p>Young Filipino writers are increasingly making their mark on the global literary scene, bringing unique perspectives shaped by the country's complex cultural history.</p><p>International literary festivals and publishing houses have begun to take notice of the distinctive voice emerging from Philippine youth literature.</p>",
                            views: 78,
                            image_url: "https://via.placeholder.com/400x300?text=Filipino+Youth+Writers"
                        },
                        {
                            id: 6,
                            title: "Why Filipino Literature Deserves Greater Recognition",
                            category: "Literary",
                            author: "Dr. Isabella Cruz",
                            created_at: "2025-03-20",
                            content: "<p>Despite its rich literary tradition and unique cultural perspective, Filipino literature remains underrepresented in global academic curricula and literary discourse.</p>",
                            views: 110,
                            image_url: "https://via.placeholder.com/400x300?text=Filipino+Literature+Academia"
                        }
                    ];
                }

                // Initialize content
                setTimeout(() => {
                    createHeroContent();
                    createMagazineGrid();
                    loadStories();
                    checkUrlParams();
                }, 1000);

            } catch (error) {
                console.error("Error fetching posts:", error);
                heroGrid.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; padding: 2rem; color: var(--text-light);">Error loading content. Please try again later.</div>';
                magazineGrid.innerHTML = '';
                storiesGrid.innerHTML = '';
                loadMoreBtn.style.display = 'none';
            }
        }

        function checkUrlParams() {
            const urlParams = new URLSearchParams(window.location.search);
            const postId = urlParams.get('post');

            if (postId && allPosts.length > 0) {
                const post = allPosts.find(p => p.id == postId);
                if (post) {
                    openArticle(postId);
                }
            }
        }

        // Initialize App
        document.addEventListener('DOMContentLoaded', () => {
            initTheme();
            fetchPosts();

            // Theme toggle
            themeToggle.addEventListener('click', toggleTheme);

            // Search functionality
            searchBtn.addEventListener('click', () => {
                searchOverlay.classList.add('active');
                searchInput.focus();
            });

            searchClose.addEventListener('click', () => {
                searchOverlay.classList.remove('active');
            });

            searchForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const query = searchInput.value.trim();
                if (query) {
                    searchPosts(query);
                    searchOverlay.classList.remove('active');
                }
            });

            // Navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const filter = link.dataset.filter;
                    filterPosts(filter);
                });
            });

            // Mobile menu
            mobileMenuBtn.addEventListener('click', () => {
                mobileMenu.classList.add('active');
                mobileMenuOverlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            });

            mobileMenuClose.addEventListener('click', () => {
                mobileMenu.classList.remove('active');
                mobileMenuOverlay.classList.remove('active');
                document.body.style.overflow = 'auto';
            });

            mobileMenuOverlay.addEventListener('click', () => {
                mobileMenu.classList.remove('active');
                mobileMenuOverlay.classList.remove('active');
                document.body.style.overflow = 'auto';
            });

            document.querySelectorAll('.mobile-nav-links a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const filter = link.dataset.filter;
                    filterPosts(filter);
                    mobileMenu.classList.remove('active');
                    mobileMenuOverlay.classList.remove('active');
                    document.body.style.overflow = 'auto';
                });
            });

            // Load more
            loadMoreBtn.addEventListener('click', () => {
                loadMoreBtn.innerHTML = '<i class="material-icons">hourglass_empty</i> Loading...';
                setTimeout(() => {
                    loadStories();
                    loadMoreBtn.innerHTML = '<i class="material-icons">expand_more</i> Load More Stories';
                }, 500);
            });

            // Modal
            modalClose.addEventListener('click', closeArticle);
            articleModal.addEventListener('click', (e) => {
                if (e.target === articleModal) {
                    closeArticle();
                }
            });

            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    if (searchOverlay.classList.contains('active')) {
                        searchOverlay.classList.remove('active');
                    } else if (articleModal.classList.contains('active')) {
                        closeArticle();
                    } else if (mobileMenu.classList.contains('active')) {
                        mobileMenu.classList.remove('active');
                        mobileMenuOverlay.classList.remove('active');
                        document.body.style.overflow = 'auto';
                    }
                }
            });

            // Handle browser back/forward
            window.addEventListener('popstate', (e) => {
                if (articleModal.classList.contains('active')) {
                    closeArticle();
                } else {
                    checkUrlParams();
                }
            });
        });

        // Global functions for inline event handlers
        window.shareArticle = shareArticle;
        window.toggleBookmark = toggleBookmark;
        window.copyToClipboard = copyToClipboard;
    </script>
</body>
</html>
