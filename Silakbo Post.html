<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ANG SILAKBO - Workstation</title>
<link rel="icon" href="SILAKBO.png">

<!-- Google Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&family=Playfair+Display:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&family=Source+Sans+Pro:wght@300;400;600;700&display=swap" rel="stylesheet">

<!-- Material Icons -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,0..200" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,0..200" />

<!-- TinyMCE -->
<script src="https://cdn.tiny.cloud/1/n92j01vjprp9xy96v0uxd2kgqi5vnd50dwm5i47veg2u1bur/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>

<!-- Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
    :root {
        /* Material 3 Color System - Orange Theme */
        --md-sys-color-primary: #e65100;
        --md-sys-color-on-primary: #ffffff;
        --md-sys-color-primary-container: #ffdbca;
        --md-sys-color-on-primary-container: #e65100;
        --md-sys-color-secondary: #ff8a50;
        --md-sys-color-on-secondary: #ffffff;
        --md-sys-color-secondary-container: #ffe0d1;
        --md-sys-color-on-secondary-container: #e65100;
        --md-sys-color-tertiary: #ffab40;
        --md-sys-color-on-tertiary: #ffffff;
        --md-sys-color-tertiary-container: #fff3e0;
        --md-sys-color-on-tertiary-container: #e65100;
        --md-sys-color-error: #ba1a1a;
        --md-sys-color-on-error: #ffffff;
        --md-sys-color-error-container: #ffdad6;
        --md-sys-color-on-error-container: #410002;
        --md-sys-color-background: #fffbff;
        --md-sys-color-on-background: #1f1b16;
        --md-sys-color-surface: #fffbff;
        --md-sys-color-on-surface: #1f1b16;
        --md-sys-color-surface-variant: #f5ede7;
        --md-sys-color-on-surface-variant: #52443c;
        --md-sys-color-outline: #84746a;
        --md-sys-color-outline-variant: #d6c4b8;
        --md-sys-color-shadow: #000000;
        --md-sys-color-scrim: #000000;
        --md-sys-color-inverse-surface: #34302a;
        --md-sys-color-inverse-on-surface: #f7f0e8;
        --md-sys-color-inverse-primary: #ffb68e;
        --md-sys-color-surface-dim: #e2d5cd;
        --md-sys-color-surface-bright: #fffbff;
        --md-sys-color-surface-container-lowest: #ffffff;
        --md-sys-color-surface-container-low: #fcf0e8;
        --md-sys-color-surface-container: #f6eae2;
        --md-sys-color-surface-container-high: #f1e4dc;
        --md-sys-color-surface-container-highest: #ebded6;
        
        /* Material 3 Elevation */
        --md-sys-elevation-level0: none;
        --md-sys-elevation-level1: 0px 1px 2px 0px rgba(0, 0, 0, 0.3), 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        --md-sys-elevation-level2: 0px 1px 2px 0px rgba(0, 0, 0, 0.3), 0px 2px 6px 2px rgba(0, 0, 0, 0.15);
        --md-sys-elevation-level3: 0px 1px 3px 0px rgba(0, 0, 0, 0.3), 0px 4px 8px 3px rgba(0, 0, 0, 0.15);
        --md-sys-elevation-level4: 0px 2px 3px 0px rgba(0, 0, 0, 0.3), 0px 6px 10px 4px rgba(0, 0, 0, 0.15);
        --md-sys-elevation-level5: 0px 4px 4px 0px rgba(0, 0, 0, 0.3), 0px 8px 12px 6px rgba(0, 0, 0, 0.15);
        
        /* Material 3 Typography */
        --md-sys-typescale-display-large-font: 'Playfair Display', serif;
        --md-sys-typescale-display-large-weight: 400;
        --md-sys-typescale-display-large-size: 57px;
        --md-sys-typescale-display-large-line-height: 64px;
        --md-sys-typescale-display-large-tracking: -0.25px;
        
        --md-sys-typescale-display-medium-font: 'Playfair Display', serif;
        --md-sys-typescale-display-medium-weight: 400;
        --md-sys-typescale-display-medium-size: 45px;
        --md-sys-typescale-display-medium-line-height: 52px;
        --md-sys-typescale-display-medium-tracking: 0px;
        
        --md-sys-typescale-display-small-font: 'Playfair Display', serif;
        --md-sys-typescale-display-small-weight: 400;
        --md-sys-typescale-display-small-size: 36px;
        --md-sys-typescale-display-small-line-height: 44px;
        --md-sys-typescale-display-small-tracking: 0px;
        
        --md-sys-typescale-headline-large-font: 'Playfair Display', serif;
        --md-sys-typescale-headline-large-weight: 400;
        --md-sys-typescale-headline-large-size: 32px;
        --md-sys-typescale-headline-large-line-height: 40px;
        --md-sys-typescale-headline-large-tracking: 0px;
        
        --md-sys-typescale-headline-medium-font: 'Playfair Display', serif;
        --md-sys-typescale-headline-medium-weight: 400;
        --md-sys-typescale-headline-medium-size: 28px;
        --md-sys-typescale-headline-medium-line-height: 36px;
        --md-sys-typescale-headline-medium-tracking: 0px;
        
        --md-sys-typescale-headline-small-font: 'Playfair Display', serif;
        --md-sys-typescale-headline-small-weight: 400;
        --md-sys-typescale-headline-small-size: 24px;
        --md-sys-typescale-headline-small-line-height: 32px;
        --md-sys-typescale-headline-small-tracking: 0px;
        
        --md-sys-typescale-title-large-font: 'Poppins', sans-serif;
        --md-sys-typescale-title-large-weight: 500;
        --md-sys-typescale-title-large-size: 22px;
        --md-sys-typescale-title-large-line-height: 28px;
        --md-sys-typescale-title-large-tracking: 0px;
        
        --md-sys-typescale-title-medium-font: 'Poppins', sans-serif;
        --md-sys-typescale-title-medium-weight: 500;
        --md-sys-typescale-title-medium-size: 16px;
        --md-sys-typescale-title-medium-line-height: 24px;
        --md-sys-typescale-title-medium-tracking: 0.15px;
        
        --md-sys-typescale-title-small-font: 'Poppins', sans-serif;
        --md-sys-typescale-title-small-weight: 500;
        --md-sys-typescale-title-small-size: 14px;
        --md-sys-typescale-title-small-line-height: 20px;
        --md-sys-typescale-title-small-tracking: 0.1px;
        
        --md-sys-typescale-body-large-font: 'Source Sans Pro', sans-serif;
        --md-sys-typescale-body-large-weight: 400;
        --md-sys-typescale-body-large-size: 16px;
        --md-sys-typescale-body-large-line-height: 24px;
        --md-sys-typescale-body-large-tracking: 0.5px;
        
        --md-sys-typescale-body-medium-font: 'Source Sans Pro', sans-serif;
        --md-sys-typescale-body-medium-weight: 400;
        --md-sys-typescale-body-medium-size: 14px;
        --md-sys-typescale-body-medium-line-height: 20px;
        --md-sys-typescale-body-medium-tracking: 0.25px;
        
        --md-sys-typescale-body-small-font: 'Source Sans Pro', sans-serif;
        --md-sys-typescale-body-small-weight: 400;
        --md-sys-typescale-body-small-size: 12px;
        --md-sys-typescale-body-small-line-height: 16px;
        --md-sys-typescale-body-small-tracking: 0.4px;
        
        --md-sys-typescale-label-large-font: 'Poppins', sans-serif;
        --md-sys-typescale-label-large-weight: 500;
        --md-sys-typescale-label-large-size: 14px;
        --md-sys-typescale-label-large-line-height: 20px;
        --md-sys-typescale-label-large-tracking: 0.1px;
        
        --md-sys-typescale-label-medium-font: 'Poppins', sans-serif;
        --md-sys-typescale-label-medium-weight: 500;
        --md-sys-typescale-label-medium-size: 12px;
        --md-sys-typescale-label-medium-line-height: 16px;
        --md-sys-typescale-label-medium-tracking: 0.5px;
        
        --md-sys-typescale-label-small-font: 'Poppins', sans-serif;
        --md-sys-typescale-label-small-weight: 500;
        --md-sys-typescale-label-small-size: 11px;
        --md-sys-typescale-label-small-line-height: 16px;
        --md-sys-typescale-label-small-tracking: 0.5px;
        
        /* Nexora AI Colors */
        --nexora-purple: #8b5cf6;
        --nexora-blue: #3b82f6;
        --nexora-pink: #ec4899;
        --nexora-gradient: linear-gradient(135deg, var(--nexora-purple) 0%, var(--nexora-blue) 50%, var(--nexora-pink) 100%);
        --nexora-light: rgba(139, 92, 246, 0.1);
        --nexora-medium: rgba(139, 92, 246, 0.2);
        
        /* Layout */
        --sidebar-width: 280px;
        --sidebar-collapsed-width: 80px;
        --content-max-width: 1400px;
        
        /* Soft Shape System */
        --md-sys-shape-corner-none: 0px;
        --md-sys-shape-corner-extra-small: 8px;
        --md-sys-shape-corner-small: 12px;
        --md-sys-shape-corner-medium: 16px;
        --md-sys-shape-corner-large: 20px;
        --md-sys-shape-corner-extra-large: 32px;
        --md-sys-shape-corner-full: 9999px;
    }

    /* Base Styles */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: var(--md-sys-typescale-body-large-font);
        background-color: var(--md-sys-color-background);
        color: var(--md-sys-color-on-background);
        min-height: 100vh;
        display: flex;
        line-height: 1.6;
    }

    /* Typography */
    .display-large {
        font-family: var(--md-sys-typescale-display-large-font);
        font-weight: var(--md-sys-typescale-display-large-weight);
        font-size: var(--md-sys-typescale-display-large-size);
        line-height: var(--md-sys-typescale-display-large-line-height);
        letter-spacing: var(--md-sys-typescale-display-large-tracking);
    }

    .display-medium {
        font-family: var(--md-sys-typescale-display-medium-font);
        font-weight: var(--md-sys-typescale-display-medium-weight);
        font-size: var(--md-sys-typescale-display-medium-size);
        line-height: var(--md-sys-typescale-display-medium-line-height);
        letter-spacing: var(--md-sys-typescale-display-medium-tracking);
    }

    .display-small {
        font-family: var(--md-sys-typescale-display-small-font);
        font-weight: var(--md-sys-typescale-display-small-weight);
        font-size: var(--md-sys-typescale-display-small-size);
        line-height: var(--md-sys-typescale-display-small-line-height);
        letter-spacing: var(--md-sys-typescale-display-small-tracking);
    }

    .headline-large {
        font-family: var(--md-sys-typescale-headline-large-font);
        font-weight: var(--md-sys-typescale-headline-large-weight);
        font-size: var(--md-sys-typescale-headline-large-size);
        line-height: var(--md-sys-typescale-headline-large-line-height);
        letter-spacing: var(--md-sys-typescale-headline-large-tracking);
    }

    .headline-medium {
        font-family: var(--md-sys-typescale-headline-medium-font);
        font-weight: var(--md-sys-typescale-headline-medium-weight);
        font-size: var(--md-sys-typescale-headline-medium-size);
        line-height: var(--md-sys-typescale-headline-medium-line-height);
        letter-spacing: var(--md-sys-typescale-headline-medium-tracking);
    }

    .headline-small {
        font-family: var(--md-sys-typescale-headline-small-font);
        font-weight: var(--md-sys-typescale-headline-small-weight);
        font-size: var(--md-sys-typescale-headline-small-size);
        line-height: var(--md-sys-typescale-headline-small-line-height);
        letter-spacing: var(--md-sys-typescale-headline-small-tracking);
    }

    .title-large {
        font-family: var(--md-sys-typescale-title-large-font);
        font-weight: var(--md-sys-typescale-title-large-weight);
        font-size: var(--md-sys-typescale-title-large-size);
        line-height: var(--md-sys-typescale-title-large-line-height);
        letter-spacing: var(--md-sys-typescale-title-large-tracking);
    }

    .title-medium {
        font-family: var(--md-sys-typescale-title-medium-font);
        font-weight: var(--md-sys-typescale-title-medium-weight);
        font-size: var(--md-sys-typescale-title-medium-size);
        line-height: var(--md-sys-typescale-title-medium-line-height);
        letter-spacing: var(--md-sys-typescale-title-medium-tracking);
    }

    .title-small {
        font-family: var(--md-sys-typescale-title-small-font);
        font-weight: var(--md-sys-typescale-title-small-weight);
        font-size: var(--md-sys-typescale-title-small-size);
        line-height: var(--md-sys-typescale-title-small-line-height);
        letter-spacing: var(--md-sys-typescale-title-small-tracking);
    }

    .body-large {
        font-family: var(--md-sys-typescale-body-large-font);
        font-weight: var(--md-sys-typescale-body-large-weight);
        font-size: var(--md-sys-typescale-body-large-size);
        line-height: var(--md-sys-typescale-body-large-line-height);
        letter-spacing: var(--md-sys-typescale-body-large-tracking);
    }

    .body-medium {
        font-family: var(--md-sys-typescale-body-medium-font);
        font-weight: var(--md-sys-typescale-body-medium-weight);
        font-size: var(--md-sys-typescale-body-medium-size);
        line-height: var(--md-sys-typescale-body-medium-line-height);
        letter-spacing: var(--md-sys-typescale-body-medium-tracking);
    }

    .body-small {
        font-family: var(--md-sys-typescale-body-small-font);
        font-weight: var(--md-sys-typescale-body-small-weight);
        font-size: var(--md-sys-typescale-body-small-size);
        line-height: var(--md-sys-typescale-body-small-line-height);
        letter-spacing: var(--md-sys-typescale-body-small-tracking);
    }

    .label-large {
        font-family: var(--md-sys-typescale-label-large-font);
        font-weight: var(--md-sys-typescale-label-large-weight);
        font-size: var(--md-sys-typescale-label-large-size);
        line-height: var(--md-sys-typescale-label-large-line-height);
        letter-spacing: var(--md-sys-typescale-label-large-tracking);
    }

    .label-medium {
        font-family: var(--md-sys-typescale-label-medium-font);
        font-weight: var(--md-sys-typescale-label-medium-weight);
        font-size: var(--md-sys-typescale-label-medium-size);
        line-height: var(--md-sys-typescale-label-medium-line-height);
        letter-spacing: var(--md-sys-typescale-label-medium-tracking);
    }

    .label-small {
        font-family: var(--md-sys-typescale-label-small-font);
        font-weight: var(--md-sys-typescale-label-small-weight);
        font-size: var(--md-sys-typescale-label-small-size);
        line-height: var(--md-sys-typescale-label-small-line-height);
        letter-spacing: var(--md-sys-typescale-label-small-tracking);
    }

    /* Material Icons */
    .material-symbols-outlined,
    .material-symbols-rounded {
        font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        font-size: 24px;
        line-height: 1;
        vertical-align: middle;
    }

    .material-symbols-outlined.fill,
    .material-symbols-rounded.fill {
        font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;
    }

    .material-symbols-outlined.md-18,
    .material-symbols-rounded.md-18 {
        font-size: 18px;
    }

    .material-symbols-outlined.md-20,
    .material-symbols-rounded.md-20 {
        font-size: 20px;
    }

    .material-symbols-outlined.md-24,
    .material-symbols-rounded.md-24 {
        font-size: 24px;
    }

    .material-symbols-outlined.md-36,
    .material-symbols-rounded.md-36 {
        font-size: 36px;
    }

    /* Navigation Rail (Sidebar) - Updated to white background */
    .navigation-rail {
        width: var(--sidebar-width);
        background-color: #ffffff;
        display: flex;
        flex-direction: column;
        position: fixed;
        left: 0;
        top: 0;
        height: 100vh;
        z-index: 1000;
        transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: var(--md-sys-elevation-level1);
   }

    .navigation-rail.collapsed {
        width: var(--sidebar-collapsed-width);
    }

    .navigation-rail-header {
        padding: 20px;
        display: flex;
        align-items: center;
        gap: 16px;
        background-color: var(--md-sys-color-primary);
        color: var(--md-sys-color-on-primary);
    }

    .navigation-rail-header img {
        width: 32px;
        height: 32px;
        border-radius: var(--md-sys-shape-corner-full);
        flex-shrink: 0;
    }

    .navigation-rail-title {
        font-family: var(--md-sys-typescale-title-large-font);
        font-weight: 700;
        font-size: var(--md-sys-typescale-title-large-size);
        white-space: nowrap;
        opacity: 1;
        transition: opacity 0.3s, width 0.3s;
    }

    .navigation-rail.collapsed .navigation-rail-title {
        opacity: 0;
        width: 0;
        overflow: hidden;
    }

    .navigation-rail-toggle {
        background: none;
        border: none;
        color: var(--md-sys-color-on-primary);
        cursor: pointer;
        padding: 8px;
        border-radius: var(--md-sys-shape-corner-full);
        transition: background-color 0.2s;
        margin-left: auto;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .navigation-rail-toggle:hover {
        background-color: rgba(255, 255, 255, 0.1);
    }

    .navigation-rail-content {
        flex: 1;
        padding: 20px 0;
        overflow-y: auto;
    }

    .navigation-group {
        margin-bottom: 24px;
    }

    .navigation-group-title {
        font-family: var(--md-sys-typescale-label-medium-font);
        font-weight: var(--md-sys-typescale-label-medium-weight);
        font-size: var(--md-sys-typescale-label-medium-size);
        color: var(--md-sys-color-on-surface-variant);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        padding: 0 20px;
        margin-bottom: 12px;
        opacity: 1;
        transition: opacity 0.3s, height 0.3s;
    }

    .navigation-rail.collapsed .navigation-group-title {
        opacity: 0;
        height: 0;
        margin: 0;
        padding: 0;
        overflow: hidden;
    }

    .navigation-item {
        margin-bottom: 8px;
    }

    .navigation-link {
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 16px 20px;
        color: var(--md-sys-color-on-surface-variant);
        text-decoration: none;
        font-family: var(--md-sys-typescale-label-large-font);
        font-weight: var(--md-sys-typescale-label-large-weight);
        font-size: var(--md-sys-typescale-label-large-size);
        transition: background-color 0.2s, color 0.2s;
        border-radius: 0 var(--md-sys-shape-corner-full) var(--md-sys-shape-corner-full) 0;
        position: relative;
        cursor: pointer;
        margin-right: 20px;
    }

    .navigation-link:hover {
        background-color: var(--md-sys-color-surface-container-high);
        color: var(--md-sys-color-primary);
    }

    .navigation-link.active {
        background-color: var(--md-sys-color-primary-container);
        color: var(--md-sys-color-on-primary-container);
    }

    .navigation-link-text {
        white-space: nowrap;
        opacity: 1;
        transition: opacity 0.3s, width 0.3s;
    }

    .navigation-rail.collapsed .navigation-link-text {
        opacity: 0;
        width: 0;
        overflow: hidden;
    }

    .navigation-rail.collapsed .navigation-link {
        padding: 16px;
        justify-content: center;
        margin-right: 0;
        border-radius: var(--md-sys-shape-corner-full);
    }

    .navigation-rail-footer {
        padding: 20px;
        background-color: #ffffff;
    }

    .navigation-rail-footer-content {
        display: flex;
        align-items: center;
        gap: 12px;
        opacity: 1;
        transition: opacity 0.3s, height 0.3s;
    }

    .navigation-rail.collapsed .navigation-rail-footer-content {
        opacity: 0;
        height: 0;
        padding: 0;
        overflow: hidden;
    }

    .status-indicator {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background-color: #4caf50;
        flex-shrink: 0;
    }

    .status-text {
        font-size: var(--md-sys-typescale-body-small-size);
        color: var(--md-sys-color-on-surface-variant);
    }

    /* Main Content - Removed borders */
    .main-content {
        flex: 1;
        margin-left: var(--sidebar-width);
        transition: margin-left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        flex-direction: column;
        min-height: 100vh;
    }

    .navigation-rail.collapsed + .main-content {
        margin-left: var(--sidebar-collapsed-width);
    }

    /* Top App Bar - Removed thick borders */
    .top-app-bar {
        background-color: var(--md-sys-color-surface);
        color: var(--md-sys-color-on-surface);
        padding: 0 24px;
        height: 64px;
        display: flex;
        align-items: center;
        position: sticky;
        top: 0;
        z-index: 100;
        box-shadow: none;
    }

    .top-app-bar-content {
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;
        max-width: var(--content-max-width);
        margin: 0 auto;
    }

    .top-app-bar-left {
        display: flex;
        align-items: center;
        gap: 16px;
    }

    .page-title {
        font-family: var(--md-sys-typescale-headline-small-font);
        font-weight: var(--md-sys-typescale-headline-small-weight);
        font-size: var(--md-sys-typescale-headline-small-size);
        color: var(--md-sys-color-on-surface);
    }

    .top-app-bar-actions {
        display: flex;
        gap: 16px;
        align-items: center;
    }

    /* Nexora AI Chip */
    .nexora-chip {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 20px;
        background: var(--nexora-gradient);
        border-radius: var(--md-sys-shape-corner-full);
        color: white;
        box-shadow: var(--md-sys-elevation-level1);
        position: relative;
        transition: box-shadow 0.3s;
    }

    /* Nexora Aura Glow Effect */
    .nexora-chip.aura-glow {
        animation: nexoraAura 2s ease-in-out infinite;
    }

    @keyframes nexoraAura {
        0%, 100% {
            box-shadow: 
                var(--md-sys-elevation-level1),
                0 0 20px rgba(139, 92, 246, 0.4),
                0 0 40px rgba(59, 130, 246, 0.3),
                0 0 60px rgba(236, 72, 153, 0.2);
        }
        50% {
            box-shadow: 
                var(--md-sys-elevation-level1),
                0 0 30px rgba(139, 92, 246, 0.6),
                0 0 60px rgba(59, 130, 246, 0.5),
                0 0 90px rgba(236, 72, 153, 0.4);
        }
    }

    .nexora-logo {
        width: 24px;
        height: 24px;
        border-radius: var(--md-sys-shape-corner-full);
        flex-shrink: 0;
    }

    .nexora-info {
        display: flex;
        flex-direction: column;
        gap: 2px;
    }

    .nexora-title {
        font-family: var(--md-sys-typescale-label-large-font);
        font-weight: var(--md-sys-typescale-label-large-weight);
        font-size: var(--md-sys-typescale-label-large-size);
        line-height: 1;
    }

    .nexora-subtitle {
        font-size: var(--md-sys-typescale-label-small-size);
        opacity: 0.9;
        line-height: 1;
    }

    .nexora-actions {
        display: flex;
        gap: 8px;
    }

    .nexora-btn {
        background-color: rgba(255, 255, 255, 0.2);
        border: none;
        color: white;
        width: 36px;
        height: 36px;
        border-radius: var(--md-sys-shape-corner-full);
        cursor: pointer;
        transition: background-color 0.2s, transform 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .nexora-btn:hover {
        background-color: rgba(255, 255, 255, 0.3);
        transform: scale(1.05);
    }

    /* Main Body */
    .main-body {
        flex: 1;
        padding: 32px;
        max-width: var(--content-max-width);
        margin: 0 auto;
        width: 100%;
    }

    /* Material Card - Removed thick borders */
    .md-card {
        background-color: var(--md-sys-color-surface);
        border-radius: var(--md-sys-shape-corner-extra-large);
        box-shadow: none;
        overflow: hidden;
        transition: box-shadow 0.3s;
    }

    .md-card:hover {
        box-shadow: var(--md-sys-elevation-level1);
    }

    .md-card-content {
        padding: 32px;
    }

    /* Tabs */
    .tab-content {
        display: none;
        animation: fadeInUp 0.4s ease-out;
    }

    .tab-content.active {
        display: block;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Form Styles - Removed thick borders from input fields */
    .form-group {
        margin-bottom: 28px;
    }

    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 28px;
    }

    .md-field {
        position: relative;
        margin-bottom: 8px;
    }

    .md-field-label {
        font-family: var(--md-sys-typescale-label-medium-font);
        font-weight: var(--md-sys-typescale-label-medium-weight);
        font-size: var(--md-sys-typescale-label-medium-size);
        color: var(--md-sys-color-on-surface-variant);
        margin-bottom: 8px;
        display: block;
    }

    .md-field-container {
        position: relative;
        display: flex;
        align-items: center;
    }

    .md-field-icon {
        position: absolute;
        left: 16px;
        color: var(--md-sys-color-on-surface-variant);
        z-index: 2;
        pointer-events: none;
    }

    .md-text-field,
    .md-select {
        width: 100%;
        padding: 20px 20px 20px 52px;
        border: none;
        border-radius: var(--md-sys-shape-corner-medium);
        font-family: var(--md-sys-typescale-body-large-font);
        font-size: var(--md-sys-typescale-body-large-size);
        background-color: var(--md-sys-color-surface-container);
        color: var(--md-sys-color-on-surface);
        transition: background-color 0.3s, box-shadow 0.3s;
    }

    .md-text-field:focus,
    .md-select:focus {
        outline: none;
        background-color: var(--md-sys-color-surface-container-high);
        box-shadow: 0 0 0 2px rgba(230, 81, 0, 0.2);
    }

    .md-text-field:hover,
    .md-select:hover {
        background-color: var(--md-sys-color-surface-container-high);
    }

    .md-select {
        appearance: none;
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2352443c'%3e%3cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3e%3c/path%3e%3c/svg%3e");
        background-position: right 16px center;
        background-repeat: no-repeat;
        background-size: 20px;
        padding-right: 48px;
    }

    /* Grammar Check */
    .grammar-check-container {
        position: relative;
    }

    .grammar-check-btn {
        position: absolute;
        top: 50%;
        right: 16px;
        transform: translateY(-50%);
        background: var(--nexora-gradient);
        border: none;
        color: white;
        width: 36px;
        height: 36px;
        border-radius: var(--md-sys-shape-corner-full);
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10;
    }

    .grammar-check-btn:hover {
        transform: translateY(-50%) scale(1.05);
        box-shadow: var(--md-sys-elevation-level1);
    }

    /* File Input */
    .file-input-container {
        display: flex;
        align-items: center;
        gap: 20px;
        flex-wrap: wrap;
    }

    .file-input-label {
        padding: 12px 24px;
        background-color: var(--md-sys-color-primary);
        color: var(--md-sys-color-on-primary);
        border-radius: var(--md-sys-shape-corner-full);
        cursor: pointer;
        font-family: var(--md-sys-typescale-label-large-font);
        font-weight: var(--md-sys-typescale-label-large-weight);
        font-size: var(--md-sys-typescale-label-large-size);
        display: flex;
        align-items: center;
        gap: 8px;
        transition: background-color 0.2s, transform 0.2s, box-shadow 0.2s;
        box-shadow: var(--md-sys-elevation-level1);
    }

    .file-input-label:hover {
        transform: translateY(-2px);
        box-shadow: var(--md-sys-elevation-level2);
    }

    input[type="file"] {
        display: none;
    }

    .file-name {
        font-family: var(--md-sys-typescale-body-medium-font);
        font-size: var(--md-sys-typescale-body-medium-size);
        color: var(--md-sys-color-on-surface-variant);
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .image-preview-container {
        margin-top: 20px;
        max-width: 300px;
    }

    #imagePreview, #editImagePreview {
        max-width: 100%;
        border-radius: var(--md-sys-shape-corner-large);
        display: none;
        box-shadow: var(--md-sys-elevation-level1);
        transition: box-shadow 0.3s;
    }

    /* Buttons */
    .md-button {
        font-family: var(--md-sys-typescale-label-large-font);
        font-weight: var(--md-sys-typescale-label-large-weight);
        font-size: var(--md-sys-typescale-label-large-size);
        padding: 12px 28px;
        border-radius: var(--md-sys-shape-corner-full);
        border: none;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: background-color 0.2s, transform 0.2s, box-shadow 0.2s;
        white-space: nowrap;
        text-decoration: none;
        position: relative;
        overflow: hidden;
    }

    .md-button::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: transparent;
        transition: background-color 0.2s;
        pointer-events: none;
    }

    .md-button:hover::after {
        background-color: rgba(255, 255, 255, 0.1);
    }

    .md-button:active::after {
        background-color: rgba(0, 0, 0, 0.1);
    }

    .md-button-filled {
        background-color: var(--md-sys-color-primary);
        color: var(--md-sys-color-on-primary);
        box-shadow: var(--md-sys-elevation-level1);
    }

    .md-button-filled:hover {
        box-shadow: var(--md-sys-elevation-level2);
        transform: translateY(-1px);
    }

    .md-button-filled:active {
        box-shadow: var(--md-sys-elevation-level1);
        transform: translateY(0);
    }

    .md-button-tonal {
        background-color: var(--md-sys-color-secondary-container);
        color: var(--md-sys-color-on-secondary-container);
    }

    .md-button-outlined {
        background-color: transparent;
        color: var(--md-sys-color-primary);
        border: 1px solid var(--md-sys-color-outline);
    }

    .md-button-text {
        background-color: transparent;
        color: var(--md-sys-color-primary);
        padding: 12px 16px;
    }

    .md-button-danger {
        background-color: var(--md-sys-color-error);
        color: var(--md-sys-color-on-error);
        box-shadow: var(--md-sys-elevation-level1);
    }

    .md-button-danger:hover {
        box-shadow: var(--md-sys-elevation-level2);
        transform: translateY(-1px);
    }

    .md-button-nexora {
        background: var(--nexora-gradient);
        color: white;
        box-shadow: var(--md-sys-elevation-level1);
    }

    .md-button-nexora:hover {
        box-shadow: var(--md-sys-elevation-level2);
        transform: translateY(-1px);
    }

    /* Icon Button */
    .md-icon-button {
        width: 48px;
        height: 48px;
        border-radius: var(--md-sys-shape-corner-full);
        display: flex;
        align-items: center;
        justify-content: center;
        border: none;
        background-color: transparent;
        cursor: pointer;
        transition: background-color 0.2s;
        color: var(--md-sys-color-on-surface-variant);
        position: relative;
    }

    .md-icon-button::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        border-radius: var(--md-sys-shape-corner-full);
        background-color: transparent;
        transition: background-color 0.2s;
        pointer-events: none;
    }

    .md-icon-button:hover::after {
        background-color: rgba(0, 0, 0, 0.05);
    }

    .md-icon-button:active::after {
        background-color: rgba(0, 0, 0, 0.1);
    }

    .md-icon-button.primary {
        color: var(--md-sys-color-primary);
    }

    .md-icon-button.success {
        color: #4caf50;
    }

    .md-icon-button.info {
        color: #2196f3;
    }

    .md-icon-button.warning {
        color: #ff9800;
    }

    .md-icon-button.danger {
        color: var(--md-sys-color-error);
    }

    /* Floating Action Button (FAB) */
    .md-fab {
        position: fixed;
        bottom: 32px;
        right: 32px;
        width: 56px;
        height: 56px;
        border-radius: var(--md-sys-shape-corner-large);
        background-color: var(--md-sys-color-primary);
        color: var(--md-sys-color-on-primary);
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: var(--md-sys-elevation-level3);
        border: none;
        cursor: pointer;
        transition: background-color 0.2s, transform 0.2s, box-shadow 0.2s;
        z-index: 100;
    }

    .md-fab:hover {
        box-shadow: var(--md-sys-elevation-level4);
        transform: translateY(-2px);
    }

    .md-fab:active {
        box-shadow: var(--md-sys-elevation-level2);
        transform: translateY(0);
    }

    .md-fab-small {
        width: 40px;
        height: 40px;
    }

    .md-fab-large {
        width: 96px;
        height: 96px;
    }

    /* Table Styles */
    .table-container {
        border-radius: var(--md-sys-shape-corner-extra-large);
        overflow: hidden;
        box-shadow: var(--md-sys-elevation-level1);
        margin-top: 20px;
        background-color: var(--md-sys-color-surface);
    }

    .md-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
    }

    .md-table th,
    .md-table td {
        padding: 20px;
        text-align: left;
        border-bottom: 1px solid var(--md-sys-color-outline-variant);
    }

    .md-table th {
        background-color: var(--md-sys-color-surface-container);
        font-family: var(--md-sys-typescale-label-large-font);
        font-weight: var(--md-sys-typescale-label-large-weight);
        font-size: var(--md-sys-typescale-label-large-size);
        color: var(--md-sys-color-on-surface);
        position: sticky;
        top: 0;
        z-index: 10;
    }

    .md-table td {
        font-family: var(--md-sys-typescale-body-medium-font);
        font-size: var(--md-sys-typescale-body-medium-size);
        color: var(--md-sys-color-on-surface);
    }

    .md-table tr:hover {
        background-color: var(--md-sys-color-surface-container-low);
    }

    .action-buttons {
        display: flex;
        gap: 8px;
    }

    /* Snackbar */
    .md-snackbar {
        position: fixed;
        bottom: 32px;
        left: 50%;
        transform: translateX(-50%) translateY(100px);
        background-color: var(--md-sys-color-inverse-surface);
        color: var(--md-sys-color-inverse-on-surface);
        padding: 16px 20px;
        border-radius: var(--md-sys-shape-corner-medium);
        box-shadow: var(--md-sys-elevation-level3);
        display: flex;
        align-items: center;
        gap: 16px;
        min-width: 280px;
        max-width: 90%;
        z-index: 1000;
        opacity: 0;
        transition: transform 0.3s, opacity 0.3s;
        pointer-events: none;
    }

    .md-snackbar.show {
        transform: translateX(-50%) translateY(0);
        opacity: 1;
        pointer-events: auto;
    }

    .md-snackbar-message {
        flex: 1;
        font-family: var(--md-sys-typescale-body-medium-font);
        font-size: var(--md-sys-typescale-body-medium-size);
    }

    .md-snackbar-action {
        font-family: var(--md-sys-typescale-label-large-font);
        font-weight: var(--md-sys-typescale-label-large-weight);
        font-size: var(--md-sys-typescale-label-large-size);
        color: var(--md-sys-color-primary);
        background: none;
        border: none;
        cursor: pointer;
        padding: 8px;
        text-transform: uppercase;
        white-space: nowrap;
    }

    .md-snackbar.success {
        background-color: #2e7d32;
        color: white;
    }

    .md-snackbar.error {
        background-color: var(--md-sys-color-error);
        color: var(--md-sys-color-on-error);
    }

    /* Dialog (Modal) */
    .md-dialog-backdrop {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.5);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 2000;
        backdrop-filter: blur(4px);
        padding: 32px;
    }

    .md-dialog {
        background-color: var(--md-sys-color-surface);
        border-radius: var(--md-sys-shape-corner-extra-large);
        max-width: 560px;
        width: 100%;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: var(--md-sys-elevation-level3);
        transform: scale(0.9) translateY(20px);
        transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        opacity: 0;
    }

    .md-dialog-backdrop.active .md-dialog {
        transform: scale(1) translateY(0);
        opacity: 1;
    }

    .md-dialog-header {
        padding: 32px 32px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .md-dialog-title {
        font-family: var(--md-sys-typescale-headline-small-font);
        font-weight: var(--md-sys-typescale-headline-small-weight);
        font-size: var(--md-sys-typescale-headline-small-size);
        color: var(--md-sys-color-on-surface);
    }

    .md-dialog-body {
        padding: 0 32px 32px;
    }

    .md-dialog-actions {
        padding: 20px 32px 32px;
        display: flex;
        gap: 12px;
        justify-content: flex-end;
    }

    /* Large Dialog */
    .md-dialog-large .md-dialog {
        max-width: 800px;
    }

    /* Nexora Chat Dialog */
    .nexora-dialog .md-dialog {
        max-width: 800px;
        height: 600px;
        max-height: 80vh;
        display: flex;
        flex-direction: column;
    }

    .nexora-dialog .md-dialog-header {
        background: var(--nexora-gradient);
        color: white;
        border-radius: var(--md-sys-shape-corner-extra-large) var(--md-sys-shape-corner-extra-large) 0 0;
    }

    .nexora-dialog .md-dialog-title {
        color: white;
    }

    .nexora-dialog .md-icon-button {
        color: white;
    }

    .nexora-dialog .md-dialog-body {
        flex: 1;
        display: flex;
        flex-direction: column;
        padding: 32px;
        overflow: hidden;
    }

    .nexora-chat-container {
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow: hidden;
    }

    .nexora-messages {
        flex: 1;
        overflow-y: auto;
        padding: 20px;
        background-color: var(--md-sys-color-surface-container-lowest);
        border-radius: var(--md-sys-shape-corner-large);
        margin-bottom: 20px;
    }

    .nexora-message {
        margin-bottom: 20px;
        display: flex;
        gap: 12px;
    }

    .nexora-message.user {
        flex-direction: row-reverse;
    }

    .nexora-message-avatar {
        width: 36px;
        height: 36px;
        border-radius: var(--md-sys-shape-corner-full);
        flex-shrink: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
        color: white;
    }

    .nexora-message.user .nexora-message-avatar {
        background-color: var(--md-sys-color-primary);
    }

    .nexora-message.assistant .nexora-message-avatar {
        background: var(--nexora-gradient);
    }

    .nexora-message-content {
        background-color: var(--md-sys-color-surface);
        padding: 16px 20px;
        border-radius: var(--md-sys-shape-corner-large);
        max-width: 70%;
        box-shadow: var(--md-sys-elevation-level1);
    }

    .nexora-message.user .nexora-message-content {
        background-color: var(--md-sys-color-primary-container);
    }

    .nexora-input-container {
        display: flex;
        gap: 16px;
    }

    .nexora-input {
        flex: 1;
        padding: 16px 20px;
        border: none;
        border-radius: var(--md-sys-shape-corner-full);
        font-family: var(--md-sys-typescale-body-large-font);
        font-size: var(--md-sys-typescale-body-large-size);
        background-color: var(--md-sys-color-surface-container);
        color: var(--md-sys-color-on-surface);
        transition: background-color 0.3s, box-shadow 0.3s;
    }

    .nexora-input:focus {
        outline: none;
        background-color: var(--md-sys-color-surface-container-high);
        box-shadow: 0 0 0 2px var(--nexora-light);
    }

    .nexora-send-btn {
        background: var(--nexora-gradient);
        border: none;
        color: white;
        width: 48px;
        height: 48px;
        border-radius: var(--md-sys-shape-corner-full);
        cursor: pointer;
        transition: transform 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .nexora-send-btn:hover {
        transform: scale(1.05);
    }

    /* Loading States */
    .loading-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 64px;
        color: var(--md-sys-color-on-surface-variant);
    }

    .md-progress-circular {
        width: 48px;
        height: 48px;
        border: 4px solid var(--md-sys-color-surface-variant);
        border-top: 4px solid var(--md-sys-color-primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 64px;
        color: var(--md-sys-color-on-surface-variant);
    }

    .empty-state .material-symbols-rounded {
        font-size: 48px;
        margin-bottom: 20px;
        color: var(--md-sys-color-outline);
    }

    .empty-state p {
        font-family: var(--md-sys-typescale-body-large-font);
        font-size: var(--md-sys-typescale-body-large-size);
        margin-bottom: 32px;
    }

    /* TinyMCE Customization - Removed thick borders */
    .tox-tinymce {
        border: none !important;
        border-radius: var(--md-sys-shape-corner-medium) !important;
        transition: box-shadow 0.3s !important;
        overflow: hidden !important;
        background-color: var(--md-sys-color-surface-container) !important;
    }

    .tox-tinymce:focus-within {
        box-shadow: 0 0 0 2px rgba(230, 81, 0, 0.2) !important;
    }

    .tox .tox-toolbar__primary {
        background-color: var(--md-sys-color-surface-container) !important;
        border-bottom: none !important;
    }

    .tox .tox-tbtn {
        border-radius: var(--md-sys-shape-corner-small) !important;
    }

    .tox .tox-tbtn:hover {
        background-color: var(--md-sys-color-primary-container) !important;
    }

    .tox .tox-edit-area {
        border: none !important;
    }

    .tox .tox-statusbar {
        border-top: none !important;
        background-color: var(--md-sys-color-surface-container) !important;
    }

    /* Word Count */
    .word-count {
        font-size: var(--md-sys-typescale-body-small-size);
        color: var(--md-sys-color-on-surface-variant);
        display: flex;
        align-items: center;
        gap: 8px;
    }

    /* Grammar suggestions */
    .grammar-suggestion {
        background-color: var(--nexora-light);
        border: 1px solid var(--nexora-purple);
        border-radius: var(--md-sys-shape-corner-medium);
        padding: 20px;
        margin-top: 20px;
        display: none;
    }

    .grammar-suggestion.active {
        display: block;
        animation: fadeInUp 0.3s ease-out;
    }

    .grammar-suggestion-header {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 16px;
        color: var(--nexora-purple);
        font-weight: 600;
    }

    .grammar-suggestion-content {
        font-size: var(--md-sys-typescale-body-medium-size);
        color: var(--md-sys-color-on-surface);
        line-height: 1.5;
    }

    .grammar-suggestion-actions {
        margin-top: 16px;
        display: flex;
        gap: 12px;
    }

    .grammar-suggestion-btn {
        padding: 8px 16px;
        border: none;
        border-radius: var(--md-sys-shape-corner-full);
        font-size: var(--md-sys-typescale-label-small-size);
        font-weight: 500;
        cursor: pointer;
        transition: background-color 0.2s, transform 0.2s;
    }

    .grammar-suggestion-btn.accept {
        background-color: var(--nexora-purple);
        color: white;
    }

    .grammar-suggestion-btn.dismiss {
        background-color: var(--md-sys-color-surface-variant);
        color: var(--md-sys-color-on-surface-variant);
    }

    .grammar-suggestion-btn:hover {
        transform: translateY(-1px);
    }

    /* Badge styles */
    .md-badge {
        padding: 6px 16px;
        border-radius: var(--md-sys-shape-corner-full);
        font-size: var(--md-sys-typescale-label-small-size);
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .md-badge-article {
        background-color: var(--md-sys-color-primary-container);
        color: var(--md-sys-color-on-primary-container);
    }

    .md-badge-literary {
        background-color: var(--md-sys-color-tertiary-container);
        color: var(--md-sys-color-on-tertiary-container);
    }

    /* Post view styles */
    .post-view {
        font-family: 'Merriweather', serif;
        line-height: 1.8;
    }

    .post-header {
        margin-bottom: 40px;
        padding-bottom: 32px;
        border-bottom: 2px solid var(--md-sys-color-outline-variant);
    }

    .post-title {
        font-size: var(--md-sys-typescale-display-small-size);
        font-weight: var(--md-sys-typescale-display-small-weight);
        color: var(--md-sys-color-on-surface);
        margin-bottom: 20px;
        line-height: 1.3;
    }

    .post-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 32px;
        font-size: var(--md-sys-typescale-body-medium-size);
        color: var(--md-sys-color-on-surface-variant);
    }

    .meta-item {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .meta-item .material-symbols-rounded {
        color: var(--md-sys-color-primary);
        font-size: 18px;
    }

    .post-content {
        font-size: 16px;
        line-height: 1.8;
    }

    .post-content h1,
    .post-content h2,
    .post-content h3,
    .post-content h4,
    .post-content h5,
    .post-content h6 {
        font-family: 'Playfair Display', serif;
        margin-top: 40px;
        margin-bottom: 20px;
        color: var(--md-sys-color-on-surface);
    }

    .post-content p {
        margin-bottom: 32px;
    }

    .post-content img {
        max-width: 100%;
        height: auto;
        border-radius: var(--md-sys-shape-corner-large);
        margin: 32px 0;
    }

    /* Mobile menu button */
    .mobile-menu-btn {
        display: none;
        background: none;
        border: none;
        color: var(--md-sys-color-on-surface);
        cursor: pointer;
        width: 48px;
        height: 48px;
        border-radius: var(--md-sys-shape-corner-full);
        transition: background-color 0.2s;
    }

    .mobile-menu-btn:hover {
        background-color: var(--md-sys-color-surface-container);
    }

    /* Responsive Design */
    @media (max-width: 1024px) {
        .navigation-rail {
            transform: translateX(-100%);
        }

        .navigation-rail.open {
            transform: translateX(0);
        }

        .main-content {
            margin-left: 0;
        }

        .navigation-rail.collapsed + .main-content {
            margin-left: 0;
        }

        .mobile-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 999;
            display: none;
        }

        .mobile-overlay.active {
            display: block;
        }

        .mobile-menu-btn {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .top-app-bar {
            padding: 0 20px;
        }

        .main-body {
            padding: 20px;
        }

        .md-card-content {
            padding: 20px;
        }

        .form-row {
            grid-template-columns: 1fr;
        }

        .nexora-chip {
            flex-direction: column;
            gap: 8px;
            padding: 12px 16px;
        }

        .nexora-info {
            text-align: center;
        }

        .md-fab {
            bottom: 20px;
            right: 20px;
        }
    }

    @media (max-width: 768px) {
        .top-app-bar-content {
            flex-direction: column;
            gap: 20px;
            align-items: flex-start;
            height: auto;
            padding: 20px 0;
        }

        .top-app-bar {
            height: auto;
        }

        .top-app-bar-actions {
            width: 100%;
            justify-content: flex-start;
            flex-wrap: wrap;
        }

        .md-button {
            width: 100%;
            justify-content: center;
        }

        .md-dialog {
            margin: 20px;
            max-height: calc(100vh - 40px);
        }

        .md-table th,
        .md-table td {
            padding: 16px 12px;
            font-size: var(--md-sys-typescale-body-small-size);
        }

        .action-buttons {
            flex-direction: column;
        }

        .nexora-chat-container {
            height: 300px;
        }

        .nexora-chip {
            padding: 12px;
        }

        .nexora-title {
            font-size: var(--md-sys-typescale-label-medium-size);
        }

        .nexora-subtitle {
            font-size: var(--md-sys-typescale-label-small-size);
        }

        .md-snackbar {
            left: 20px;
            right: 20px;
            transform: translateY(100px);
            max-width: none;
        }

        .md-snackbar.show {
            transform: translateY(0);
        }
    }

    /* Accessibility */
    @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
        }
    }

    /* Focus styles */
    .navigation-link:focus,
    .md-button:focus,
    .md-icon-button:focus,
    .md-fab:focus {
        outline: 2px solid var(--md-sys-color-primary);
        outline-offset: 2px;
    }

    /* High contrast mode support */
    @media (prefers-contrast: high) {
        .md-card {
            border: 1px solid var(--md-sys-color-outline);
        }
        
        .md-button-filled {
            border: 1px solid var(--md-sys-color-outline);
        }
    }
</style>
</head>
<body>
    <!-- Mobile Overlay -->
    <div class="mobile-overlay" id="mobileOverlay"></div>

    <!-- Navigation Rail (Sidebar) -->
    <aside class="navigation-rail" id="sidebar">
        <div class="navigation-rail-header">
            <img src="SILAKBO.png" alt="Silakbo Logo">
            <span class="navigation-rail-title">ANG SILAKBO</span>
            <button class="navigation-rail-toggle" id="sidebarToggle">
                <span class="material-symbols-rounded">menu</span>
            </button>
        </div>

        <nav class="navigation-rail-content">
            <div class="navigation-group">
                <div class="navigation-group-title">Content</div>
                <div class="navigation-item">
                    <a href="#" class="navigation-link active" data-tab="create">
                        <span class="material-symbols-rounded">add_circle</span>
                        <span class="navigation-link-text">New Post</span>
                    </a>
                </div>
                <div class="navigation-item">
                    <a href="#" class="navigation-link" data-tab="manage">
                        <span class="material-symbols-rounded">list_alt</span>
                        <span class="navigation-link-text">Manage Posts</span>
                    </a>
                </div>
            </div>

            <div class="navigation-group">
                <div class="navigation-group-title">Tools</div>
                <div class="navigation-item">
                    <a href="#" class="navigation-link" id="refreshPostsNav">
                        <span class="material-symbols-rounded">refresh</span>
                        <span class="navigation-link-text">Refresh</span>
                    </a>
                </div>
                <div class="navigation-item">
                    <a href="#" class="navigation-link" id="clearFormNav">
                        <span class="material-symbols-rounded">clear_all</span>
                        <span class="navigation-link-text">Reset Form</span>
                    </a>
                </div>
            </div>
        </nav>

        <div class="navigation-rail-footer">
            <div class="navigation-rail-footer-content">
                <div class="status-indicator"></div>
                <div class="status-text" id="sidebarStatus">Ready</div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Top App Bar -->
        <header class="top-app-bar">
            <div class="top-app-bar-content">
                <div class="top-app-bar-left">
                    <button class="mobile-menu-btn" id="mobileMenuBtn">
                        <span class="material-symbols-rounded">menu</span>
                    </button>
                    <h1 class="page-title" id="pageTitle">New Piece</h1>
                </div>
                <div class="top-app-bar-actions" id="headerActions">
                    <!-- Nexora AI Chip -->
                    <div class="nexora-chip" id="nexoraHeaderSection">
                        <img src="Nexora.png" alt="Nexora AI" class="nexora-logo">
                        <div class="nexora-info">
                            <div class="nexora-title">Nexora AI</div>
                            <div class="nexora-subtitle">Writing Assistant</div>
                        </div>
                        <div class="nexora-actions">
                            <button class="nexora-btn" id="openNexoraChat" title="Chat with Nexora">
                                <span class="material-symbols-rounded">chat</span>
                            </button>
                            <button class="nexora-btn" id="checkGrammar" title="Check Grammar">
                                <span class="material-symbols-rounded">spellcheck</span>
                            </button>
                        </div>
                    </div>
                    
                    <button class="md-button md-button-filled" id="submitBtn">
                        <span class="material-symbols-rounded md-18">send</span> Publish
                    </button>
                    <div class="word-count">
                        <span class="material-symbols-rounded md-18">description</span> Words: <span id="wordCount">0</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Body -->
        <div class="main-body">
            <div class="md-card">
                <div class="md-card-content">
                    <!-- Create Post Tab -->
                    <div class="tab-content active" id="createTab">
                        <form id="postForm">
                            <div class="form-group">
                                <div class="md-field">
                                    <label class="md-field-label" for="title">Post Title</label>
                                    <div class="grammar-check-container">
                                        <div class="md-field-container">
                                            <span class="material-symbols-rounded md-field-icon md-18">title</span>
                                            <input type="text" id="title" class="md-text-field" required placeholder="Enter an engaging title for your post">
                                        </div>
                                        <button type="button" class="grammar-check-btn" data-field="title" title="Check grammar">
                                            <span class="material-symbols-rounded">spellcheck</span>
                                        </button>
                                    </div>
                                    <div class="grammar-suggestion" id="titleSuggestion"></div>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <div class="md-field">
                                        <label class="md-field-label" for="category">Category</label>
                                        <div class="md-field-container">
                                            <span class="material-symbols-rounded md-field-icon md-18">folder</span>
                                            <select id="category" class="md-select" required>
                                                <option value="">Select a category</option>
                                                <option value="article">Article</option>
                                                <option value="literary">Literary</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <div class="md-field">
                                        <label class="md-field-label" for="role">Role of the Contributor</label>
                                        <div class="md-field-container">
                                            <span class="material-symbols-rounded md-field-icon md-18">work</span>
                                            <select id="role" class="md-select" required>
                                                <option value="">Select a role</option>
                                                <option value="Photojournalist">Photojournalist</option>
                                                <option value="Cartoonist">Cartoonist</option>
                                                <option value="Cartoonist">Layout Artist</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <div class="md-field">
                                        <label class="md-field-label" for="author">Author</label>
                                        <div class="grammar-check-container">
                                            <div class="md-field-container">
                                                <span class="material-symbols-rounded md-field-icon md-18">person</span>
                                                <input type="text" id="author" class="md-text-field" required placeholder="Enter the author's full name">
                                            </div>
                                            <button type="button" class="grammar-check-btn" data-field="author" title="Check grammar">
                                                <span class="material-symbols-rounded">spellcheck</span>
                                            </button>
                                        </div>
                                        <div class="grammar-suggestion" id="authorSuggestion"></div>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <div class="md-field">
                                        <label class="md-field-label" for="additionalField">Contributors Name</label>
                                        <div class="grammar-check-container">
                                            <div class="md-field-container">
                                                <span class="material-symbols-rounded md-field-icon md-18">badge</span>
                                                <input type="text" id="additionalField" class="md-text-field" placeholder="Enter the person's name for the selected role">
                                            </div>
                                            <button type="button" class="grammar-check-btn" data-field="additionalField" title="Check grammar">
                                                <span class="material-symbols-rounded">spellcheck</span>
                                            </button>
                                        </div>
                                        <div class="grammar-suggestion" id="additionalFieldSuggestion"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <div class="md-field">
                                    <label class="md-field-label" for="imageUpload">Featured Image</label>
                                    <div class="file-input-container">
                                        <label class="file-input-label">
                                            <span class="material-symbols-rounded md-18">cloud_upload</span> Choose Image
                                            <input type="file" id="imageUpload" accept="image/*">
                                        </label>
                                        <span class="file-name" id="fileName">
                                            <span class="material-symbols-rounded md-18">image</span> No image selected
                                        </span>
                                    </div>
                                    <div class="image-preview-container">
                                        <img id="imagePreview" alt="Image Preview">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <div class="md-field">
                                    <label class="md-field-label" for="content">Content</label>
                                    <textarea id="content"></textarea>
                                    <div class="grammar-suggestion" id="contentSuggestion"></div>
                                </div>
                            </div>
                        </form>
                    </div>

                    <!-- Manage Posts Tab -->
                    <div class="tab-content" id="manageTab">
                        <div id="postsTableContainer">
                            <div id="loadingPosts" class="loading-container">
                                <div class="md-progress-circular"></div>
                                <p class="body-large">Loading your posts...</p>
                            </div>
                            
                            <div class="table-container" id="postsTable" style="display: none;">
                                <table class="md-table">
                                    <thead>
                                        <tr>
                                            <th>Title</th>
                                            <th>Category</th>
                                            <th>Author</th>
                                            <th>Role</th>
                                            <th>Role Person</th>
                                            <th>Date</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="postsTableBody"></tbody>
                                </table>
                            </div>
                            
                            <div id="noPostsMessage" class="empty-state" style="display: none;">
                                <span class="material-symbols-rounded">newspaper</span>
                                <p class="body-large">No posts found. Start creating your first post!</p>
                                <button class="md-button md-button-filled" id="createFirstPostBtn">
                                    <span class="material-symbols-rounded md-18">add_circle</span> Create Your First Post
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Floating Action Button -->
    <button class="md-fab" id="fabBtn" title="Quick Actions">
        <span class="material-symbols-rounded">add</span>
    </button>

    <!-- Snackbar -->
    <div class="md-snackbar" id="snackbar">
        <div class="md-snackbar-message" id="snackbarMessage"></div>
        <button class="md-snackbar-action" id="snackbarAction">Dismiss</button>
    </div>

    <!-- Draft Dialog -->
    <div class="md-dialog-backdrop" id="draftModal">
        <div class="md-dialog">
            <div class="md-dialog-header">
                <h3 class="md-dialog-title">
                    <span class="material-symbols-rounded" style="margin-right: 8px;">draft</span>
                    Draft Found
                </h3>
                <button class="md-icon-button" id="closeDraftModal" aria-label="Close dialog">
                    <span class="material-symbols-rounded">close</span>
                </button>
            </div>
            <div class="md-dialog-body">
                <p class="body-large" style="margin-bottom: 24px;">
                    We found a saved draft from your previous session. Would you like to restore it?
                </p>
                
                <div class="draft-info" id="draftInfo" style="background-color: var(--md-sys-color-surface-container); padding: 16px; border-radius: var(--md-sys-shape-corner-medium); margin-bottom: 24px;">
                    <!-- Draft information will be populated here -->
                </div>
                
                <p class="body-small" style="color: var(--md-sys-color-on-surface-variant);">
                    <span class="material-symbols-rounded md-16" style="vertical-align: middle; margin-right: 4px;">info</span>
                    Drafts are automatically saved and expire after 24 hours.
                </p>
            </div>
            <div class="md-dialog-actions">
                <button class="md-button md-button-text" id="discardDraftBtn">
                    <span class="material-symbols-rounded md-18">delete</span> Discard Draft
                </button>
                <button class="md-button md-button-filled" id="restoreDraftBtn">
                    <span class="material-symbols-rounded md-18">restore</span> Restore Draft
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Dialog -->
    <div class="md-dialog-backdrop md-dialog-large" id="editModal">
        <div class="md-dialog">
            <div class="md-dialog-header">
                <h3 class="md-dialog-title">Edit Post</h3>
                <button class="md-icon-button" id="closeEditModal" aria-label="Close dialog">
                    <span class="material-symbols-rounded">close</span>
                </button>
            </div>
            <div class="md-dialog-body">
                <form id="editForm">
                    <input type="hidden" id="editPostId">
                    
                    <div class="form-group">
                        <div class="md-field">
                            <label class="md-field-label" for="editTitle">Post Title</label>
                            <div class="md-field-container">
                                <span class="material-symbols-rounded md-field-icon md-18">title</span>
                                <input type="text" id="editTitle" class="md-text-field" required placeholder="Enter post title">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <div class="md-field">
                                <label class="md-field-label" for="editCategory">Category</label>
                                <div class="md-field-container">
                                    <span class="material-symbols-rounded md-field-icon md-18">folder</span>
                                    <select id="editCategory" class="md-select" required>
                                        <option value="article">Article</option>
                                        <option value="literary">Literary</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <div class="md-field">
                                <label class="md-field-label" for="editRole">Role</label>
                                <div class="md-field-container">
                                    <span class="material-symbols-rounded md-field-icon md-18">work</span>
                                    <select id="editRole" class="md-select" required>
                                        <option value="Photojournalist">Photojournalist</option>
                                        <option value="Cartoonist">Cartoonist</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <div class="md-field">
                                <label class="md-field-label" for="editAuthor">Author</label>
                                <div class="md-field-container">
                                    <span class="material-symbols-rounded md-field-icon md-18">person</span>
                                    <input type="text" id="editAuthor" class="md-text-field" required placeholder="Enter author's name">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <div class="md-field">
                                <label class="md-field-label" for="editAdditionalField">Role Person</label>
                                <div class="md-field-container">
                                    <span class="material-symbols-rounded md-field-icon md-18">badge</span>
                                    <input type="text" id="editAdditionalField" class="md-text-field" placeholder="Enter the person's name for the selected role">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <div class="md-field">
                            <label class="md-field-label" for="editImageUpload">Featured Image</label>
                            <div class="file-input-container">
                                <label class="file-input-label">
                                    <span class="material-symbols-rounded md-18">cloud_upload</span> Choose Image
                                    <input type="file" id="editImageUpload" accept="image/*">
                                </label>
                                <span class="file-name" id="editFileName">
                                    <span class="material-symbols-rounded md-18">image</span> No image selected
                                </span>
                            </div>
                            <div class="image-preview-container">
                                <img id="editImagePreview" alt="Image Preview">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <div class="md-field">
                            <label class="md-field-label" for="editContent">Content</label>
                            <textarea id="editContent"></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="md-dialog-actions">
                <button class="md-button md-button-text" id="cancelEditBtn">
                    <span class="material-symbols-rounded md-18">close</span> Cancel
                </button>
                <button class="md-button md-button-filled" id="saveEditBtn">
                    <span class="material-symbols-rounded md-18">save</span> Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- Delete Dialog -->
    <div class="md-dialog-backdrop" id="deleteModal">
        <div class="md-dialog">
            <div class="md-dialog-header">
                <h3 class="md-dialog-title">Delete Post</h3>
                <button class="md-icon-button" id="closeDeleteModal" aria-label="Close dialog">
                    <span class="material-symbols-rounded">close</span>
                </button>
            </div>
            <div class="md-dialog-body">
                <p class="body-large">Are you sure you want to delete this post? This action cannot be undone.</p>
                <input type="hidden" id="deletePostId">
            </div>
            <div class="md-dialog-actions">
                <button class="md-button md-button-text" id="cancelDeleteBtn">
                    <span class="material-symbols-rounded md-18">close</span> Cancel
                </button>
                <button class="md-button md-button-danger" id="confirmDeleteBtn">
                    <span class="material-symbols-rounded md-18">delete</span> Delete Post
                </button>
            </div>
        </div>
    </div>

    <!-- View Dialog -->
    <div class="md-dialog-backdrop md-dialog-large" id="viewModal">
        <div class="md-dialog">
            <div class="md-dialog-header">
                <h3 class="md-dialog-title">View Post</h3>
                <button class="md-icon-button" id="closeViewModal" aria-label="Close dialog">
                    <span class="material-symbols-rounded">close</span>
                </button>
            </div>
            <div class="md-dialog-body">
                <div id="viewPostContent"></div>
            </div>
            <div class="md-dialog-actions">
                <button class="md-button md-button-text" id="closeViewBtn">
                    <span class="material-symbols-rounded md-18">close</span> Close
                </button>
                <button class="md-button md-button-filled" id="editFromViewBtn">
                    <span class="material-symbols-rounded md-18">edit</span> Edit Post
                </button>
            </div>
        </div>
    </div>

    <!-- Nexora Chat Dialog -->
    <div class="md-dialog-backdrop nexora-dialog" id="nexoraModal">
        <div class="md-dialog">
            <div class="md-dialog-header">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <img src="Nexora.png" alt="Nexora AI" style="width: 24px; height: 24px; border-radius: 50%;">
                    <h3 class="md-dialog-title">Nexora AI Assistant</h3>
                </div>
                <button class="md-icon-button" id="closeNexoraModal" aria-label="Close dialog">
                    <span class="material-symbols-rounded">close</span>
                </button>
            </div>
            <div class="md-dialog-body">
                <div class="nexora-chat-container">
                    <div class="nexora-messages" id="nexoraMessages">
                        <div class="nexora-message assistant">
                            <div class="nexora-message-avatar">
                                <span class="material-symbols-rounded">smart_toy</span>
                            </div>
                            <div class="nexora-message-content">
                                <p>Hello! I'm Nexora, your AI writing assistant. I can help you with grammar corrections, content suggestions, and answer any questions about your writing. How can I assist you today?</p>
                            </div>
                        </div>
                    </div>
                    <div class="nexora-input-container">
                        <input type="text" class="nexora-input" id="nexoraInput" placeholder="Ask Nexora anything...">
                        <button class="nexora-send-btn" id="nexoraSendBtn">
                            <span class="material-symbols-rounded">send</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Supabase
        const supabaseUrl = "https://uyxgsziyflquisckdwwc.supabase.co";
        const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV5eGdzeml5ZmxxdWlzY2tkd3djIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE1OTQyODUsImV4cCI6MjA1NzE3MDI4NX0.DoIEoWWuajDpBhD2UwLYzrKRyZNyBP4izasROCdIbkk";
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        // Cohere API configuration
        const COHERE_API_KEY = "z99HUO9u2vu9E4YTRRfeue6hbdkdOcM8zWQDfbcq";
        const COHERE_API_URL = "https://api.cohere.ai/v1/generate";

        // Global state
        let currentTab = 'create';
        let sidebarCollapsed = false;
        let draftData = null;

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            initializeTinyMCE();
            initializeEventListeners();
            loadPosts();
            updateStatus('Ready');
            
            // Initialize Nexora aura glow for 5 seconds
            initializeNexoraAura();
        });

        // Initialize Nexora aura effect
        function initializeNexoraAura() {
            const nexoraSection = document.getElementById('nexoraHeaderSection');
            nexoraSection.classList.add('aura-glow');
            
            // Remove aura after 5 seconds
            setTimeout(() => {
                nexoraSection.classList.remove('aura-glow');
            }, 5000);
        }

        // Toggle Nexora aura effect
        function toggleNexoraAura() {
            const nexoraSection = document.getElementById('nexoraHeaderSection');
            nexoraSection.classList.toggle('aura-glow');
        }

        // Initialize TinyMCE with basic features only
        function initializeTinyMCE() {
            tinymce.init({
                selector: '#content, #editContent',
                plugins: 'autolink lists link image charmap searchreplace visualblocks code fullscreen media table wordcount',
                toolbar: 'undo redo | formatselect | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image media | code fullscreen',
                height: 400,
                menubar: false,
                statusbar: true,
                branding: false,
                promotion: false,
                content_css: 'default',
                font_family_formats: 'Merriweather=Merriweather,serif; Playfair Display=Playfair Display,serif; Poppins=Poppins,sans-serif; Source Sans Pro=Source Sans Pro,sans-serif; Arial=arial,helvetica,sans-serif; Times New Roman=times new roman,times,serif; Courier New=courier new,courier,monospace',
                setup: function(editor) {
                    editor.on('keyup change', function() {
                        updateWordCount(editor);
                    });
                    
                    editor.on('init', function() {
                        updateWordCount(editor);
                    });
                }
            });
        }

        // Update word count
        function updateWordCount(editor) {
            const content = editor.getContent({ format: 'text' });
            const wordCount = content.trim().split(/\s+/).filter(word => word.length > 0).length;
            document.getElementById('wordCount').textContent = wordCount || 0;
        }

        // Initialize event listeners
        function initializeEventListeners() {
            // Navigation
            document.querySelectorAll('.navigation-link[data-tab]').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    switchTab(link.getAttribute('data-tab'));
                });
            });

            // Sidebar toggle
            document.getElementById('sidebarToggle').addEventListener('click', toggleSidebar);
            document.getElementById('mobileMenuBtn').addEventListener('click', toggleMobileSidebar);
            document.getElementById('mobileOverlay').addEventListener('click', closeMobileSidebar);

            // Navigation actions
            document.getElementById('refreshPostsNav').addEventListener('click', (e) => {
                e.preventDefault();
                loadPosts();
                showSnackbar('Posts refreshed', 'success');
            });

            document.getElementById('clearFormNav').addEventListener('click', (e) => {
                e.preventDefault();
                clearForm();
            });

            // Nexora AI actions
            document.getElementById('openNexoraChat').addEventListener('click', () => {
                toggleNexoraAura();
                openDialog('nexoraModal');
            });
            document.getElementById('checkGrammar').addEventListener('click', () => {
                toggleNexoraAura();
                checkAllGrammar();
            });
            document.getElementById('nexoraSendBtn').addEventListener('click', sendNexoraMessage);
            document.getElementById('nexoraInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendNexoraMessage();
            });

            // Grammar check buttons
            document.querySelectorAll('.grammar-check-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    const field = btn.getAttribute('data-field');
                    checkGrammar(field);
                });
            });

            // Image upload handlers
            document.getElementById('imageUpload').addEventListener('change', (e) => handleImageUpload(e, 'imagePreview', 'fileName'));
            document.getElementById('editImageUpload').addEventListener('change', (e) => handleImageUpload(e, 'editImagePreview', 'editFileName'));

            // Form and button handlers
            document.getElementById('submitBtn').addEventListener('click', handleSubmit);
            document.getElementById('createFirstPostBtn').addEventListener('click', () => switchTab('create'));
            document.getElementById('fabBtn').addEventListener('click', () => switchTab('create'));

            // Draft dialog handlers
            document.getElementById('restoreDraftBtn').addEventListener('click', restoreDraft);
            document.getElementById('discardDraftBtn').addEventListener('click', discardDraft);
            document.getElementById('closeDraftModal').addEventListener('click', () => closeDialog('draftModal'));

            // Dialog handlers
            document.getElementById('saveEditBtn').addEventListener('click', handleEditSave);
            document.getElementById('confirmDeleteBtn').addEventListener('click', handleDelete);
            document.getElementById('editFromViewBtn').addEventListener('click', function() {
                const postId = this.getAttribute('data-id');
                closeDialog('viewModal');
                openEditModal(postId);
            });

            // Dialog close handlers
            ['closeEditModal', 'cancelEditBtn', 'closeDeleteModal', 'cancelDeleteBtn', 'closeViewModal', 'closeViewBtn', 'closeNexoraModal'].forEach(id => {
                document.getElementById(id).addEventListener('click', () => {
                    const dialogId = id.includes('Edit') ? 'editModal' : 
                                   id.includes('Delete') ? 'deleteModal' : 
                                   id.includes('Nexora') ? 'nexoraModal' : 'viewModal';
                    closeDialog(dialogId);
                });
            });

            // Snackbar action
            document.getElementById('snackbarAction').addEventListener('click', hideSnackbar);

            // Click outside dialog to close
            document.querySelectorAll('.md-dialog-backdrop').forEach(backdrop => {
                backdrop.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeDialog(this.id);
                    }
                });
            });

            // Keyboard shortcuts
            document.addEventListener('keydown', handleKeyboardShortcuts);
        }

        // Cohere API functions
        async function callCohereAPI(prompt, maxTokens = 100) {
            try {
                const response = await fetch(COHERE_API_URL, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${COHERE_API_KEY}`,
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        model: 'command',
                        prompt: prompt,
                        max_tokens: maxTokens,
                        temperature: 0.3,
                        k: 0,
                        stop_sequences: [],
                        return_likelihoods: 'NONE'
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                return data.generations[0].text.trim();
            } catch (error) {
                console.error('Cohere API error:', error);
                throw error;
            }
        }

        // Grammar checking functions
        async function checkGrammar(fieldId) {
            const field = document.getElementById(fieldId);
            const text = field.value.trim();
            
            if (!text) {
                showSnackbar('Please enter some text to check', 'error');
                return;
            }

            const suggestionDiv = document.getElementById(`${fieldId}Suggestion`);
            suggestionDiv.innerHTML = `
                <div class="grammar-suggestion-header">
                    <span class="material-symbols-rounded md-18">hourglass_empty</span>
                    Checking grammar...
                </div>
            `;
            suggestionDiv.classList.add('active');

            try {
                const prompt = `Please check the following text for grammar, spelling, and style errors. Provide a corrected version if needed. If the text is already correct, just say "No corrections needed."

Text to check: "${text}"

Corrected version:`;

                const correction = await callCohereAPI(prompt, 150);
                
                if (correction.toLowerCase().includes('no corrections needed') || correction.toLowerCase().includes('already correct')) {
                    suggestionDiv.innerHTML = `
                        <div class="grammar-suggestion-header">
                            <span class="material-symbols-rounded md-18">check_circle</span>
                            Grammar Check Complete
                        </div>
                        <div class="grammar-suggestion-content">
                            Your text looks great! No corrections needed.
                        </div>
                        <div class="grammar-suggestion-actions">
                            <button class="grammar-suggestion-btn dismiss" onclick="dismissSuggestion('${fieldId}')">
                                Dismiss
                            </button>
                        </div>
                    `;
                } else {
                    suggestionDiv.innerHTML = `
                        <div class="grammar-suggestion-header">
                            <span class="material-symbols-rounded md-18">edit</span>
                            Grammar Suggestion
                        </div>
                        <div class="grammar-suggestion-content">
                            <strong>Suggested correction:</strong><br>
                            ${correction}
                        </div>
                        <div class="grammar-suggestion-actions">
                            <button class="grammar-suggestion-btn accept" onclick="acceptSuggestion('${fieldId}', \`${correction.replace(/`/g, '\\`')}\`)">
                                Accept
                            </button>
                            <button class="grammar-suggestion-btn dismiss" onclick="dismissSuggestion('${fieldId}')">
                                Dismiss
                            </button>
                        </div>
                    `;
                }
            } catch (error) {
                suggestionDiv.innerHTML = `
                    <div class="grammar-suggestion-header">
                        <span class="material-symbols-rounded md-18">error</span>
                        Error
                    </div>
                    <div class="grammar-suggestion-content">
                        Unable to check grammar at this time. Please try again later.
                    </div>
                    <div class="grammar-suggestion-actions">
                        <button class="grammar-suggestion-btn dismiss" onclick="dismissSuggestion('${fieldId}')">
                            Dismiss
                        </button>
                    </div>
                `;
            }
        }

        async function checkAllGrammar() {
            const fields = ['title', 'author', 'additionalField'];
            updateStatus('Checking grammar for all fields...');
            
            for (const field of fields) {
                const fieldElement = document.getElementById(field);
                if (fieldElement.value.trim()) {
                    await checkGrammar(field);
                    await new Promise(resolve => setTimeout(resolve, 1000)); // Rate limiting
                }
            }
            
            updateStatus('Grammar check complete');
            showSnackbar('Grammar check complete', 'success');
        }

        function acceptSuggestion(fieldId, suggestion) {
            document.getElementById(fieldId).value = suggestion;
            dismissSuggestion(fieldId);
            updateStatus('Suggestion applied');
            showSnackbar('Suggestion applied', 'success');
        }

        function dismissSuggestion(fieldId) {
            const suggestionDiv = document.getElementById(`${fieldId}Suggestion`);
            suggestionDiv.classList.remove('active');
        }

        // Nexora chat functions
        async function sendNexoraMessage() {
            const input = document.getElementById('nexoraInput');
            const message = input.value.trim();
            
            if (!message) return;

            const messagesContainer = document.getElementById('nexoraMessages');
            
            // Add user message
            addNexoraMessage('user', message);
            input.value = '';

            // Add typing indicator
            const typingDiv = document.createElement('div');
            typingDiv.className = 'nexora-message assistant';
            typingDiv.innerHTML = `
                <div class="nexora-message-avatar">
                    <span class="material-symbols-rounded">smart_toy</span>
                </div>
                <div class="nexora-message-content">
                    <span class="material-symbols-rounded">more_horiz</span> Nexora is thinking...
                </div>
            `;
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            try {
                const prompt = `You are Nexora, a helpful AI writing assistant. You help with grammar, writing suggestions, content creation, and general writing questions. Please respond to this user message in a helpful and friendly way:

User: ${message}

Nexora:`;

                const response = await callCohereAPI(prompt, 200);
                
                // Remove typing indicator
                messagesContainer.removeChild(typingDiv);
                
                // Add AI response
                addNexoraMessage('assistant', response);
                
            } catch (error) {
                // Remove typing indicator
                messagesContainer.removeChild(typingDiv);
                
                // Add error message
                addNexoraMessage('assistant', 'I apologize, but I\'m having trouble connecting right now. Please try again in a moment.');
            }
        }

        function addNexoraMessage(sender, content) {
            const messagesContainer = document.getElementById('nexoraMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `nexora-message ${sender}`;
            
            const avatar = sender === 'user' ? 
                '<span class="material-symbols-rounded">person</span>' : 
                '<span class="material-symbols-rounded">smart_toy</span>';
            
            messageDiv.innerHTML = `
                <div class="nexora-message-avatar">
                    ${avatar}
                </div>
                <div class="nexora-message-content">
                    <p>${content}</p>
                </div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Sidebar functions
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebarCollapsed = !sidebarCollapsed;
            
            if (sidebarCollapsed) {
                sidebar.classList.add('collapsed');
            } else {
                sidebar.classList.remove('collapsed');
            }
        }

        function toggleMobileSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobileOverlay');
            
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
        }

        function closeMobileSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobileOverlay');
            
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
        }

        // Tab switching
        function switchTab(tabId) {
            currentTab = tabId;
            
            // Update navigation
            document.querySelectorAll('.navigation-link[data-tab]').forEach(link => link.classList.remove('active'));
            document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`${tabId}Tab`).classList.add('active');

            // Update page title and show/hide publish button
            const pageTitle = document.getElementById('pageTitle');
            const submitBtn = document.getElementById('submitBtn');
            
            if (tabId === 'create') {
                pageTitle.textContent = 'New Post';
                submitBtn.style.display = 'flex';
            } else {
                pageTitle.textContent = 'Manage Posts';
                submitBtn.style.display = 'none';
                loadPosts();
            }

            // Close mobile sidebar
            closeMobileSidebar();

            updateStatus(tabId === 'create' ? 'Ready to create' : 'Viewing posts');
        }

        // Handle image upload
        function handleImageUpload(event, previewId, fileNameId) {
            const file = event.target.files[0];
            if (file) {
                // Validate file size (max 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    showSnackbar('Image size must be less than 5MB', 'error');
                    event.target.value = '';
                    return;
                }

                // Validate file type
                if (!file.type.startsWith('image/')) {
                    showSnackbar('Please select a valid image file', 'error');
                    event.target.value = '';
                    return;
                }

                const reader = new FileReader();
                reader.onload = function(e) {
                    const imgPreview = document.getElementById(previewId);
                    imgPreview.src = e.target.result;
                    imgPreview.style.display = 'block';
                    document.getElementById(fileNameId).innerHTML = `<span class="material-symbols-rounded md-18">image</span> ${file.name}`;
                    updateStatus('Image selected');
                };
                reader.readAsDataURL(file);
            }
        }

        // Handle form submission
        async function handleSubmit() {
            const submitBtn = document.getElementById('submitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Validate form
            if (!validateForm()) return;

            // Disable button and show loading
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="material-symbols-rounded md-18">hourglass_empty</span> Publishing...';
            updateStatus('Publishing post...');

            try {
                const formData = getFormData();
                let imageUrl = '';

                // Upload image if present
                if (formData.imageFile) {
                    imageUrl = await uploadToCloudinary(formData.imageFile);
                }

                // Save to Supabase
                const { error } = await supabase.from("posts").insert([{
                    category: formData.category,
                    title: formData.title,
                    author: formData.author,
                    role: formData.role,
                    role_person: formData.rolePerson,
                    content: formData.content,
                    image_url: imageUrl,
                    created_at: new Date().toISOString()
                }]);

                if (error) throw new Error(error.message);

                showSnackbar('Post published successfully!', 'success');
                clearForm();
                updateStatus('Post published');

                // Clear draft after successful publish
                localStorage.removeItem('angSilakboDraft');

                // Refresh posts if on manage tab
                if (currentTab === 'manage') {
                    loadPosts();
                }

            } catch (error) {
                console.error('Error publishing post:', error);
                showSnackbar(error.message || 'Error publishing post', 'error');
                updateStatus('Error publishing');
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
            }
        }

        // Validate form
        function validateForm() {
            const title = document.getElementById('title').value.trim();
            const category = document.getElementById('category').value;
            const author = document.getElementById('author').value.trim();
            const role = document.getElementById('role').value;
            const content = tinymce.get('content').getContent().trim();

            if (!title) {
                showSnackbar('Please enter a title', 'error');
                document.getElementById('title').focus();
                return false;
            }

            if (!category) {
                showSnackbar('Please select a category', 'error');
                document.getElementById('category').focus();
                return false;
            }

            if (!author) {
                showSnackbar('Please enter an author name', 'error');
                document.getElementById('author').focus();
                return false;
            }

            if (!role) {
                showSnackbar('Please select a role', 'error');
                document.getElementById('role').focus();
                return false;
            }

            if (!content) {
                showSnackbar('Please enter some content', 'error');
                tinymce.get('content').focus();
                return false;
            }

            return true;
        }

        // Get form data
        function getFormData() {
            return {
                title: document.getElementById('title').value.trim(),
                category: document.getElementById('category').value,
                author: document.getElementById('author').value.trim(),
                role: document.getElementById('role').value,
                rolePerson: document.getElementById('additionalField').value.trim(),
                content: tinymce.get('content').getContent(),
                imageFile: document.getElementById('imageUpload').files[0]
            };
        }

        // Upload to Cloudinary
        async function uploadToCloudinary(file) {
            const formData = new FormData();
            formData.append("file", file);
            formData.append("upload_preset", "Ang Silakbo");

            const response = await fetch("https://api.cloudinary.com/v1_1/ddalveuw6/image/upload", {
                method: "POST",
                body: formData
            });

            const data = await response.json();
            if (data.error) throw new Error(data.error.message);
            return data.secure_url;
        }

        // Clear form
        function clearForm() {
            document.getElementById('postForm').reset();
            tinymce.get('content').setContent('');
            document.getElementById('imagePreview').style.display = 'none';
            document.getElementById('fileName').innerHTML = '<span class="material-symbols-rounded md-18">image</span> No image selected';
            
            // Clear all grammar suggestions
            document.querySelectorAll('.grammar-suggestion').forEach(suggestion => {
                suggestion.classList.remove('active');
            });
            
            updateStatus('Form cleared');
            showSnackbar('Form cleared', 'success');
        }

        // Draft functions
        function showDraftModal(draft) {
            draftData = draft;
            const draftInfo = document.getElementById('draftInfo');
            const date = new Date(draft.timestamp);
            const timeAgo = getTimeAgo(date);
            
            draftInfo.innerHTML = `
                <div style="display: grid; gap: 8px;">
                    <div style="display: flex; justify-content: space-between;">
                        <span style="font-weight: 600;">Title:</span>
                        <span>${draft.title || 'Untitled'}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="font-weight: 600;">Author:</span>
                        <span>${draft.author || 'Not specified'}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="font-weight: 600;">Category:</span>
                        <span>${draft.category || 'Not selected'}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="font-weight: 600;">Last saved:</span>
                        <span>${timeAgo}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="font-weight: 600;">Content length:</span>
                        <span>${draft.content ? draft.content.length : 0} characters</span>
                    </div>
                </div>
            `;
            
            openDialog('draftModal');
        }

        function restoreDraft() {
            if (draftData) {
                document.getElementById('title').value = draftData.title || '';
                document.getElementById('category').value = draftData.category || '';
                document.getElementById('author').value = draftData.author || '';
                document.getElementById('role').value = draftData.role || '';
                document.getElementById('additionalField').value = draftData.rolePerson || '';
                
                // Wait for TinyMCE to initialize
                const checkTinyMCE = setInterval(() => {
                    if (tinymce.get('content')) {
                        tinymce.get('content').setContent(draftData.content || '');
                        clearInterval(checkTinyMCE);
                    }
                }, 100);
                
                updateStatus('Draft restored');
                closeDialog('draftModal');
                showSnackbar('Draft restored successfully!', 'success');
            }
        }

        function discardDraft() {
            localStorage.removeItem('angSilakboDraft');
            draftData = null;
            closeDialog('draftModal');
            updateStatus('Draft discarded');
            showSnackbar('Draft discarded', 'success');
        }

        function getTimeAgo(date) {
            const now = new Date();
            const diffInSeconds = Math.floor((now - date) / 1000);
            
            if (diffInSeconds < 60) return 'Just now';
            if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)} minutes ago`;
            if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)} hours ago`;
            return `${Math.floor(diffInSeconds / 86400)} days ago`;
        }

        // Load posts
        async function loadPosts() {
            const loadingElement = document.getElementById('loadingPosts');
            const tableElement = document.getElementById('postsTable');
            const noPostsMessage = document.getElementById('noPostsMessage');

            // Show loading state
            loadingElement.style.display = 'block';
            tableElement.style.display = 'none';
            noPostsMessage.style.display = 'none';
            updateStatus('Loading posts...');

            try {
                const { data, error } = await supabase
                    .from('posts')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) throw new Error(error.message);

                const tableBody = document.getElementById('postsTableBody');
                tableBody.innerHTML = '';

                if (data && data.length > 0) {
                    data.forEach(post => {
                        const row = createPostRow(post);
                        tableBody.appendChild(row);
                    });

                    tableElement.style.display = 'block';
                    attachTableEventListeners();
                    updateStatus(`${data.length} posts loaded`);
                } else {
                    noPostsMessage.style.display = 'block';
                    updateStatus('No posts found');
                }

            } catch (error) {
                console.error('Error loading posts:', error);
                showSnackbar(error.message || 'Error loading posts', 'error');
                updateStatus('Error loading posts');
            } finally {
                loadingElement.style.display = 'none';
            }
        }

        // Create post row
        function createPostRow(post) {
            const row = document.createElement('tr');
            const date = new Date(post.created_at);
            const formattedDate = date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });

            row.innerHTML = `
                <td><strong>${post.title || 'Untitled'}</strong></td>
                <td><span class="md-badge md-badge-${post.category}">${post.category.charAt(0).toUpperCase() + post.category.slice(1)}</span></td>
                <td>${post.author}</td>
                <td>${post.role || '-'}</td>
                <td>${post.role_person || '-'}</td>
                <td>${formattedDate}</td>
                <td>
                    <div class="action-buttons">
                        <button class="md-icon-button success" data-id="${post.id}" title="View post">
                            <span class="material-symbols-rounded md-18">visibility</span>
                        </button>
                        <button class="md-icon-button info" data-id="${post.id}" title="Edit post">
                            <span class="material-symbols-rounded md-18">edit</span>
                        </button>
                        <button class="md-icon-button danger" data-id="${post.id}" title="Delete post">
                            <span class="material-symbols-rounded md-18">delete</span>
                        </button>
                    </div>
                </td>
            `;

            return row;
        }

        // Attach table event listeners
        function attachTableEventListeners() {
            document.querySelectorAll('.md-icon-button.success').forEach(button => {
                button.addEventListener('click', () => openViewModal(button.getAttribute('data-id')));
            });

            document.querySelectorAll('.md-icon-button.info').forEach(button => {
                button.addEventListener('click', () => openEditModal(button.getAttribute('data-id')));
            });

            document.querySelectorAll('.md-icon-button.danger').forEach(button => {
                button.addEventListener('click', () => openDeleteModal(button.getAttribute('data-id')));
            });
        }

        // Modal functions
        async function openViewModal(postId) {
            try {
                const { data, error } = await supabase
                    .from('posts')
                    .select('*')
                    .eq('id', postId)
                    .single();

                if (error) throw new Error(error.message);

                const viewContent = document.getElementById('viewPostContent');
                const date = new Date(data.created_at);
                const formattedDate = date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });

                viewContent.innerHTML = `
                    <div class="post-view">
                        <div class="post-header">
                            <h1 class="post-title">${data.title}</h1>
                            <div class="post-meta">
                                <div class="meta-item">
                                    <span class="material-symbols-rounded">person</span>
                                    <span>By ${data.author}</span>
                                </div>
                                <div class="meta-item">
                                    <span class="material-symbols-rounded">calendar_today</span>
                                    <span>${formattedDate}</span>
                                </div>
                                <div class="meta-item">
                                    <span class="material-symbols-rounded">folder</span>
                                    <span class="md-badge md-badge-${data.category}">${data.category.charAt(0).toUpperCase() + data.category.slice(1)}</span>
                                </div>
                                ${data.role ? `
                                <div class="meta-item">
                                    <span class="material-symbols-rounded">work</span>
                                    <span>${data.role}${data.role_person ? ': ' + data.role_person : ''}</span>
                                </div>
                                ` : ''}
                            </div>
                        </div>
                        ${data.image_url ? `<img src="${data.image_url}" alt="Featured image" style="width: 100%; max-width: 600px; height: auto; border-radius: var(--md-sys-shape-corner-large); margin-bottom: 32px;">` : ''}
                        <div class="post-content">
                            ${data.content}
                        </div>
                    </div>
                `;

                document.getElementById('editFromViewBtn').setAttribute('data-id', postId);
                openDialog('viewModal');

            } catch (error) {
                console.error('Error loading post:', error);
                showSnackbar('Error loading post', 'error');
            }
        }

        async function openEditModal(postId) {
            try {
                const { data, error } = await supabase
                    .from('posts')
                    .select('*')
                    .eq('id', postId)
                    .single();

                if (error) throw new Error(error.message);

                // Populate edit form
                document.getElementById('editPostId').value = data.id;
                document.getElementById('editTitle').value = data.title;
                document.getElementById('editCategory').value = data.category;
                document.getElementById('editAuthor').value = data.author;
                document.getElementById('editRole').value = data.role || '';
                document.getElementById('editAdditionalField').value = data.role_person || '';

                // Handle image
                if (data.image_url) {
                    document.getElementById('editImagePreview').src = data.image_url;
                    document.getElementById('editImagePreview').style.display = 'block';
                    document.getElementById('editFileName').innerHTML = '<span class="material-symbols-rounded md-18">image</span> Current image';
                } else {
                    document.getElementById('editImagePreview').style.display = 'none';
                    document.getElementById('editFileName').innerHTML = '<span class="material-symbols-rounded md-18">image</span> No image selected';
                }

                // Wait for TinyMCE to initialize
                const checkTinyMCE = setInterval(() => {
                    if (tinymce.get('editContent')) {
                        tinymce.get('editContent').setContent(data.content || '');
                        clearInterval(checkTinyMCE);
                    }
                }, 100);

                openDialog('editModal');

            } catch (error) {
                console.error('Error loading post for edit:', error);
                showSnackbar('Error loading post', 'error');
            }
        }

        function openDeleteModal(postId) {
            document.getElementById('deletePostId').value = postId;
            openDialog('deleteModal');
        }

        // Handle edit save
        async function handleEditSave() {
            const saveBtn = document.getElementById('saveEditBtn');
            const originalText = saveBtn.innerHTML;
            
            saveBtn.disabled = true;
            saveBtn.innerHTML = '<span class="material-symbols-rounded md-18">hourglass_empty</span> Saving...';
            updateStatus('Saving changes...');

            try {
                const postId = document.getElementById('editPostId').value;
                const title = document.getElementById('editTitle').value.trim();
                const category = document.getElementById('editCategory').value;
                const author = document.getElementById('editAuthor').value.trim();
                const role = document.getElementById('editRole').value;
                const rolePerson = document.getElementById('editAdditionalField').value.trim();
                const content = tinymce.get('editContent').getContent();
                const imageFile = document.getElementById('editImageUpload').files[0];

                if (!title || !category || !author || !role || !content) {
                    showSnackbar('Please fill in all required fields', 'error');
                    return;
                }

                let updateData = {
                    title,
                    category,
                    author,
                    role,
                    role_person: rolePerson,
                    content,
                    updated_at: new Date().toISOString()
                };

                // Upload new image if selected
                if (imageFile) {
                    const imageUrl = await uploadToCloudinary(imageFile);
                    updateData.image_url = imageUrl;
                }

                const { error } = await supabase
                    .from('posts')
                    .update(updateData)
                    .eq('id', postId);

                if (error) throw new Error(error.message);

                showSnackbar('Post updated successfully!', 'success');
                closeDialog('editModal');
                loadPosts();
                updateStatus('Post updated');

            } catch (error) {
                console.error('Error updating post:', error);
                showSnackbar(error.message || 'Error updating post', 'error');
                updateStatus('Error updating');
            } finally {
                saveBtn.disabled = false;
                saveBtn.innerHTML = originalText;
            }
        }

        // Handle delete
        async function handleDelete() {
            const deleteBtn = document.getElementById('confirmDeleteBtn');
            const originalText = deleteBtn.innerHTML;
            
            deleteBtn.disabled = true;
            deleteBtn.innerHTML = '<span class="material-symbols-rounded md-18">hourglass_empty</span> Deleting...';
            updateStatus('Deleting post...');

            try {
                const postId = document.getElementById('deletePostId').value;

                const { error } = await supabase
                    .from('posts')
                    .delete()
                    .eq('id', postId);

                if (error) throw new Error(error.message);

                showSnackbar('Post deleted successfully!', 'success');
                closeDialog('deleteModal');
                loadPosts();
                updateStatus('Post deleted');

            } catch (error) {
                console.error('Error deleting post:', error);
                showSnackbar(error.message || 'Error deleting post', 'error');
                updateStatus('Error deleting');
            } finally {
                deleteBtn.disabled = false;
                deleteBtn.innerHTML = originalText;
            }
        }

        // Dialog functions
        function openDialog(dialogId) {
            const dialog = document.getElementById(dialogId);
            dialog.style.display = 'flex';
            setTimeout(() => dialog.classList.add('active'), 10);
            document.body.style.overflow = 'hidden';
        }

        function closeDialog(dialogId) {
            const dialog = document.getElementById(dialogId);
            dialog.classList.remove('active');
            setTimeout(() => {
                dialog.style.display = 'none';
                document.body.style.overflow = '';
            }, 300);
        }

        // Snackbar functions
        function showSnackbar(message, type = 'info') {
            const snackbar = document.getElementById('snackbar');
            const messageElement = document.getElementById('snackbarMessage');
            
            messageElement.textContent = message;
            snackbar.className = `md-snackbar ${type}`;
            snackbar.classList.add('show');

            // Auto hide after 4 seconds
            setTimeout(() => {
                hideSnackbar();
            }, 4000);
        }

        function hideSnackbar() {
            const snackbar = document.getElementById('snackbar');
            snackbar.classList.remove('show');
        }

        // Update status
        function updateStatus(status) {
            document.getElementById('sidebarStatus').textContent = status;
        }

        // Keyboard shortcuts
        function handleKeyboardShortcuts(e) {
            // Ctrl/Cmd + S to save
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                if (currentTab === 'create') {
                    handleSubmit();
                }
            }

            // Ctrl/Cmd + N for new post
            if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                e.preventDefault();
                switchTab('create');
            }

            // Ctrl/Cmd + M for manage posts
            if ((e.ctrlKey || e.metaKey) && e.key === 'm') {
                e.preventDefault();
                switchTab('manage');
            }

            // Escape to close dialogs
            if (e.key === 'Escape') {
                const activeDialog = document.querySelector('.md-dialog-backdrop.active');
                if (activeDialog) {
                    closeDialog(activeDialog.id);
                }
            }
        }

        // Auto-save draft functionality
        let autoSaveTimer;

        function startAutoSave() {
            // Clear existing timer
            if (autoSaveTimer) {
                clearInterval(autoSaveTimer);
            }

            // Auto-save every 30 seconds
            autoSaveTimer = setInterval(() => {
                saveDraft();
            }, 30000);
        }

        function saveDraft() {
            const formData = {
                title: document.getElementById('title').value.trim(),
                category: document.getElementById('category').value,
                author: document.getElementById('author').value.trim(),
                role: document.getElementById('role').value,
                rolePerson: document.getElementById('additionalField').value.trim(),
                content: tinymce.get('content') ? tinymce.get('content').getContent() : '',
                timestamp: new Date().toISOString()
            };

            // Only save if there's meaningful content
            if (formData.title || formData.author || formData.content) {
                localStorage.setItem('angSilakboDraft', JSON.stringify(formData));
                updateStatus('Draft saved');
            }
        }

        function checkForDraft() {
            const savedDraft = localStorage.getItem('angSilakboDraft');
            if (savedDraft) {
                try {
                    const draft = JSON.parse(savedDraft);
                    const draftDate = new Date(draft.timestamp);
                    const now = new Date();
                    const hoursDiff = (now - draftDate) / (1000 * 60 * 60);

                    // Show draft if it's less than 24 hours old
                    if (hoursDiff < 24) {
                        showDraftModal(draft);
                    } else {
                        // Remove expired draft
                        localStorage.removeItem('angSilakboDraft');
                    }
                } catch (error) {
                    console.error('Error parsing draft:', error);
                    localStorage.removeItem('angSilakboDraft');
                }
            }
        }

        // Initialize auto-save when form fields change
        document.addEventListener('DOMContentLoaded', function() {
            // Start auto-save
            startAutoSave();
            
            // Check for existing draft after a short delay
            setTimeout(checkForDraft, 1000);

            // Save draft when form fields change
            ['title', 'category', 'author', 'role', 'additionalField'].forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.addEventListener('input', () => {
                        clearTimeout(autoSaveTimer);
                        setTimeout(saveDraft, 2000); // Save 2 seconds after user stops typing
                        startAutoSave();
                    });
                }
            });
        });

        // Service Worker for offline functionality (optional)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(function(err) {
                        console.log('ServiceWorker registration failed');
                    });
            });
        }

        // Performance monitoring
        window.addEventListener('load', function() {
            // Log performance metrics
            if (window.performance && window.performance.timing) {
                const loadTime = window.performance.timing.loadEventEnd - window.performance.timing.navigationStart;
                console.log('Page load time:', loadTime + 'ms');
            }
        });

        // Error handling for uncaught errors
        window.addEventListener('error', function(e) {
            console.error('Uncaught error:', e.error);
            showSnackbar('An unexpected error occurred', 'error');
        });

        // Handle online/offline status
        window.addEventListener('online', function() {
            showSnackbar('Connection restored', 'success');
            updateStatus('Online');
        });

        window.addEventListener('offline', function() {
            showSnackbar('You are offline', 'error');
            updateStatus('Offline');
        });

        // Cleanup function
        window.addEventListener('beforeunload', function() {
            // Save draft before leaving
            saveDraft();
            
            // Clear auto-save timer
            if (autoSaveTimer) {
                clearInterval(autoSaveTimer);
            }
        });
    </script>
</body>
</html>

