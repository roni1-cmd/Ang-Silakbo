<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ang Silakbo Workstation</title>
    <link rel="icon" href="SILAKBO (1).png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tinymce/6.8.2/tinymce.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.2.3/docx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #E65100;
            --primary-light: #FF8A50;
            --primary-dark: #B23C00;
            --secondary-color: #FFF3E0;
            --text-color: #333333;
            --white: #FFFFFF;
            --gray: #F5F5F5;
            --dark-gray: #4A4A4A;
            --border-color: #E0E0E0;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.05), 0 1px 3px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px rgba(0,0,0,0.1), 0 4px 6px rgba(0,0,0,0.05);
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            font-family: 'Poppins', sans-serif;
            background-color: var(--gray);
            color: var(--text-color);
            height: 100%;
            line-height: 1.6;
        }

        .container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Header Styles */
        header {
            background-color: var(--primary-color);
            color: var(--white);
            padding: 0.75rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow-md);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-left img {
            height: 40px;
            filter: brightness(0) invert(1);
        }

        header h1 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--white);
            letter-spacing: 0.5px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            padding: 0.5rem 0.75rem;
            border-radius: var(--radius-md);
            transition: var(--transition);
        }

        .user-profile:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            font-weight: 600;
        }

        .home-icon {
            font-size: 1.25rem;
            color: var(--white);
            text-decoration: none;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .home-icon:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: scale(1.05);
        }

        /* Sidebar Styles */
        .layout {
            display: flex;
            flex: 1;
        }

        .sidebar {
            width: 250px;
            background-color: var(--white);
            box-shadow: var(--shadow-sm);
            height: calc(100vh - 64px);
            position: sticky;
            top: 64px;
            overflow-y: auto;
            transition: var(--transition);
            z-index: 90;
        }

        .sidebar-collapsed {
            width: 70px;
        }

        .sidebar-header {
            padding: 1.5rem 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid var(--border-color);
        }

        .toggle-sidebar {
            background: none;
            border: none;
            color: var(--dark-gray);
            cursor: pointer;
            font-size: 1.25rem;
            transition: var(--transition);
        }

        .toggle-sidebar:hover {
            color: var(--primary-color);
        }

        .nav-menu {
            list-style-type: none;
            padding: 1rem 0;
        }

        .nav-item {
            margin-bottom: 0.25rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1.5rem;
            color: var(--dark-gray);
            text-decoration: none;
            transition: var(--transition);
            border-left: 3px solid transparent;
            gap: 0.75rem;
        }

        .nav-link:hover {
            background-color: var(--gray);
            color: var(--primary-color);
        }

        .nav-link.active {
            background-color: var(--secondary-color);
            color: var(--primary-color);
            border-left-color: var(--primary-color);
            font-weight: 500;
        }

        .nav-link i {
            width: 20px;
            text-align: center;
        }

        .nav-text {
            transition: var(--transition);
        }

        .sidebar-collapsed .nav-text {
            display: none;
        }

        .sidebar-collapsed .nav-link {
            justify-content: center;
            padding: 0.75rem;
        }

        .sidebar-footer {
            padding: 1rem;
            border-top: 1px solid var(--border-color);
            margin-top: auto;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            padding: 2rem;
            overflow-x: hidden;
        }

        .page-header {
            margin-bottom: 2rem;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
            font-size: 0.875rem;
            color: var(--dark-gray);
        }

        .breadcrumb a {
            color: var(--primary-color);
            text-decoration: none;
        }

        .breadcrumb i {
            font-size: 0.75rem;
        }

        .page-title {
            font-size: 1.75rem;
            font-weight: 600;
            color: var(--dark-gray);
            margin-bottom: 0.5rem;
        }

        .page-description {
            color: var(--dark-gray);
            font-size: 0.95rem;
        }

        /* Card Styles */
        .card {
            background-color: var(--white);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-md);
            margin-bottom: 2rem;
            overflow: hidden;
            transition: var(--transition);
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--dark-gray);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .card-title i {
            color: var(--primary-color);
        }

        .card-body {
            padding: 1.5rem;
        }

        .card-footer {
            padding: 1.25rem 1.5rem;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* Form Styles */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group:last-child {
            margin-bottom: 0;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark-gray);
            font-size: 0.95rem;
        }

        .input-wrapper {
            position: relative;
        }

        .input-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--dark-gray);
        }

        .input-with-icon {
            padding-left: 2.75rem;
        }

        select, input, textarea, .search-bar input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            font-family: 'Poppins', sans-serif;
            font-size: 0.95rem;
            transition: var(--transition);
            background-color: var(--white);
        }

        select:focus, input:focus, textarea:focus, .search-bar input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(230, 81, 0, 0.1);
        }

        /* Button Styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 0.95rem;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            transition: var(--transition);
            text-decoration: none;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: var(--white);
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-secondary {
            background-color: var(--white);
            color: var(--dark-gray);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background-color: var(--gray);
        }

        .btn-success {
            background-color: #4CAF50;
            color: var(--white);
        }

        .btn-success:hover {
            background-color: #388E3C;
        }

        .btn-danger {
            background-color: #F44336;
            color: var(--white);
        }

        .btn-danger:hover {
            background-color: #D32F2F;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            padding: 0;
            border-radius: 50%;
        }

        /* Tab Styles */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 1.5rem;
            overflow-x: auto;
            scrollbar-width: none;
        }

        .tabs::-webkit-scrollbar {
            display: none;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            font-weight: 500;
            color: var(--dark-gray);
            border-bottom: 2px solid transparent;
            transition: var(--transition);
            white-space: nowrap;
        }

        .tab:hover {
            color: var(--primary-color);
        }

        .tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        /* Search Bar */
        .search-bar {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .search-bar input {
            flex-grow: 1;
        }

        /* Published Works */
        .published-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .published-item {
            background-color: var(--white);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            padding: 1.5rem;
            transition: var(--transition);
            border-top: 3px solid var(--primary-color);
        }

        .published-item:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .published-item h3 {
            margin: 0 0 0.75rem 0;
            color: var(--dark-gray);
            font-size: 1.25rem;
        }

        .published-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1rem;
            font-size: 0.875rem;
            color: var(--dark-gray);
        }

        .published-meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .published-meta-item i {
            color: var(--primary-color);
        }

        .category-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 500;
            background-color: var(--secondary-color);
            color: var(--primary-color);
        }

        .edit-delete-buttons {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        /* Analytics Styles */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .analytics-card {
            background-color: var(--white);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            padding: 1.5rem;
            text-align: center;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .analytics-card:hover {
            box-shadow: var(--shadow-md);
        }

        .analytics-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background-color: var(--primary-color);
        }

        .analytics-card h3 {
            color: var(--dark-gray);
            font-size: 0.95rem;
            font-weight: 500;
            margin-bottom: 0.75rem;
        }

        .analytics-card p {
            font-size: 2rem;
            font-weight: 600;
            color: var(--primary-color);
            margin: 0;
        }

        .analytics-card .trend {
            font-size: 0.875rem;
            margin-top: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
        }

        .trend-up {
            color: #4CAF50;
        }

        .trend-down {
            color: #F44336;
        }

        .chart-container {
            background-color: var(--white);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Settings Styles */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .settings-card {
            background-color: var(--white);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            padding: 1.5rem;
        }

        .settings-card h3 {
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: 1.25rem;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary-color);
        }

        input:focus + .slider {
            box-shadow: 0 0 1px var(--primary-color);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .checkbox-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .checkbox-label {
            margin-bottom: 0;
        }

        /* Writing Tips Sidebar */
        .tips-sidebar {
            width: 300px;
            background-color: var(--white);
            box-shadow: var(--shadow-sm);
            height: calc(100vh - 64px);
            position: sticky;
            top: 64px;
            overflow-y: auto;
            padding: 1.5rem;
            transition: var(--transition);
            z-index: 80;
        }

        .tips-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.25rem;
        }

        .tips-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .close-tips {
            background: none;
            border: none;
            color: var(--dark-gray);
            cursor: pointer;
            font-size: 1.1rem;
            transition: var(--transition);
        }

        .close-tips:hover {
            color: var(--primary-color);
        }

        .writing-tips-content {
            max-height: calc(100vh - 150px);
            overflow-y: auto;
            padding-right: 0.5rem;
        }

        .writing-tips-content h4 {
            color: var(--primary-color);
            margin-top: 1.25rem;
            margin-bottom: 0.75rem;
            font-size: 1rem;
            font-weight: 600;
        }

        .writing-tips-content ul {
            padding-left: 1.5rem;
        }

        .writing-tips-content li {
            margin-bottom: 0.75rem;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .font-preview {
            margin-top: 2rem;
            padding: 1.25rem;
            background-color: var(--secondary-color);
            border-radius: var(--radius-sm);
        }

        .font-preview h4 {
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: 1rem;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .font-preview p {
            margin-bottom: 0.75rem;
            font-size: 0.95rem;
        }

        /* Footer Styles */
        footer {
            background-color: var(--primary-color);
            color: var(--white);
            text-align: center;
            padding: 1rem;
            margin-top: auto;
            font-size: 0.875rem;
        }

        /* Responsive Styles */
        @media (max-width: 1200px) {
            .layout {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                top: 0;
            }

            .sidebar-collapsed {
                width: 100%;
            }

            .nav-menu {
                display: flex;
                flex-wrap: wrap;
                padding: 0.5rem;
            }

            .nav-item {
                margin-bottom: 0;
            }

            .nav-link {
                padding: 0.5rem 1rem;
                border-left: none;
                border-radius: var(--radius-sm);
            }

            .nav-link.active {
                border-left: none;
            }

            .sidebar-collapsed .nav-text {
                display: inline;
            }

            .tips-sidebar {
                width: 100%;
                height: auto;
                position: relative;
                top: 0;
            }

            .main-content {
                padding: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }

            .analytics-grid {
                grid-template-columns: 1fr;
            }

            .published-list {
                grid-template-columns: 1fr;
            }

            .settings-grid {
                grid-template-columns: 1fr;
            }

            .card-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .card-footer {
                flex-direction: column;
            }

            .card-footer .btn {
                width: 100%;
            }

            .header-left h1 {
                font-size: 1.25rem;
            }

            .user-profile span {
                display: none;
            }
        }

        /* Animation */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* TinyMCE Customization */
        .tox-tinymce {
            border-radius: var(--radius-sm) !important;
            border-color: var(--border-color) !important;
        }

        .tox .tox-statusbar {
            border-top: 1px solid var(--border-color) !important;
        }

        .tox .tox-toolbar, .tox .tox-toolbar__overflow, .tox .tox-toolbar__primary {
            background-color: var(--white) !important;
            border-bottom: 1px solid var(--border-color) !important;
        }

        /* New UI Enhancements */
        .tag-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .tag {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.35rem 0.75rem;
            background-color: var(--secondary-color);
            color: var(--primary-color);
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .tag i {
            cursor: pointer;
            font-size: 0.75rem;
        }

        .tag i:hover {
            color: var(--primary-dark);
        }

        .content-preview {
            margin-top: 1rem;
            padding: 1rem;
            border: 1px dashed var(--border-color);
            border-radius: var(--radius-sm);
            background-color: var(--gray);
        }

        .content-preview h4 {
            color: var(--primary-color);
            margin-bottom: 0.75rem;
            font-size: 1rem;
            font-weight: 600;
        }

        .preview-content {
            max-height: 200px;
            overflow-y: auto;
            padding-right: 0.5rem;
        }

        .word-count {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
            font-size: 0.85rem;
            color: var(--dark-gray);
        }

        .progress-container {
            width: 100%;
            height: 6px;
            background-color: var(--gray);
            border-radius: 3px;
            margin-top: 1rem;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--primary-color);
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .form-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
        }

        .form-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--dark-gray);
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #4CAF50;
        }

        .status-draft {
            background-color: #FFC107;
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: var(--dark-gray);
            color: var(--white);
            text-align: center;
            border-radius: var(--radius-sm);
            padding: 0.5rem;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .tooltip .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: var(--dark-gray) transparent transparent transparent;
        }

        .contributors-section {
            margin-top: 1.5rem;
            padding: 1rem;
            background-color: var(--secondary-color);
            border-radius: var(--radius-sm);
        }

        .contributors-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .contributors-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .contributor {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.35rem 0.75rem;
            background-color: var(--white);
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
        }

        .contributor-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: var(--primary-light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 0.75rem;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-left">
                <img src="SILAKBO.png" alt="Silakbo Logo">
                <h1>ANG SILAKBO WORKSTATION</h1>
            </div>
            <div class="header-right">
                <div class="user-profile">
                    <div class="user-avatar">AS</div>
                    <span>Admin</span>
                </div>
                <a href="Ang Silakbo Admin Panel.html" class="home-icon" title="Go to Admin Panel">
                    <i class="fas fa-home"></i>
                </a>
            </div>
        </header>

        <div class="layout">
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h2 class="nav-text">Navigation</h2>
                    <button class="toggle-sidebar" id="toggle-sidebar" title="Toggle Sidebar">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" onclick="showTab('editor')">
                            <i class="fas fa-pen-to-square"></i>
                            <span class="nav-text">Editor</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="showTab('published')">
                            <i class="fas fa-book"></i>
                            <span class="nav-text">Published Works</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="showTab('analytics')">
                            <i class="fas fa-chart-line"></i>
                            <span class="nav-text">Analytics</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="showTab('settings')">
                            <i class="fas fa-cog"></i>
                            <span class="nav-text">Settings</span>
                        </a>
                    </li>
                </ul>
            </aside>

            <main class="main-content">
                <div class="page-header fade-in">
                    <div class="breadcrumb">
                        <a href="#">Home</a>
                        <i class="fas fa-chevron-right"></i>
                        <span id="current-page">Editor</span>
                    </div>
                    <h1 class="page-title" id="page-title">Content Editor</h1>
                    <p class="page-description" id="page-description">Create and publish new content for Ang Silakbo</p>
                </div>

                <div id="editor-container" class="fade-in">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">
                                <i class="fas fa-pen-to-square"></i>
                                New Content
                            </h2>
                        </div>
                        <div class="card-body">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="title">Title</label>
                                    <div class="input-wrapper">
                                        <i class="fas fa-heading input-icon"></i>
                                        <input type="text" id="title" class="input-with-icon" required placeholder="Enter title">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="category">Category</label>
                                    <div class="input-wrapper">
                                        <i class="fas fa-folder input-icon"></i>
                                        <select id="category" class="input-with-icon" required>
                                            <option value="">Select a category</option>
                                            <option value="photostory">Photostory</option>
                                            <option value="articles">Articles</option>
                                            <option value="literary">Literary</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="author">Author</label>
                                    <div class="input-wrapper">
                                        <i class="fas fa-user input-icon"></i>
                                        <input type="text" id="author" class="input-with-icon" required placeholder="Enter author's name">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="photojournalist">Photojournalist</label>
                                    <div class="input-wrapper">
                                        <i class="fas fa-camera input-icon"></i>
                                        <input type="text" id="photojournalist" class="input-with-icon" placeholder="Enter photojournalist's name">
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="tags">Tags</label>
                                <div class="input-wrapper">
                                    <i class="fas fa-tags input-icon"></i>
                                    <input type="text" id="tags-input" class="input-with-icon" placeholder="Add tags and press Enter">
                                </div>
                                <div class="tag-container" id="tags-container"></div>
                            </div>

                            <div class="form-group">
                                <label for="editor">Content</label>
                                <textarea id="editor"></textarea>
                            </div>

                            <div class="contributors-section">
                                <h4 class="contributors-title">
                                    <i class="fas fa-users"></i>
                                    Contributors
                                </h4>
                                <div class="contributors-list" id="contributors-list">
                                    <!-- Contributors will be added here dynamically -->
                                </div>
                                <div class="form-actions" style="margin-top: 0.75rem;">
                                    <div class="input-wrapper" style="max-width: 300px;">
                                        <input type="text" id="contributor-input" placeholder="Add contributor and press Enter">
                                    </div>
                                </div>
                            </div>

                            <div class="content-preview">
                                <h4>
                                    <i class="fas fa-eye"></i>
                                    Content Preview
                                </h4>
                                <div class="preview-content" id="content-preview"></div>
                                <div class="word-count">
                                    <i class="fas fa-file-word"></i>
                                    <span id="word-count">0 words</span>
                                </div>
                                <div class="progress-container">
                                    <div class="progress-bar" id="progress-bar" style="width: 0%;"></div>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer">
                            <div class="form-status">
                                <div class="status-indicator status-draft"></div>
                                <span>Draft</span>
                                <div class="tooltip">
                                    <i class="fas fa-info-circle"></i>
                                    <span class="tooltip-text">This content is currently saved as a draft. Click Publish to make it live.</span>
                                </div>
                            </div>
                            <div>
                                <button class="btn btn-secondary" onclick="saveDraft()">
                                    <i class="fas fa-save"></i>
                                    Save Draft
                                </button>
                                <button id="publish-button" class="btn btn-primary" onclick="handlePublish()">
                                    <i class="fas fa-paper-plane"></i>
                                    Publish
                                </button>
                                <button class="btn btn-secondary" onclick="exportToPDF()">
                                    <i class="fas fa-file-pdf"></i>
                                    Export to PDF
                                </button>
                                <button class="btn btn-secondary" onclick="exportToDOC()">
                                    <i class="fas fa-file-word"></i>
                                    Export to DOC
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="card fade-in">
                        <div class="card-header">
                            <h2 class="card-title">
                                <i class="fas fa-link"></i>
                                Quick Links
                            </h2>
                        </div>
                        <div class="card-body">
                            <div class="nav-links">
                                <a href="Photostory.html" class="btn btn-secondary">
                                    <i class="fas fa-camera"></i>
                                    View Photostories
                                </a>
                                <a href="Artikulo.html" class="btn btn-secondary">
                                    <i class="fas fa-newspaper"></i>
                                    View Articles
                                </a>
                                <a href="literary.html" class="btn btn-secondary">
                                    <i class="fas fa-book"></i>
                                    View Literary Works
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="published-works" class="fade-in" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">
                                <i class="fas fa-list"></i>
                                Published Works
                            </h2>
                            <div class="search-bar">
                                <div class="input-wrapper">
                                    <i class="fas fa-search input-icon"></i>
                                    <input type="text" id="search-input" class="input-with-icon" placeholder="Search published works...">
                                </div>
                                <button class="btn btn-primary btn-sm" onclick="searchPublishedWorks()">
                                    Search
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="tabs">
                                <div class="tab active" onclick="filterPublishedWorks('all')">All</div>
                                <div class="tab" onclick="filterPublishedWorks('photostory')">Photostory</div>
                                <div class="tab" onclick="filterPublishedWorks('articles')">Articles</div>
                                <div class="tab" onclick="filterPublishedWorks('literary')">Literary</div>
                            </div>
                            <div id="published-list" class="published-list"></div>
                        </div>
                    </div>
                </div>

                <div id="analytics-container" class="fade-in" style="display: none;">
                    <div class="analytics-grid">
                        <div class="analytics-card">
                            <h3>Total Published Works</h3>
                            <p id="total-works">0</p>
                            <div class="trend trend-up">
                                <i class="fas fa-arrow-up"></i>
                                <span>12% from last month</span>
                            </div>
                        </div>
                        <div class="analytics-card">
                            <h3>Most Popular Category</h3>
                            <p id="popular-category">-</p>
                        </div>
                        <div class="analytics-card">
                            <h3>Average Word Count</h3>
                            <p id="avg-word-count">0</p>
                            <div class="trend trend-up">
                                <i class="fas fa-arrow-up"></i>
                                <span>5% from last month</span>
                            </div>
                        </div>
                        <div class="analytics-card">
                            <h3>Publications This Month</h3>
                            <p id="publications-month">0</p>
                            <div class="trend trend-down">
                                <i class="fas fa-arrow-down"></i>
                                <span>3% from last month</span>
                            </div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <h3>Category Distribution</h3>
                        <canvas id="category-chart"></canvas>
                    </div>

                    <div class="chart-container">
                        <h3>Publication Trends</h3>
                        <canvas id="trend-chart"></canvas>
                    </div>
                </div>

                <div id="settings-container" class="fade-in" style="display: none;">
                    <div class="settings-grid">
                        <div class="settings-card">
                            <h3>Editor Settings</h3>
                            <div class="form-group">
                                <label for="editor-theme">Editor Theme</label>
                                <select id="editor-theme" onchange="changeEditorTheme()">
                                    <option value="default">Default</option>
                                    <option value="dark">Dark</option>
                                    <option value="light">Light</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="font-size">Font Size</label>
                                <input type="number" id="font-size" min="12" max="24" value="14" onchange="changeFontSize()">
                            </div>
                        </div>
                        <div class="settings-card">
                            <h3>Notification Settings</h3>
                            <div class="checkbox-wrapper">
                                <label class="checkbox-label">Email Notifications</label>
                                <label class="switch">
                                    <input type="checkbox" id="email-notifications" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="checkbox-wrapper">
                                <label class="checkbox-label">Push Notifications</label>
                                <label class="switch">
                                    <input type="checkbox" id="push-notifications">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer">
                        <button class="btn btn-primary" onclick="saveSettings()">
                            <i class="fas fa-save"></i>
                            Save Settings
                        </button>
                    </div>
                </div>
            </main>

            <aside class="tips-sidebar fade-in">
                <div class="tips-header">
                    <h3 class="tips-title">
                        <i class="fas fa-lightbulb"></i>
                        Writing Tips
                    </h3>
                    <button class="close-tips" id="close-tips" title="Close Tips">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div id="writing-suggestions" class="writing-tips-content">
                    <h4>General Tips</h4>
                    <ul>
                        <li>Know your audience and write with them in mind.</li>
                        <li>Create an outline before you start writing.</li>
                        <li>Use active voice for more engaging content.</li>
                        <li>Be concise and avoid unnecessary words.</li>
                        <li>Proofread and edit your work multiple times.</li>
                    </ul>
                    <h4>Category-Specific Tips</h4>
                    <div id="category-tips"></div>
                </div>
                <div class="font-preview">
                    <h4>
                        <i class="fas fa-font"></i>
                        Font Preview
                    </h4>
                    <p style="font-family: 'Poppins', sans-serif;">Poppins: The quick brown fox jumps over the lazy dog.</p>
                    <p style="font-family: Arial, sans-serif;">Arial: The quick brown fox jumps over the lazy dog.</p>
                </div>
            </aside>
        </div>

        <footer>
            <p>&copy; 2025 Ang Silakbo Workstation. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDSe2c9-8xqShoHEW-D7BXXAyD5N9uXWEs",
            authDomain: "ang-silakbo.firebaseapp.com",
            databaseURL: "https://ang-silakbo-default-rtdb.firebaseio.com",
            projectId: "ang-silakbo",
            storageBucket: "ang-silakbo.firebasestorage.app",
            messagingSenderId: "1006400633782",
            appId: "1:1006400633782:web:ef4a93c1d445cb825b9f17",
            measurementId: "G-TSDTG2YJ94"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Initialize TinyMCE
        tinymce.init({
            selector: '#editor',
            height: 500,
            plugins: [
                'advlist', 'autolink', 'lists', 'link', 'image', 'charmap', 'preview',
                'anchor', 'searchreplace', 'visualblocks', 'code', 'fullscreen',
                'insertdatetime', 'media', 'table', 'help', 'wordcount'
            ],
            toolbar: 'undo redo | formatselect | ' +
                'bold italic backcolor | alignleft aligncenter ' +
                'alignright alignjustify | bullist numlist outdent indent | ' +
                'removeformat | help',
            content_style: 'body { font-family: Poppins, sans-serif; font-size: 14px; }',
            skin: 'oxide',
            content_css: 'default',
            setup: function(editor) {
                editor.on('KeyUp', function() {
                    updatePreview();
                    updateWordCount();
                });
                editor.on('Change', function() {
                    updatePreview();
                    updateWordCount();
                });
            }
        });

        // Toggle sidebar
        document.getElementById('toggle-sidebar').addEventListener('click', function() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('sidebar-collapsed');
        });

        // Close tips sidebar
        document.getElementById('close-tips').addEventListener('click', function() {
            const tipsSidebar = document.querySelector('.tips-sidebar');
            tipsSidebar.style.display = 'none';
            document.querySelector('.main-content').style.flex = '1';
        });

        let currentEditId = null;
        let currentEditCategory = null;
        let tags = [];
        let contributors = [];

        // Tags functionality
        document.getElementById('tags-input').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                const tagValue = this.value.trim();
                if (tagValue && !tags.includes(tagValue)) {
                    tags.push(tagValue);
                    renderTags();
                    this.value = '';
                }
            }
        });

        function renderTags() {
            const tagsContainer = document.getElementById('tags-container');
            tagsContainer.innerHTML = '';
            
            tags.forEach((tag, index) => {
                const tagElement = document.createElement('div');
                tagElement.className = 'tag';
                tagElement.innerHTML = `
                    ${tag}
                    <i class="fas fa-times" onclick="removeTag(${index})"></i>
                `;
                tagsContainer.appendChild(tagElement);
            });
        }

        function removeTag(index) {
            tags.splice(index, 1);
            renderTags();
        }

        // Contributors functionality
        document.getElementById('contributor-input').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                const contributorValue = this.value.trim();
                if (contributorValue && !contributors.includes(contributorValue)) {
                    contributors.push(contributorValue);
                    renderContributors();
                    this.value = '';
                }
            }
        });

        function renderContributors() {
            const contributorsList = document.getElementById('contributors-list');
            contributorsList.innerHTML = '';
            
            contributors.forEach((contributor, index) => {
                const contributorElement = document.createElement('div');
                contributorElement.className = 'contributor';
                
                const initials = contributor.split(' ').map(name => name[0]).join('').toUpperCase();
                
                contributorElement.innerHTML = `
                    <div class="contributor-avatar">${initials}</div>
                    ${contributor}
                    <i class="fas fa-times" onclick="removeContributor(${index})"></i>
                `;
                contributorsList.appendChild(contributorElement);
            });
        }

        function removeContributor(index) {
            contributors.splice(index, 1);
            renderContributors();
        }

        // Content preview and word count
        function updatePreview() {
            const content = tinymce.get('editor').getContent();
            document.getElementById('content-preview').innerHTML = content;
        }

        function updateWordCount() {
            const content = tinymce.get('editor').getContent();
            const text = content.replace(/<[^>]+>/g, '');
            const words = text.trim().split(/\s+/).length;
            document.getElementById('word-count').textContent = `${words} words`;
            
            // Update progress bar - assuming a target of 500 words
            const progress = Math.min(words / 500 * 100, 100);
            document.getElementById('progress-bar').style.width = `${progress}%`;
        }

        async function handlePublish() {
            const title = document.getElementById('title').value;
            const category = document.getElementById('category').value;
            const author = document.getElementById('author').value;
            const photojournalist = document.getElementById('photojournalist').value;
            const content = tinymce.get('editor').getContent();

            if (!title || !category || !author || !content) {
                alert('Please fill in all required fields');
                return;
            }

            if (currentEditId) {
                await updatePublishedWork(currentEditId, currentEditCategory, title, category, author, photojournalist, content);
            } else {
                await publishContent(title, category, author, photojournalist, content);
            }

            resetEditor();
            loadPublishedWorks();
        }

        async function publishContent(title, category, author, photojournalist, content) {
            try {
                await db.collection(category).add({
                    title: title,
                    author: author,
                    photojournalist: photojournalist,
                    content: content,
                    tags: tags,
                    contributors: contributors,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });

                showNotification('Content published successfully!', 'success');
            } catch (error) {
                console.error('Error publishing content:', error);
                showNotification('Error publishing content. Please try again.', 'error');
            }
        }

        async function updatePublishedWork(docId, oldCategory, title, newCategory, author, photojournalist, content) {
            try {
                if (oldCategory === newCategory) {
                    await db.collection(oldCategory).doc(docId).update({
                        title: title,
                        author: author,
                        photojournalist: photojournalist,
                        content: content,
                        tags: tags,
                        contributors: contributors,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    });
                } else {
                    // Delete from old category and add to new category
                    await db.collection(oldCategory).doc(docId).delete();
                    await db.collection(newCategory).add({
                        title: title,
                        author: author,
                        photojournalist: photojournalist,
                        content: content,
                        tags: tags,
                        contributors: contributors,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    });
                }

                showNotification('Work updated successfully!', 'success');
                currentEditId = null;
                currentEditCategory = null;
                document.getElementById('publish-button').innerHTML = '<i class="fas fa-paper-plane"></i> Publish';
            } catch (error) {
                console.error('Error updating work:', error);
                showNotification('Error updating work. Please try again.', 'error');
            }
        }

        function saveDraft() {
            const title = document.getElementById('title').value;
            const category = document.getElementById('category').value;
            const author = document.getElementById('author').value;
            const photojournalist = document.getElementById('photojournalist').value;
            const content = tinymce.get('editor').getContent();
            
            // Save to localStorage
            const draft = {
                title,
                category,
                author,
                photojournalist,
                content,
                tags,
                contributors,
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('silakbo_draft', JSON.stringify(draft));
            showNotification('Draft saved successfully!', 'success');
        }

        function loadDraft() {
            const draftData = localStorage.getItem('silakbo_draft');
            if (draftData) {
                const draft = JSON.parse(draftData);
                document.getElementById('title').value = draft.title || '';
                document.getElementById('category').value = draft.category || '';
                document.getElementById('author').value = draft.author || '';
                document.getElementById('photojournalist').value = draft.photojournalist || '';
                if (draft.content) {
                    tinymce.get('editor').setContent(draft.content);
                }
                
                tags = draft.tags || [];
                renderTags();
                
                contributors = draft.contributors || [];
                renderContributors();
                
                updatePreview();
                updateWordCount();
                
                showNotification('Draft loaded successfully!', 'success');
            }
        }

        function resetEditor() {
            document.getElementById('title').value = '';
            document.getElementById('category').value = '';
            document.getElementById('author').value = '';
            document.getElementById('photojournalist').value = '';
            tinymce.get('editor').setContent('');
            tags = [];
            renderTags();
            contributors = [];
            renderContributors();
            currentEditId = null;
            currentEditCategory = null;
            document.getElementById('publish-button').innerHTML = '<i class="fas fa-paper-plane"></i> Publish';
            updatePreview();
            updateWordCount();
        }

        function updateWritingSuggestions() {
            const category = document.getElementById('category').value;
            const categoryTipsElement = document.getElementById('category-tips');
            let tips = '';

            switch(category) {
                case 'articles':
                    tips = `
                        <h4>Article Writing Tips</h4>
                        <ul>
                            <li>Start with a compelling headline that grabs attention.</li>
                            <li>Use subheadings to break up your content and improve readability.</li>
                            <li>Include relevant facts, statistics, and quotes to support your points.</li>
                            <li>Use transition words to improve the flow between paragraphs.</li>
                            <li>End with a strong conclusion or call-to-action.</li>
                            <li>Research thoroughly and cite your sources.</li>
                            <li>Use storytelling techniques to engage your readers.</li>
                        </ul>
                    `;
                    break;
                case 'literary':
                    tips = `
                        <h4>Literary Writing Tips</h4>
                        <ul>
                            <li>Develop a strong, central theme or message for your work.</li>
                            <li>Create complex, relatable characters with depth and motivation.</li>
                            <li>Use vivid imagery and descriptive language to paint a picture in the reader's mind.</li>
                            <li>Experiment with different literary devices like metaphors, similes, and personification.</li>
                            <li>Pay attention to pacing and structure in your narrative.</li>
                            <li>Show, don't tell: use actions and dialogue to reveal character traits and emotions.</li>
                            <li>Edit ruthlessly, focusing on clarity and impact in your writing.</li>
                        </ul>
                    `;
                    break;
                case 'photostory':
                    tips = `
                        <h4>Photostory Tips</h4>
                        <ul>
                            <li>Select a series of impactful, high-quality images that tell a cohesive story.</li>
                            <li>Ensure your images have a logical sequence and flow.</li>
                            <li>Write concise, engaging captions that complement the images without stating the obvious.</li>
                            <li>Consider the composition and framing of each photograph.</li>
                            <li>Use a mix of wide, medium, and close-up shots to add variety.</li>
                            <li>Include a brief introduction and conclusion to set the context and wrap up the story.</li>
                            <li>Pay attention to color schemes and visual themes across your images.</li>
                        </ul>
                    `;
                    break;
                default:
                    tips = 'Select a category to see specific writing tips.';
            }

            categoryTipsElement.innerHTML = tips;
        }

        document.getElementById('category').addEventListener('change', updateWritingSuggestions);
        updateWritingSuggestions();

        function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            const title = document.getElementById('title').value;
            const author = document.getElementById('author').value;
            const photojournalist = document.getElementById('photojournalist').value;
            const content = tinymce.get('editor').getContent();
            
            doc.setFontSize(18);
            doc.text(title, 20, 20);
            
            doc.setFontSize(14);
            doc.text(`By ${author}`, 20, 30);
            
            if (photojournalist) {
                doc.setFontSize(12);
                doc.text(`Photojournalist: ${photojournalist}`, 20, 40);
                doc.setFontSize(12);
                const contentWithoutHTML = content.replace(/<[^>]+>/g, '');
                const splitContent = doc.splitTextToSize(contentWithoutHTML, 180);
                doc.text(splitContent, 20, 50);
            } else {
                doc.setFontSize(12);
                const contentWithoutHTML = content.replace(/<[^>]+>/g, '');
                const splitContent = doc.splitTextToSize(contentWithoutHTML, 180);
                doc.text(splitContent, 20, 40);
            }
            
            doc.save(title + '.pdf');
            showNotification('PDF exported successfully!', 'success');
        }

        function exportToDOC() {
            const title = document.getElementById('title').value;
            const author = document.getElementById('author').value;
            const photojournalist = document.getElementById('photojournalist').value;
            const content = tinymce.get('editor').getContent();
            
            // Using docx.js
            const { Document, Paragraph, HeadingLevel, Packer } = docx;
            
            const paragraphs = [
                new Paragraph({
                    text: title,
                    heading: HeadingLevel.HEADING_1,
                }),
                new Paragraph({
                    text: `By ${author}`,
                    heading: HeadingLevel.HEADING_2,
                })
            ];
            
            if (photojournalist) {
                paragraphs.push(
                    new Paragraph({
                        text: `Photojournalist: ${photojournalist}`,
                        heading: HeadingLevel.HEADING_3,
                    })
                );
            }
            
            paragraphs.push(
                new Paragraph({
                    text: content.replace(/<[^>]+>/g, ''),
                })
            );
            
            const doc = new Document({
                sections: [{
                    properties: {},
                    children: paragraphs,
                }],
            });
            
            Packer.toBlob(doc).then(blob => {
                saveAs(blob, title + ".docx");
                showNotification('DOC exported successfully!', 'success');
            });
        }

        let allPublishedWorks = [];

        async function loadPublishedWorks() {
            const publishedList = document.getElementById('published-list');
            publishedList.innerHTML = '<div class="loading-indicator">Loading published works...</div>';

            const categories = ['photostory', 'articles', 'literary'];
            allPublishedWorks = [];

            try {
                for (const category of categories) {
                    const snapshot = await db.collection(category).orderBy('timestamp', 'desc').get();
                    
                    snapshot.forEach(doc => {
                        const data = doc.data();
                        allPublishedWorks.push({
                            id: doc.id,
                            category: category,
                            title: data.title,
                            author: data.author,
                            photojournalist: data.photojournalist || '',
                            content: data.content,
                            tags: data.tags || [],
                            contributors: data.contributors || [],
                            timestamp: data.timestamp
                        });
                    });
                }

                displayPublishedWorks(allPublishedWorks);
                updateAnalytics();
            } catch (error) {
                console.error('Error loading published works:', error);
                publishedList.innerHTML = '<div class="error-message">Error loading published works. Please try again.</div>';
            }
        }

        function displayPublishedWorks(works) {
            const publishedList = document.getElementById('published-list');
            publishedList.innerHTML = '';

            if (works.length === 0) {
                publishedList.innerHTML = '<div class="empty-state">No published works found.</div>';
                return;
            }

            works.forEach(work => {
                const publishedItem = document.createElement('div');
                publishedItem.className = 'published-item';
                
                const formattedDate = work.timestamp ? work.timestamp.toDate().toLocaleString() : 'Unknown date';
                
                let tagsHTML = '';
                if (work.tags && work.tags.length > 0) {
                    tagsHTML = `
                        <div class="tag-container">
                            ${work.tags.map(tag => `<div class="tag">${tag}</div>`).join('')}
                        </div>
                    `;
                }
                
                publishedItem.innerHTML = `
                    <h3>${work.title}</h3>
                    <div class="published-meta">
                        <div class="published-meta-item">
                            <i class="fas fa-user"></i>
                            <span>${work.author}</span>
                        </div>
                        ${work.photojournalist ? `
                        <div class="published-meta-item">
                            <i class="fas fa-camera"></i>
                            <span>${work.photojournalist}</span>
                        </div>
                        ` : ''}
                        <div class="published-meta-item">
                            <i class="fas fa-calendar"></i>
                            <span>${formattedDate}</span>
                        </div>
                        <div class="published-meta-item">
                            <span class="category-badge">${work.category}</span>
                        </div>
                    </div>
                    ${tagsHTML}
                    <div class="edit-delete-buttons">
                        <button class="btn btn-secondary btn-sm" onclick="editPublishedWork('${work.category}', '${work.id}')">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deletePublishedWork('${work.category}', '${work.id}')">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                `;
                publishedList.appendChild(publishedItem);
            });
        }

        async function editPublishedWork(category, docId) {
            try {
                const doc = await db.collection(category).doc(docId).get();
                const data = doc.data();

                document.getElementById('title').value = data.title;
                document.getElementById('category').value = category;
                document.getElementById('author').value = data.author;
                document.getElementById('photojournalist').value = data.photojournalist || '';
                tinymce.get('editor').setContent(data.content);
                
                tags = data.tags || [];
                renderTags();
                
                contributors = data.contributors || [];
                renderContributors();

                currentEditId = docId;
                currentEditCategory = category;
                document.getElementById('publish-button').innerHTML = '<i class="fas fa-save"></i> Update';

                showTab('editor');
                window.scrollTo(0, 0);
                
                updatePreview();
                updateWordCount();
            } catch (error) {
                console.error('Error editing work:', error);
                showNotification('Error loading content for editing. Please try again.', 'error');
            }
        }

        async function deletePublishedWork(category, docId) {
            if (confirm('Are you sure you want to delete this work?')) {
                try {
                    await db.collection(category).doc(docId).delete();
                    showNotification('Work deleted successfully!', 'success');
                    loadPublishedWorks();
                } catch (error) {
                    console.error('Error deleting work:', error);
                    showNotification('Error deleting work. Please try again.', 'error');
                }
            }
        }

        function searchPublishedWorks() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            
            if (!searchTerm.trim()) {
                displayPublishedWorks(allPublishedWorks);
                return;
            }
            
            const filteredWorks = allPublishedWorks.filter(work => 
                work.title.toLowerCase().includes(searchTerm) || 
                work.author.toLowerCase().includes(searchTerm) ||
                (work.photojournalist && work.photojournalist.toLowerCase().includes(searchTerm)) ||
                work.content.toLowerCase().includes(searchTerm) ||
                (work.tags && work.tags.some(tag => tag.toLowerCase().includes(searchTerm)))
            );
            
            displayPublishedWorks(filteredWorks);
        }

        function filterPublishedWorks(category) {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            if (category === 'all') {
                displayPublishedWorks(allPublishedWorks);
            } else {
                const filteredWorks = allPublishedWorks.filter(work => work.category === category);
                displayPublishedWorks(filteredWorks);
            }
        }

        function showTab(tabName) {
            const editorContainer = document.getElementById('editor-container');
            const publishedWorks = document.getElementById('published-works');
            const analyticsContainer = document.getElementById('analytics-container');
            const settingsContainer = document.getElementById('settings-container');
            const navLinks = document.querySelectorAll('.nav-link');
            const pageTitle = document.getElementById('page-title');
            const pageDescription = document.getElementById('page-description');
            const currentPage = document.getElementById('current-page');

            editorContainer.style.display = 'none';
            publishedWorks.style.display = 'none';
            analyticsContainer.style.display = 'none';
            settingsContainer.style.display = 'none';

            navLinks.forEach(link => link.classList.remove('active'));

            if (tabName === 'editor') {
                editorContainer.style.display = 'block';
                pageTitle.textContent = 'Content Editor';
                pageDescription.textContent = 'Create and publish new content for Ang Silakbo';
                currentPage.textContent = 'Editor';
                document.querySelector('.nav-link[onclick="showTab(\'editor\')"]').classList.add('active');
            } else if (tabName === 'published') {
                publishedWorks.style.display = 'block';
                pageTitle.textContent = 'Published Works';
                pageDescription.textContent = 'Manage your published content';
                currentPage.textContent = 'Published Works';
                document.querySelector('.nav-link[onclick="showTab(\'published\')"]').classList.add('active');
                loadPublishedWorks();
            } else if (tabName === 'analytics') {
                analyticsContainer.style.display = 'block';
                pageTitle.textContent = 'Analytics Dashboard';
                pageDescription.textContent = 'Track and analyze your content performance';
                currentPage.textContent = 'Analytics';
                document.querySelector('.nav-link[onclick="showTab(\'analytics\')"]').classList.add('active');
                updateAnalytics();
            } else if (tabName === 'settings') {
                settingsContainer.style.display = 'block';
                pageTitle.textContent = 'Settings';
                pageDescription.textContent = 'Customize your workstation preferences';
                currentPage.textContent = 'Settings';
                document.querySelector('.nav-link[onclick="showTab(\'settings\')"]').classList.add('active');
            }
        }

        function updateAnalytics() {
            const totalWorks = allPublishedWorks.length;
            document.getElementById('total-works').textContent = totalWorks;

            const categoryCounts = allPublishedWorks.reduce((acc, work) => {
                acc[work.category] = (acc[work.category] || 0) + 1;
                return acc;
            }, {});

            let popularCategory = '-';
            if (Object.keys(categoryCounts).length > 0) {
                popularCategory = Object.keys(categoryCounts).reduce((a, b) => 
                    categoryCounts[a] > categoryCounts[b] ? a : b
                );
            }
            document.getElementById('popular-category').textContent = popularCategory;

            const avgWordCount = totalWorks > 0 ? 
                Math.round(allPublishedWorks.reduce((sum, work) => 
                    sum + (work.content.replace(/<[^>]+>/g, '').split(/\s+/).length), 0
                ) / totalWorks) : 0;
            document.getElementById('avg-word-count').textContent = avgWordCount;

            const now = new Date();
            const thisMonth = now.getMonth();
            const thisYear = now.getFullYear();
            const publicationsThisMonth = allPublishedWorks.filter(work => {
                if (!work.timestamp) return false;
                const pubDate = work.timestamp.toDate();
                return pubDate.getMonth() === thisMonth && pubDate.getFullYear() === thisYear;
            }).length;
            document.getElementById('publications-month').textContent = publicationsThisMonth;

            // Create a pie chart for category distribution
            const categoryCtx = document.getElementById('category-chart').getContext('2d');
            new Chart(categoryCtx, {
                type: 'pie',
                data: {
                    labels: Object.keys(categoryCounts).length > 0 ? Object.keys(categoryCounts) : ['No Data'],
                    datasets: [{
                        data: Object.keys(categoryCounts).length > 0 ? Object.values(categoryCounts) : [1],
                        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        title: {
                            display: false
                        }
                    }
                }
            });

            // Create a line chart for trends
            const trendCtx = document.getElementById('trend-chart').getContext('2d');
            
            // Sample data - in a real app, you'd calculate this from your database
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            const currentMonth = new Date().getMonth();
            const lastSixMonths = months.slice(currentMonth - 5, currentMonth + 1);
            
            new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: lastSixMonths,
                    datasets: [{
                        label: 'Publications',
                        data: [5, 8, 12, 9, 11, publicationsThisMonth],
                        borderColor: '#E65100',
                        backgroundColor: 'rgba(230, 81, 0, 0.1)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Publications'
                            }
                        }
                    }
                }
            });
        }

        function changeEditorTheme() {
            const theme = document.getElementById('editor-theme').value;
            tinymce.remove();
            tinymce.init({
                selector: '#editor',
                height: 500,
                plugins: [
                    'advlist', 'autolink', 'lists', 'link', 'image', 'charmap', 'preview',
                    'anchor', 'searchreplace', 'visualblocks', 'code', 'fullscreen',
                    'insertdatetime', 'media', 'table', 'help', 'wordcount'
                ],
                toolbar: 'undo redo | formatselect | ' +
                    'bold italic backcolor | alignleft aligncenter ' +
                    'alignright alignjustify | bullist numlist outdent indent | ' +
                    'removeformat | help',
                content_style: 'body { font-family: Poppins, sans-serif; font-size: 14px; }',
                skin: theme === 'dark' ? 'oxide-dark' : 'oxide',
                content_css: theme === 'dark' ? 'dark' : 'default',
                setup: function(editor) {
                    editor.on('KeyUp', function() {
                        updatePreview();
                        updateWordCount();
                    });
                    editor.on('Change', function() {
                        updatePreview();
                        updateWordCount();
                    });
                }
            });
            showNotification('Editor theme updated!', 'success');
        }

        function changeFontSize() {
            const fontSize = document.getElementById('font-size').value;
            tinymce.get('editor').getBody().style.fontSize = fontSize + 'px';
            showNotification('Font size updated!', 'success');
        }

        function saveSettings() {
            const editorTheme = document.getElementById('editor-theme').value;
            const fontSize = document.getElementById('font-size').value;
            const emailNotifications = document.getElementById('email-notifications').checked;
            const pushNotifications = document.getElementById('push-notifications').checked;

            // Here you would typically save these settings to a database or local storage
            localStorage.setItem('editorSettings', JSON.stringify({
                theme: editorTheme,
                fontSize: fontSize,
                emailNotifications: emailNotifications,
                pushNotifications: pushNotifications
            }));
            
            showNotification('Settings saved successfully!', 'success');
        }

        function loadSettings() {
            const savedSettings = localStorage.getItem('editorSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                document.getElementById('editor-theme').value = settings.theme || 'default';
                document.getElementById('font-size').value = settings.fontSize || '14';
                document.getElementById('email-notifications').checked = settings.emailNotifications !== undefined ? settings.emailNotifications : true;
                document.getElementById('push-notifications').checked = settings.pushNotifications !== undefined ? settings.pushNotifications : false;
                
                // Apply theme if needed
                if (settings.theme !== 'default') {
                    changeEditorTheme();
                }
            }
        }

        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            // Add styles
            notification.style.position = 'fixed';
            notification.style.bottom = '20px';
            notification.style.right = '20px';
            notification.style.backgroundColor = type === 'success' ? '#4CAF50' : type === 'error' ? '#F44336' : '#2196F3';
            notification.style.color = 'white';
            notification.style.padding = '12px 20px';
            notification.style.borderRadius = '4px';
            notification.style.boxShadow = '0 4px 8px rgba(0,0,0,0.1)';
            notification.style.zIndex = '1000';
            notification.style.display = 'flex';
            notification.style.alignItems = 'center';
            notification.style.gap = '10px';
            notification.style.minWidth = '250px';
            notification.style.transform = 'translateY(100px)';
            notification.style.opacity = '0';
            notification.style.transition = 'all 0.3s ease';
            
            // Add to DOM
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateY(0)';
                notification.style.opacity = '1';
            }, 10);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.transform = 'translateY(100px)';
                notification.style.opacity = '0';
                
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Load published works and settings when the page loads
        window.addEventListener('DOMContentLoaded', function() {
            loadPublishedWorks();
            loadSettings();
            loadDraft();
            updatePreview();
            updateWordCount();
            
            // Add search on enter key
            document.getElementById('search-input').addEventListener('keyup', function(event) {
                if (event.key === 'Enter') {
                    searchPublishedWorks();
                }
            });
        });
    </script>
</body>
</html>
